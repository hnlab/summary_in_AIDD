Command line
python antibiotic.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/shxie/aiddsummary/antibio_reproduction/configew.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'antibiotic_reproduction.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.35,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/shxie/aiddsummary/antibio_reproduction/antibiotic/model_0',
 'save_preds': False,
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Activity'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
Activity 0: 94.86%, 1: 5.14%
Total size = 2,335 | train size = 2,101 | val size = 234 | test size = 0
The test data split is empty. This may be either because splitting with no test set was selected,             such as with `cv-no-test`, or because test data provided with `--separate_test_path` was empty or contained only invalid molecules.             Performance on the test set will not be evaluated and metric scores will return `nan` for each task.
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1600, out_features=1, bias=True)
  )
)
Number of parameters = 5,572,801
Epoch 0
Loss = 2.7557e-01, PNorm = 59.4787, GNorm = 0.5901, lr_0 = 2.1786e-04
Loss = 2.3560e-01, PNorm = 59.5048, GNorm = 0.2576, lr_0 = 3.2500e-04
Loss = 2.4762e-01, PNorm = 59.5346, GNorm = 0.4795, lr_0 = 4.3214e-04
Loss = 1.7673e-01, PNorm = 59.5707, GNorm = 0.2511, lr_0 = 5.3929e-04
Validation auc = 0.847078
Epoch 1
Loss = 2.3519e-01, PNorm = 59.6064, GNorm = 0.3364, lr_0 = 6.5714e-04
Loss = 1.7078e-01, PNorm = 59.6448, GNorm = 0.3602, lr_0 = 7.6429e-04
Loss = 2.4179e-01, PNorm = 59.7014, GNorm = 0.1868, lr_0 = 8.7143e-04
Loss = 1.5133e-01, PNorm = 59.7733, GNorm = 0.3750, lr_0 = 9.7857e-04
Validation auc = 0.908442
Epoch 2
Loss = 2.3126e-01, PNorm = 59.8364, GNorm = 0.2872, lr_0 = 9.8253e-04
Loss = 1.5852e-01, PNorm = 59.8994, GNorm = 0.2079, lr_0 = 9.6348e-04
Loss = 1.9396e-01, PNorm = 59.9543, GNorm = 0.7801, lr_0 = 9.4480e-04
Loss = 2.1228e-01, PNorm = 60.0226, GNorm = 0.1758, lr_0 = 9.2648e-04
Validation auc = 0.897727
Epoch 3
Loss = 2.1336e-01, PNorm = 60.1063, GNorm = 0.3861, lr_0 = 9.0674e-04
Loss = 1.8120e-01, PNorm = 60.1671, GNorm = 0.3010, lr_0 = 8.8916e-04
Loss = 1.9951e-01, PNorm = 60.2234, GNorm = 0.4765, lr_0 = 8.7192e-04
Loss = 2.1083e-01, PNorm = 60.3115, GNorm = 0.2757, lr_0 = 8.5501e-04
Validation auc = 0.860065
Epoch 4
Loss = 1.6117e-01, PNorm = 60.3978, GNorm = 0.1456, lr_0 = 8.3679e-04
Loss = 2.1038e-01, PNorm = 60.4644, GNorm = 0.1840, lr_0 = 8.2057e-04
Loss = 1.7372e-01, PNorm = 60.5395, GNorm = 0.1505, lr_0 = 8.0466e-04
Loss = 1.8357e-01, PNorm = 60.6108, GNorm = 0.2794, lr_0 = 7.8906e-04
Loss = 1.6710e-01, PNorm = 60.6863, GNorm = 0.2144, lr_0 = 7.7376e-04
Loss = 1.5602e-02, PNorm = 60.6943, GNorm = 0.2045, lr_0 = 7.7224e-04
Validation auc = 0.909091
Epoch 5
Loss = 1.4508e-01, PNorm = 60.7711, GNorm = 0.1904, lr_0 = 7.5727e-04
Loss = 1.8021e-01, PNorm = 60.8472, GNorm = 0.2711, lr_0 = 7.4259e-04
Loss = 1.8625e-01, PNorm = 60.9370, GNorm = 0.5083, lr_0 = 7.2819e-04
Loss = 1.7236e-01, PNorm = 61.0169, GNorm = 0.2640, lr_0 = 7.1407e-04
Validation auc = 0.863961
Epoch 6
Loss = 2.6757e-01, PNorm = 61.2447, GNorm = 0.5755, lr_0 = 6.9886e-04
Loss = 1.8676e-01, PNorm = 61.4706, GNorm = 0.4147, lr_0 = 6.8531e-04
Loss = 2.0512e-01, PNorm = 61.6098, GNorm = 0.3809, lr_0 = 6.7202e-04
Loss = 2.1006e-01, PNorm = 61.6778, GNorm = 0.3047, lr_0 = 6.5899e-04
Validation auc = 0.896429
Epoch 7
Loss = 1.6849e-01, PNorm = 61.7591, GNorm = 0.4268, lr_0 = 6.4495e-04
Loss = 2.4213e-01, PNorm = 61.8092, GNorm = 0.2268, lr_0 = 6.3244e-04
Loss = 1.3460e-01, PNorm = 61.8859, GNorm = 0.4198, lr_0 = 6.2018e-04
Loss = 1.6636e-01, PNorm = 61.9238, GNorm = 0.1723, lr_0 = 6.0815e-04
Validation auc = 0.864935
Epoch 8
Loss = 1.8582e-01, PNorm = 61.9686, GNorm = 0.1775, lr_0 = 5.9520e-04
Loss = 1.6337e-01, PNorm = 62.0285, GNorm = 0.2850, lr_0 = 5.8366e-04
Loss = 2.0662e-01, PNorm = 62.1060, GNorm = 0.2269, lr_0 = 5.7234e-04
Loss = 1.4271e-01, PNorm = 62.1820, GNorm = 0.4365, lr_0 = 5.6124e-04
Validation auc = 0.862662
Epoch 9
Loss = 7.7372e-02, PNorm = 62.2812, GNorm = 0.1724, lr_0 = 5.4928e-04
Loss = 2.0629e-01, PNorm = 62.3541, GNorm = 0.8359, lr_0 = 5.3863e-04
Loss = 1.7697e-01, PNorm = 62.4383, GNorm = 0.2242, lr_0 = 5.2819e-04
Loss = 1.1280e-01, PNorm = 62.5242, GNorm = 0.4298, lr_0 = 5.1795e-04
Loss = 1.6344e-01, PNorm = 62.5807, GNorm = 0.1859, lr_0 = 5.0790e-04
Loss = 1.0847e-02, PNorm = 62.5874, GNorm = 0.2114, lr_0 = 5.0691e-04
Validation auc = 0.869481
Epoch 10
Loss = 1.5554e-01, PNorm = 62.6427, GNorm = 0.3050, lr_0 = 4.9708e-04
Loss = 1.4732e-01, PNorm = 62.7065, GNorm = 0.2884, lr_0 = 4.8744e-04
Loss = 1.3035e-01, PNorm = 62.7737, GNorm = 0.4534, lr_0 = 4.7799e-04
Loss = 1.4649e-01, PNorm = 62.8297, GNorm = 0.2365, lr_0 = 4.6873e-04
Validation auc = 0.856494
Epoch 11
Loss = 1.4211e-01, PNorm = 62.9032, GNorm = 0.2456, lr_0 = 4.5874e-04
Loss = 1.1757e-01, PNorm = 62.9552, GNorm = 0.1772, lr_0 = 4.4984e-04
Loss = 1.5720e-01, PNorm = 63.0102, GNorm = 0.3318, lr_0 = 4.4112e-04
Loss = 1.3414e-01, PNorm = 63.0697, GNorm = 0.2835, lr_0 = 4.3257e-04
Validation auc = 0.865260
Epoch 12
Loss = 1.1524e-01, PNorm = 63.1451, GNorm = 0.2404, lr_0 = 4.2335e-04
Loss = 1.3137e-01, PNorm = 63.1919, GNorm = 0.4706, lr_0 = 4.1514e-04
Loss = 1.3882e-01, PNorm = 63.2357, GNorm = 0.3847, lr_0 = 4.0709e-04
Loss = 1.1815e-01, PNorm = 63.3007, GNorm = 0.2801, lr_0 = 3.9920e-04
Validation auc = 0.863312
Epoch 13
Loss = 1.5698e-01, PNorm = 63.3492, GNorm = 0.2862, lr_0 = 3.9069e-04
Loss = 8.7126e-02, PNorm = 63.3896, GNorm = 0.1931, lr_0 = 3.8312e-04
Loss = 1.2938e-01, PNorm = 63.4304, GNorm = 0.5164, lr_0 = 3.7569e-04
Loss = 1.1332e-01, PNorm = 63.4802, GNorm = 0.2791, lr_0 = 3.6841e-04
Validation auc = 0.850974
Epoch 14
Loss = 7.0553e-02, PNorm = 63.5183, GNorm = 0.5974, lr_0 = 3.6056e-04
Loss = 1.3566e-01, PNorm = 63.5690, GNorm = 0.2921, lr_0 = 3.5357e-04
Loss = 1.0455e-01, PNorm = 63.6095, GNorm = 0.3985, lr_0 = 3.4671e-04
Loss = 1.1938e-01, PNorm = 63.6500, GNorm = 0.1748, lr_0 = 3.3999e-04
Loss = 1.1339e-01, PNorm = 63.6894, GNorm = 0.2930, lr_0 = 3.3340e-04
Loss = 3.5138e-02, PNorm = 63.6948, GNorm = 0.4872, lr_0 = 3.3274e-04
Validation auc = 0.861364
Epoch 15
Loss = 7.7173e-02, PNorm = 63.7363, GNorm = 1.2299, lr_0 = 3.2629e-04
Loss = 1.3787e-01, PNorm = 63.7702, GNorm = 0.2895, lr_0 = 3.1996e-04
Loss = 1.3136e-01, PNorm = 63.8130, GNorm = 0.4143, lr_0 = 3.1376e-04
Loss = 8.7917e-02, PNorm = 63.8688, GNorm = 0.2163, lr_0 = 3.0768e-04
Validation auc = 0.841883
Epoch 16
Loss = 1.5724e-01, PNorm = 63.8968, GNorm = 0.3095, lr_0 = 3.0112e-04
Loss = 1.1372e-01, PNorm = 63.9593, GNorm = 0.8303, lr_0 = 2.9528e-04
Loss = 1.1268e-01, PNorm = 63.9909, GNorm = 0.1568, lr_0 = 2.8956e-04
Loss = 9.7245e-02, PNorm = 64.0179, GNorm = 0.2499, lr_0 = 2.8394e-04
Validation auc = 0.865260
Epoch 17
Loss = 9.5104e-02, PNorm = 64.0621, GNorm = 0.5628, lr_0 = 2.7789e-04
Loss = 9.4375e-02, PNorm = 64.0833, GNorm = 0.3905, lr_0 = 2.7250e-04
Loss = 1.2056e-01, PNorm = 64.1202, GNorm = 0.3520, lr_0 = 2.6722e-04
Loss = 8.5380e-02, PNorm = 64.1557, GNorm = 0.3425, lr_0 = 2.6204e-04
Validation auc = 0.847078
Epoch 18
Loss = 6.0327e-02, PNorm = 64.1873, GNorm = 0.2864, lr_0 = 2.5646e-04
Loss = 7.3226e-02, PNorm = 64.2128, GNorm = 0.3411, lr_0 = 2.5148e-04
Loss = 9.8694e-02, PNorm = 64.2370, GNorm = 0.6715, lr_0 = 2.4661e-04
Loss = 1.0580e-01, PNorm = 64.2662, GNorm = 0.6317, lr_0 = 2.4183e-04
Validation auc = 0.843182
Epoch 19
Loss = 8.4208e-02, PNorm = 64.2954, GNorm = 0.2915, lr_0 = 2.3667e-04
Loss = 8.0053e-02, PNorm = 64.3257, GNorm = 0.4114, lr_0 = 2.3208e-04
Loss = 1.1056e-01, PNorm = 64.3540, GNorm = 0.4774, lr_0 = 2.2758e-04
Loss = 6.9454e-02, PNorm = 64.3847, GNorm = 0.3445, lr_0 = 2.2317e-04
Loss = 7.7469e-02, PNorm = 64.4229, GNorm = 0.4644, lr_0 = 2.1884e-04
Loss = 2.4411e-04, PNorm = 64.4273, GNorm = 0.0071, lr_0 = 2.1842e-04
Validation auc = 0.846429
Epoch 20
Loss = 7.2807e-02, PNorm = 64.4528, GNorm = 0.6692, lr_0 = 2.1418e-04
Loss = 3.8651e-02, PNorm = 64.4884, GNorm = 0.2378, lr_0 = 2.1003e-04
Loss = 1.1625e-01, PNorm = 64.5042, GNorm = 0.5766, lr_0 = 2.0596e-04
Loss = 1.0073e-01, PNorm = 64.5382, GNorm = 0.9977, lr_0 = 2.0196e-04
Validation auc = 0.828247
Epoch 21
Loss = 8.3418e-02, PNorm = 64.5731, GNorm = 0.6923, lr_0 = 1.9766e-04
Loss = 8.4006e-02, PNorm = 64.5971, GNorm = 0.7262, lr_0 = 1.9383e-04
Loss = 6.7322e-02, PNorm = 64.6304, GNorm = 0.8048, lr_0 = 1.9007e-04
Loss = 7.9662e-02, PNorm = 64.6475, GNorm = 0.6711, lr_0 = 1.8638e-04
Validation auc = 0.840909
Epoch 22
Loss = 4.3505e-02, PNorm = 64.6802, GNorm = 0.5691, lr_0 = 1.8241e-04
Loss = 4.7309e-02, PNorm = 64.6995, GNorm = 0.2859, lr_0 = 1.7888e-04
Loss = 8.5070e-02, PNorm = 64.7200, GNorm = 0.8127, lr_0 = 1.7541e-04
Loss = 7.0179e-02, PNorm = 64.7433, GNorm = 0.2611, lr_0 = 1.7201e-04
Validation auc = 0.846104
Epoch 23
Loss = 7.1216e-02, PNorm = 64.7651, GNorm = 0.6795, lr_0 = 1.6834e-04
Loss = 6.9042e-02, PNorm = 64.7913, GNorm = 0.7055, lr_0 = 1.6508e-04
Loss = 5.6355e-02, PNorm = 64.8034, GNorm = 0.6839, lr_0 = 1.6188e-04
Loss = 8.8742e-02, PNorm = 64.8319, GNorm = 0.6676, lr_0 = 1.5874e-04
Validation auc = 0.849026
Epoch 24
Loss = 5.6305e-02, PNorm = 64.8524, GNorm = 0.3352, lr_0 = 1.5536e-04
Loss = 5.0997e-02, PNorm = 64.8717, GNorm = 0.4470, lr_0 = 1.5234e-04
Loss = 7.2735e-02, PNorm = 64.8871, GNorm = 0.9264, lr_0 = 1.4939e-04
Loss = 6.8324e-02, PNorm = 64.9024, GNorm = 0.5617, lr_0 = 1.4649e-04
Loss = 7.0572e-02, PNorm = 64.9201, GNorm = 0.4864, lr_0 = 1.4365e-04
Loss = 1.6581e-04, PNorm = 64.9229, GNorm = 0.0055, lr_0 = 1.4337e-04
Validation auc = 0.847403
Epoch 25
Loss = 7.5247e-02, PNorm = 64.9356, GNorm = 0.5270, lr_0 = 1.4059e-04
Loss = 6.6272e-02, PNorm = 64.9520, GNorm = 0.1375, lr_0 = 1.3787e-04
Loss = 6.1021e-02, PNorm = 64.9666, GNorm = 0.9115, lr_0 = 1.3519e-04
Loss = 6.0312e-02, PNorm = 64.9855, GNorm = 0.3942, lr_0 = 1.3257e-04
Validation auc = 0.842208
Epoch 26
Loss = 5.1862e-02, PNorm = 65.0019, GNorm = 0.7272, lr_0 = 1.2975e-04
Loss = 7.6495e-02, PNorm = 65.0124, GNorm = 0.6535, lr_0 = 1.2723e-04
Loss = 6.8594e-02, PNorm = 65.0337, GNorm = 0.9530, lr_0 = 1.2476e-04
Loss = 5.9576e-02, PNorm = 65.0463, GNorm = 0.8075, lr_0 = 1.2234e-04
Validation auc = 0.844156
Epoch 27
Loss = 4.6999e-02, PNorm = 65.0588, GNorm = 0.3568, lr_0 = 1.1974e-04
Loss = 6.2544e-02, PNorm = 65.0710, GNorm = 1.1926, lr_0 = 1.1742e-04
Loss = 5.9500e-02, PNorm = 65.0782, GNorm = 0.7638, lr_0 = 1.1514e-04
Loss = 5.3454e-02, PNorm = 65.0953, GNorm = 0.3765, lr_0 = 1.1291e-04
Validation auc = 0.842208
Epoch 28
Loss = 5.6632e-02, PNorm = 65.1124, GNorm = 0.6579, lr_0 = 1.1050e-04
Loss = 3.2447e-02, PNorm = 65.1247, GNorm = 0.6180, lr_0 = 1.0836e-04
Loss = 4.8525e-02, PNorm = 65.1349, GNorm = 0.4909, lr_0 = 1.0626e-04
Loss = 5.6302e-02, PNorm = 65.1434, GNorm = 0.3047, lr_0 = 1.0420e-04
Validation auc = 0.845455
Epoch 29
Loss = 2.2316e-02, PNorm = 65.1575, GNorm = 0.3043, lr_0 = 1.0198e-04
Loss = 4.0330e-02, PNorm = 65.1684, GNorm = 0.5635, lr_0 = 1.0000e-04
Loss = 5.3805e-02, PNorm = 65.1809, GNorm = 0.7001, lr_0 = 1.0000e-04
Loss = 5.5816e-02, PNorm = 65.1867, GNorm = 0.5658, lr_0 = 1.0000e-04
Loss = 3.8313e-02, PNorm = 65.1974, GNorm = 0.9209, lr_0 = 1.0000e-04
Loss = 4.7444e-05, PNorm = 65.1984, GNorm = 0.0027, lr_0 = 1.0000e-04
Validation auc = 0.845779
Model 0 best validation auc = 0.909091 on epoch 4
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 provided with no test set, no metric evaluation will be performed.
Ensemble test auc = nan
1-fold cross validation
	Seed 0 ==> test auc = nan
Overall test auc = nan +/- nan
Elapsed time = 0:11:00
Command line
python antibiotic.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/shxie/aiddsummary/antibio_reproduction/configew.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'antibiotic_reproduction.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.35,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/shxie/aiddsummary/antibio_reproduction/antibiotic/model_1',
 'save_preds': False,
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Activity'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
Activity 0: 94.86%, 1: 5.14%
Total size = 2,335 | train size = 2,101 | val size = 234 | test size = 0
The test data split is empty. This may be either because splitting with no test set was selected,             such as with `cv-no-test`, or because test data provided with `--separate_test_path` was empty or contained only invalid molecules.             Performance on the test set will not be evaluated and metric scores will return `nan` for each task.
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1600, out_features=1, bias=True)
  )
)
Number of parameters = 5,572,801
Epoch 0
Loss = 2.7557e-01, PNorm = 59.4787, GNorm = 0.5901, lr_0 = 2.1786e-04
Loss = 2.3560e-01, PNorm = 59.5048, GNorm = 0.2575, lr_0 = 3.2500e-04
Loss = 2.4763e-01, PNorm = 59.5346, GNorm = 0.4798, lr_0 = 4.3214e-04
Loss = 1.7671e-01, PNorm = 59.5709, GNorm = 0.2502, lr_0 = 5.3929e-04
Validation auc = 0.850000
Epoch 1
Loss = 2.3511e-01, PNorm = 59.6067, GNorm = 0.3356, lr_0 = 6.5714e-04
Loss = 1.7039e-01, PNorm = 59.6452, GNorm = 0.3607, lr_0 = 7.6429e-04
Loss = 2.4159e-01, PNorm = 59.7020, GNorm = 0.1848, lr_0 = 8.7143e-04
Loss = 1.5138e-01, PNorm = 59.7726, GNorm = 0.3730, lr_0 = 9.7857e-04
Validation auc = 0.913636
Epoch 2
Loss = 2.3124e-01, PNorm = 59.8344, GNorm = 0.2868, lr_0 = 9.8253e-04
Loss = 1.5898e-01, PNorm = 59.8973, GNorm = 0.2088, lr_0 = 9.6348e-04
Loss = 1.9408e-01, PNorm = 59.9539, GNorm = 1.0195, lr_0 = 9.4480e-04
Loss = 2.0712e-01, PNorm = 60.0253, GNorm = 0.1713, lr_0 = 9.2648e-04
Validation auc = 0.891883
Epoch 3
Loss = 2.1404e-01, PNorm = 60.1089, GNorm = 0.4145, lr_0 = 9.0674e-04
Loss = 1.8008e-01, PNorm = 60.1710, GNorm = 0.3098, lr_0 = 8.8916e-04
Loss = 1.9797e-01, PNorm = 60.2295, GNorm = 0.7539, lr_0 = 8.7192e-04
Loss = 2.1201e-01, PNorm = 60.3140, GNorm = 0.2598, lr_0 = 8.5501e-04
Validation auc = 0.892532
Epoch 4
Loss = 1.5828e-01, PNorm = 60.3940, GNorm = 0.1587, lr_0 = 8.3679e-04
Loss = 2.0924e-01, PNorm = 60.4578, GNorm = 0.1925, lr_0 = 8.2057e-04
Loss = 1.6981e-01, PNorm = 60.5345, GNorm = 0.1642, lr_0 = 8.0466e-04
Loss = 1.8193e-01, PNorm = 60.6088, GNorm = 0.3023, lr_0 = 7.8906e-04
Loss = 1.6193e-01, PNorm = 60.6875, GNorm = 0.2297, lr_0 = 7.7376e-04
Loss = 1.5262e-02, PNorm = 60.6954, GNorm = 0.2369, lr_0 = 7.7224e-04
Validation auc = 0.875649
Epoch 5
Loss = 1.4713e-01, PNorm = 60.7699, GNorm = 0.1785, lr_0 = 7.5727e-04
Loss = 1.8345e-01, PNorm = 60.8468, GNorm = 0.2372, lr_0 = 7.4259e-04
Loss = 1.8523e-01, PNorm = 60.9366, GNorm = 0.4585, lr_0 = 7.2819e-04
Loss = 1.7749e-01, PNorm = 61.0084, GNorm = 0.3236, lr_0 = 7.1407e-04
Validation auc = 0.866558
Epoch 6
Loss = 2.8400e-01, PNorm = 61.2236, GNorm = 0.5095, lr_0 = 6.9886e-04
Loss = 1.8582e-01, PNorm = 61.4398, GNorm = 0.3623, lr_0 = 6.8531e-04
Loss = 2.0282e-01, PNorm = 61.5700, GNorm = 0.2637, lr_0 = 6.7202e-04
Loss = 2.1117e-01, PNorm = 61.6514, GNorm = 0.2660, lr_0 = 6.5899e-04
Validation auc = 0.912987
Epoch 7
Loss = 1.6402e-01, PNorm = 61.7428, GNorm = 0.4022, lr_0 = 6.4495e-04
Loss = 2.3899e-01, PNorm = 61.8094, GNorm = 0.4018, lr_0 = 6.3244e-04
Loss = 1.2608e-01, PNorm = 61.8903, GNorm = 0.4881, lr_0 = 6.2018e-04
Loss = 1.6090e-01, PNorm = 61.9438, GNorm = 0.2982, lr_0 = 6.0815e-04
Validation auc = 0.861364
Epoch 8
Loss = 1.8134e-01, PNorm = 62.0172, GNorm = 0.2519, lr_0 = 5.9520e-04
Loss = 1.4516e-01, PNorm = 62.0978, GNorm = 0.2655, lr_0 = 5.8366e-04
Loss = 2.1400e-01, PNorm = 62.1825, GNorm = 0.2628, lr_0 = 5.7234e-04
Loss = 1.4666e-01, PNorm = 62.2627, GNorm = 0.2687, lr_0 = 5.6124e-04
Validation auc = 0.879221
Epoch 9
Loss = 7.0150e-02, PNorm = 62.3450, GNorm = 0.2194, lr_0 = 5.4928e-04
Loss = 1.7954e-01, PNorm = 62.3975, GNorm = 0.3100, lr_0 = 5.3863e-04
Loss = 1.8459e-01, PNorm = 62.4621, GNorm = 0.2413, lr_0 = 5.2819e-04
Loss = 1.1912e-01, PNorm = 62.5361, GNorm = 0.5325, lr_0 = 5.1795e-04
Loss = 1.6976e-01, PNorm = 62.5759, GNorm = 0.2197, lr_0 = 5.0790e-04
Loss = 5.8530e-02, PNorm = 62.5806, GNorm = 0.5931, lr_0 = 5.0691e-04
Validation auc = 0.855195
Epoch 10
Loss = 1.5238e-01, PNorm = 62.6283, GNorm = 0.4516, lr_0 = 4.9708e-04
Loss = 1.5131e-01, PNorm = 62.6769, GNorm = 0.3379, lr_0 = 4.8744e-04
Loss = 1.2586e-01, PNorm = 62.7275, GNorm = 0.3594, lr_0 = 4.7799e-04
Loss = 1.4488e-01, PNorm = 62.7671, GNorm = 0.2347, lr_0 = 4.6873e-04
Validation auc = 0.861688
Epoch 11
Loss = 1.4008e-01, PNorm = 62.8284, GNorm = 0.2208, lr_0 = 4.5874e-04
Loss = 1.3495e-01, PNorm = 62.8673, GNorm = 0.1700, lr_0 = 4.4984e-04
Loss = 1.7145e-01, PNorm = 62.9057, GNorm = 0.5130, lr_0 = 4.4112e-04
Loss = 1.2984e-01, PNorm = 62.9765, GNorm = 0.3899, lr_0 = 4.3257e-04
Validation auc = 0.869481
Epoch 12
Loss = 1.1735e-01, PNorm = 63.0386, GNorm = 0.3993, lr_0 = 4.2335e-04
Loss = 1.3116e-01, PNorm = 63.0813, GNorm = 0.5226, lr_0 = 4.1514e-04
Loss = 1.5123e-01, PNorm = 63.1112, GNorm = 0.4101, lr_0 = 4.0709e-04
Loss = 1.3668e-01, PNorm = 63.1722, GNorm = 0.2625, lr_0 = 3.9920e-04
Validation auc = 0.869805
Epoch 13
Loss = 1.6082e-01, PNorm = 63.2287, GNorm = 0.2319, lr_0 = 3.9069e-04
Loss = 9.2303e-02, PNorm = 63.2620, GNorm = 0.1913, lr_0 = 3.8312e-04
Loss = 1.2946e-01, PNorm = 63.3055, GNorm = 0.5968, lr_0 = 3.7569e-04
Loss = 1.1096e-01, PNorm = 63.3482, GNorm = 0.3114, lr_0 = 3.6841e-04
Validation auc = 0.847078
Epoch 14
Loss = 7.3710e-02, PNorm = 63.3831, GNorm = 0.6816, lr_0 = 3.6056e-04
Loss = 1.4804e-01, PNorm = 63.4255, GNorm = 0.3777, lr_0 = 3.5357e-04
Loss = 1.0422e-01, PNorm = 63.4727, GNorm = 0.4054, lr_0 = 3.4671e-04
Loss = 1.2260e-01, PNorm = 63.5140, GNorm = 0.2024, lr_0 = 3.3999e-04
Loss = 1.1020e-01, PNorm = 63.5548, GNorm = 0.2569, lr_0 = 3.3340e-04
Loss = 1.6929e-02, PNorm = 63.5597, GNorm = 0.2467, lr_0 = 3.3274e-04
Validation auc = 0.846104
Epoch 15
Loss = 7.7482e-02, PNorm = 63.5978, GNorm = 1.1600, lr_0 = 3.2629e-04
Loss = 1.3910e-01, PNorm = 63.6308, GNorm = 0.5346, lr_0 = 3.1996e-04
Loss = 1.3248e-01, PNorm = 63.6757, GNorm = 0.3041, lr_0 = 3.1376e-04
Loss = 9.3031e-02, PNorm = 63.7249, GNorm = 0.2611, lr_0 = 3.0768e-04
Validation auc = 0.798701
Epoch 16
Loss = 1.5439e-01, PNorm = 63.7547, GNorm = 0.4241, lr_0 = 3.0112e-04
Loss = 1.1428e-01, PNorm = 63.8183, GNorm = 0.9490, lr_0 = 2.9528e-04
Loss = 1.2347e-01, PNorm = 63.8460, GNorm = 0.2163, lr_0 = 2.8956e-04
Loss = 9.9365e-02, PNorm = 63.8767, GNorm = 0.2464, lr_0 = 2.8394e-04
Validation auc = 0.861688
Epoch 17
Loss = 1.0117e-01, PNorm = 63.9206, GNorm = 0.4194, lr_0 = 2.7789e-04
Loss = 9.8803e-02, PNorm = 63.9473, GNorm = 0.6044, lr_0 = 2.7250e-04
Loss = 1.1777e-01, PNorm = 63.9800, GNorm = 0.4196, lr_0 = 2.6722e-04
Loss = 9.7339e-02, PNorm = 64.0156, GNorm = 0.4225, lr_0 = 2.6204e-04
Validation auc = 0.844481
Epoch 18
Loss = 5.9575e-02, PNorm = 64.0440, GNorm = 0.2813, lr_0 = 2.5646e-04
Loss = 7.4610e-02, PNorm = 64.0681, GNorm = 0.3193, lr_0 = 2.5148e-04
Loss = 1.0850e-01, PNorm = 64.0886, GNorm = 0.7193, lr_0 = 2.4661e-04
Loss = 1.1036e-01, PNorm = 64.1189, GNorm = 0.5967, lr_0 = 2.4183e-04
Validation auc = 0.838312
Epoch 19
Loss = 8.1629e-02, PNorm = 64.1468, GNorm = 0.3114, lr_0 = 2.3667e-04
Loss = 8.3942e-02, PNorm = 64.1770, GNorm = 0.4718, lr_0 = 2.3208e-04
Loss = 1.2199e-01, PNorm = 64.2029, GNorm = 0.4876, lr_0 = 2.2758e-04
Loss = 7.9243e-02, PNorm = 64.2308, GNorm = 0.3482, lr_0 = 2.2317e-04
Loss = 8.0577e-02, PNorm = 64.2625, GNorm = 0.4218, lr_0 = 2.1884e-04
Loss = 4.8375e-04, PNorm = 64.2660, GNorm = 0.0137, lr_0 = 2.1842e-04
Validation auc = 0.844805
Epoch 20
Loss = 8.2608e-02, PNorm = 64.2931, GNorm = 0.7740, lr_0 = 2.1418e-04
Loss = 3.7283e-02, PNorm = 64.3314, GNorm = 0.2210, lr_0 = 2.1003e-04
Loss = 1.2767e-01, PNorm = 64.3461, GNorm = 0.5677, lr_0 = 2.0596e-04
Loss = 1.1126e-01, PNorm = 64.3710, GNorm = 0.7185, lr_0 = 2.0196e-04
Validation auc = 0.832792
Epoch 21
Loss = 8.9864e-02, PNorm = 64.4028, GNorm = 0.5808, lr_0 = 1.9766e-04
Loss = 8.6013e-02, PNorm = 64.4286, GNorm = 0.4147, lr_0 = 1.9383e-04
Loss = 7.1320e-02, PNorm = 64.4569, GNorm = 0.8075, lr_0 = 1.9007e-04
Loss = 8.2951e-02, PNorm = 64.4742, GNorm = 0.8595, lr_0 = 1.8638e-04
Validation auc = 0.833442
Epoch 22
Loss = 4.1109e-02, PNorm = 64.5057, GNorm = 0.4838, lr_0 = 1.8241e-04
Loss = 5.3821e-02, PNorm = 64.5257, GNorm = 0.3451, lr_0 = 1.7888e-04
Loss = 9.5200e-02, PNorm = 64.5442, GNorm = 0.6929, lr_0 = 1.7541e-04
Loss = 6.8968e-02, PNorm = 64.5676, GNorm = 0.3139, lr_0 = 1.7201e-04
Validation auc = 0.840584
Epoch 23
Loss = 8.0471e-02, PNorm = 64.5877, GNorm = 0.6373, lr_0 = 1.6834e-04
Loss = 7.3157e-02, PNorm = 64.6166, GNorm = 0.7945, lr_0 = 1.6508e-04
Loss = 5.9523e-02, PNorm = 64.6320, GNorm = 0.7519, lr_0 = 1.6188e-04
Loss = 8.5550e-02, PNorm = 64.6588, GNorm = 0.6273, lr_0 = 1.5874e-04
Validation auc = 0.842857
Epoch 24
Loss = 5.2072e-02, PNorm = 64.6804, GNorm = 0.4655, lr_0 = 1.5536e-04
Loss = 5.8383e-02, PNorm = 64.6998, GNorm = 0.3486, lr_0 = 1.5234e-04
Loss = 7.9792e-02, PNorm = 64.7168, GNorm = 0.7655, lr_0 = 1.4939e-04
Loss = 6.6234e-02, PNorm = 64.7326, GNorm = 0.4773, lr_0 = 1.4649e-04
Loss = 7.3222e-02, PNorm = 64.7525, GNorm = 0.5210, lr_0 = 1.4365e-04
Loss = 1.3708e-04, PNorm = 64.7552, GNorm = 0.0053, lr_0 = 1.4337e-04
Validation auc = 0.836364
Epoch 25
Loss = 7.8120e-02, PNorm = 64.7685, GNorm = 0.5087, lr_0 = 1.4059e-04
Loss = 5.7511e-02, PNorm = 64.7864, GNorm = 0.1533, lr_0 = 1.3787e-04
Loss = 6.2822e-02, PNorm = 64.8019, GNorm = 0.7143, lr_0 = 1.3519e-04
Loss = 6.5182e-02, PNorm = 64.8196, GNorm = 0.4550, lr_0 = 1.3257e-04
Validation auc = 0.831818
Epoch 26
Loss = 4.6511e-02, PNorm = 64.8372, GNorm = 0.6586, lr_0 = 1.2975e-04
Loss = 8.2075e-02, PNorm = 64.8478, GNorm = 0.6825, lr_0 = 1.2723e-04
Loss = 7.7147e-02, PNorm = 64.8673, GNorm = 1.1541, lr_0 = 1.2476e-04
Loss = 6.1279e-02, PNorm = 64.8802, GNorm = 0.6684, lr_0 = 1.2234e-04
Validation auc = 0.834416
Epoch 27
Loss = 4.9043e-02, PNorm = 64.8939, GNorm = 0.9628, lr_0 = 1.1974e-04
Loss = 5.4365e-02, PNorm = 64.9061, GNorm = 1.2496, lr_0 = 1.1742e-04
Loss = 7.2762e-02, PNorm = 64.9155, GNorm = 0.8441, lr_0 = 1.1514e-04
Loss = 5.7258e-02, PNorm = 64.9314, GNorm = 0.6003, lr_0 = 1.1291e-04
Validation auc = 0.829221
Epoch 28
Loss = 5.6195e-02, PNorm = 64.9446, GNorm = 0.5572, lr_0 = 1.1050e-04
Loss = 3.3182e-02, PNorm = 64.9584, GNorm = 0.8091, lr_0 = 1.0836e-04
Loss = 4.8392e-02, PNorm = 64.9675, GNorm = 0.3833, lr_0 = 1.0626e-04
Loss = 7.0742e-02, PNorm = 64.9769, GNorm = 0.3421, lr_0 = 1.0420e-04
Validation auc = 0.836688
Epoch 29
Loss = 2.1433e-02, PNorm = 64.9888, GNorm = 0.3283, lr_0 = 1.0198e-04
Loss = 4.6732e-02, PNorm = 65.0013, GNorm = 0.7647, lr_0 = 1.0000e-04
Loss = 4.9050e-02, PNorm = 65.0126, GNorm = 0.8853, lr_0 = 1.0000e-04
Loss = 5.4373e-02, PNorm = 65.0198, GNorm = 0.4596, lr_0 = 1.0000e-04
Loss = 4.6499e-02, PNorm = 65.0296, GNorm = 0.9020, lr_0 = 1.0000e-04
Loss = 5.4477e-05, PNorm = 65.0305, GNorm = 0.0031, lr_0 = 1.0000e-04
Validation auc = 0.834740
Model 0 best validation auc = 0.913636 on epoch 1
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 provided with no test set, no metric evaluation will be performed.
Ensemble test auc = nan
1-fold cross validation
	Seed 0 ==> test auc = nan
Overall test auc = nan +/- nan
Elapsed time = 0:10:37
Command line
python antibiotic.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/shxie/aiddsummary/antibio_reproduction/configew.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'antibiotic_reproduction.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.35,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/shxie/aiddsummary/antibio_reproduction/antibiotic/model_2',
 'save_preds': False,
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Activity'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
Activity 0: 94.86%, 1: 5.14%
Total size = 2,335 | train size = 2,101 | val size = 234 | test size = 0
The test data split is empty. This may be either because splitting with no test set was selected,             such as with `cv-no-test`, or because test data provided with `--separate_test_path` was empty or contained only invalid molecules.             Performance on the test set will not be evaluated and metric scores will return `nan` for each task.
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1600, out_features=1, bias=True)
  )
)
Number of parameters = 5,572,801
Epoch 0
Loss = 2.7557e-01, PNorm = 59.4787, GNorm = 0.5901, lr_0 = 2.1786e-04
Loss = 2.3560e-01, PNorm = 59.5048, GNorm = 0.2575, lr_0 = 3.2500e-04
Loss = 2.4763e-01, PNorm = 59.5346, GNorm = 0.4798, lr_0 = 4.3214e-04
Loss = 1.7671e-01, PNorm = 59.5709, GNorm = 0.2502, lr_0 = 5.3929e-04
Validation auc = 0.850000
Epoch 1
Loss = 2.3511e-01, PNorm = 59.6067, GNorm = 0.3356, lr_0 = 6.5714e-04
Loss = 1.7039e-01, PNorm = 59.6452, GNorm = 0.3607, lr_0 = 7.6429e-04
Loss = 2.4159e-01, PNorm = 59.7020, GNorm = 0.1847, lr_0 = 8.7143e-04
Loss = 1.5130e-01, PNorm = 59.7728, GNorm = 0.3697, lr_0 = 9.7857e-04
Validation auc = 0.912338
Epoch 2
Loss = 2.3133e-01, PNorm = 59.8352, GNorm = 0.2882, lr_0 = 9.8253e-04
Loss = 1.5902e-01, PNorm = 59.8978, GNorm = 0.2098, lr_0 = 9.6348e-04
Loss = 1.9441e-01, PNorm = 59.9536, GNorm = 1.0010, lr_0 = 9.4480e-04
Loss = 2.0688e-01, PNorm = 60.0250, GNorm = 0.1692, lr_0 = 9.2648e-04
Validation auc = 0.889286
Epoch 3
Loss = 2.1406e-01, PNorm = 60.1094, GNorm = 0.4462, lr_0 = 9.0674e-04
Loss = 1.7948e-01, PNorm = 60.1735, GNorm = 0.2934, lr_0 = 8.8916e-04
Loss = 1.9802e-01, PNorm = 60.2356, GNorm = 0.6955, lr_0 = 8.7192e-04
Loss = 2.1048e-01, PNorm = 60.3259, GNorm = 0.2751, lr_0 = 8.5501e-04
Validation auc = 0.873052
Epoch 4
Loss = 1.5752e-01, PNorm = 60.4130, GNorm = 0.1602, lr_0 = 8.3679e-04
Loss = 2.0513e-01, PNorm = 60.4831, GNorm = 0.1790, lr_0 = 8.2057e-04
Loss = 1.7277e-01, PNorm = 60.5570, GNorm = 0.1754, lr_0 = 8.0466e-04
Loss = 1.8107e-01, PNorm = 60.6352, GNorm = 0.3314, lr_0 = 7.8906e-04
Loss = 1.6436e-01, PNorm = 60.7206, GNorm = 0.2014, lr_0 = 7.7376e-04
Loss = 1.6957e-02, PNorm = 60.7300, GNorm = 0.2274, lr_0 = 7.7224e-04
Validation auc = 0.906169
Epoch 5
Loss = 1.4807e-01, PNorm = 60.7979, GNorm = 0.2172, lr_0 = 7.5727e-04
Loss = 1.7726e-01, PNorm = 60.8752, GNorm = 0.3102, lr_0 = 7.4259e-04
Loss = 1.7931e-01, PNorm = 60.9704, GNorm = 0.4746, lr_0 = 7.2819e-04
Loss = 1.7517e-01, PNorm = 61.0446, GNorm = 0.4354, lr_0 = 7.1407e-04
Validation auc = 0.856818
Epoch 6
Loss = 2.3956e-01, PNorm = 61.2564, GNorm = 0.5168, lr_0 = 6.9886e-04
Loss = 1.8432e-01, PNorm = 61.4553, GNorm = 0.3816, lr_0 = 6.8531e-04
Loss = 2.0256e-01, PNorm = 61.5803, GNorm = 0.3214, lr_0 = 6.7202e-04
Loss = 2.0867e-01, PNorm = 61.6496, GNorm = 0.2906, lr_0 = 6.5899e-04
Validation auc = 0.829545
Epoch 7
Loss = 1.6685e-01, PNorm = 61.7384, GNorm = 0.4082, lr_0 = 6.4495e-04
Loss = 2.3728e-01, PNorm = 61.7921, GNorm = 0.2918, lr_0 = 6.3244e-04
Loss = 1.3588e-01, PNorm = 61.8797, GNorm = 0.4267, lr_0 = 6.2018e-04
Loss = 1.5708e-01, PNorm = 61.9274, GNorm = 0.2046, lr_0 = 6.0815e-04
Validation auc = 0.841558
Epoch 8
Loss = 1.7737e-01, PNorm = 61.9836, GNorm = 0.2000, lr_0 = 5.9520e-04
Loss = 1.5782e-01, PNorm = 62.0576, GNorm = 0.3067, lr_0 = 5.8366e-04
Loss = 2.1517e-01, PNorm = 62.1487, GNorm = 0.2482, lr_0 = 5.7234e-04
Loss = 1.3994e-01, PNorm = 62.2181, GNorm = 0.2215, lr_0 = 5.6124e-04
Validation auc = 0.812987
Epoch 9
Loss = 6.8726e-02, PNorm = 62.3100, GNorm = 0.2459, lr_0 = 5.4928e-04
Loss = 1.8226e-01, PNorm = 62.3891, GNorm = 0.2537, lr_0 = 5.3863e-04
Loss = 1.9563e-01, PNorm = 62.4806, GNorm = 0.1989, lr_0 = 5.2819e-04
Loss = 1.2920e-01, PNorm = 62.5716, GNorm = 0.2374, lr_0 = 5.1795e-04
Loss = 1.7159e-01, PNorm = 62.6272, GNorm = 0.1719, lr_0 = 5.0790e-04
Loss = 2.0806e-02, PNorm = 62.6318, GNorm = 0.4458, lr_0 = 5.0691e-04
Validation auc = 0.847078
Epoch 10
Loss = 1.5081e-01, PNorm = 62.6878, GNorm = 0.4516, lr_0 = 4.9708e-04
Loss = 1.4817e-01, PNorm = 62.7344, GNorm = 0.8570, lr_0 = 4.8744e-04
Loss = 1.2991e-01, PNorm = 62.7839, GNorm = 0.4160, lr_0 = 4.7799e-04
Loss = 1.4176e-01, PNorm = 62.8308, GNorm = 0.2483, lr_0 = 4.6873e-04
Validation auc = 0.837338
Epoch 11
Loss = 1.3505e-01, PNorm = 62.8995, GNorm = 0.1927, lr_0 = 4.5874e-04
Loss = 1.2025e-01, PNorm = 62.9391, GNorm = 0.2901, lr_0 = 4.4984e-04
Loss = 1.5649e-01, PNorm = 62.9889, GNorm = 0.3922, lr_0 = 4.4112e-04
Loss = 1.2498e-01, PNorm = 63.0474, GNorm = 0.4168, lr_0 = 4.3257e-04
Validation auc = 0.887013
Epoch 12
Loss = 1.1531e-01, PNorm = 63.1046, GNorm = 0.2416, lr_0 = 4.2335e-04
Loss = 1.2728e-01, PNorm = 63.1447, GNorm = 0.4600, lr_0 = 4.1514e-04
Loss = 1.4425e-01, PNorm = 63.1784, GNorm = 0.3793, lr_0 = 4.0709e-04
Loss = 1.2300e-01, PNorm = 63.2416, GNorm = 0.2460, lr_0 = 3.9920e-04
Validation auc = 0.841234
Epoch 13
Loss = 1.5861e-01, PNorm = 63.2897, GNorm = 0.3352, lr_0 = 3.9069e-04
Loss = 8.5836e-02, PNorm = 63.3263, GNorm = 0.2102, lr_0 = 3.8312e-04
Loss = 1.3055e-01, PNorm = 63.3692, GNorm = 0.7531, lr_0 = 3.7569e-04
Loss = 1.0857e-01, PNorm = 63.4158, GNorm = 0.2831, lr_0 = 3.6841e-04
Validation auc = 0.834091
Epoch 14
Loss = 7.5555e-02, PNorm = 63.4569, GNorm = 0.6970, lr_0 = 3.6056e-04
Loss = 1.3999e-01, PNorm = 63.5070, GNorm = 0.3188, lr_0 = 3.5357e-04
Loss = 1.0291e-01, PNorm = 63.5503, GNorm = 0.3633, lr_0 = 3.4671e-04
Loss = 1.1548e-01, PNorm = 63.5949, GNorm = 0.2357, lr_0 = 3.3999e-04
Loss = 1.0357e-01, PNorm = 63.6423, GNorm = 0.2543, lr_0 = 3.3340e-04
Loss = 2.0457e-02, PNorm = 63.6486, GNorm = 0.3184, lr_0 = 3.3274e-04
Validation auc = 0.841234
Epoch 15
Loss = 7.8337e-02, PNorm = 63.6898, GNorm = 1.0887, lr_0 = 3.2629e-04
Loss = 1.2892e-01, PNorm = 63.7306, GNorm = 0.4698, lr_0 = 3.1996e-04
Loss = 1.2297e-01, PNorm = 63.7772, GNorm = 0.4253, lr_0 = 3.1376e-04
Loss = 9.0352e-02, PNorm = 63.8268, GNorm = 0.3457, lr_0 = 3.0768e-04
Validation auc = 0.827273
Epoch 16
Loss = 1.5463e-01, PNorm = 63.8616, GNorm = 0.5322, lr_0 = 3.0112e-04
Loss = 1.1253e-01, PNorm = 63.9180, GNorm = 1.0319, lr_0 = 2.9528e-04
Loss = 1.0761e-01, PNorm = 63.9373, GNorm = 0.3033, lr_0 = 2.8956e-04
Loss = 9.3763e-02, PNorm = 63.9746, GNorm = 0.2452, lr_0 = 2.8394e-04
Validation auc = 0.860065
Epoch 17
Loss = 8.9134e-02, PNorm = 64.0222, GNorm = 0.5004, lr_0 = 2.7789e-04
Loss = 8.9074e-02, PNorm = 64.0498, GNorm = 0.4979, lr_0 = 2.7250e-04
Loss = 1.1527e-01, PNorm = 64.0836, GNorm = 0.5004, lr_0 = 2.6722e-04
Loss = 8.9075e-02, PNorm = 64.1192, GNorm = 0.4641, lr_0 = 2.6204e-04
Validation auc = 0.834740
Epoch 18
Loss = 5.9354e-02, PNorm = 64.1477, GNorm = 0.3095, lr_0 = 2.5646e-04
Loss = 7.3180e-02, PNorm = 64.1727, GNorm = 0.3603, lr_0 = 2.5148e-04
Loss = 9.2327e-02, PNorm = 64.2002, GNorm = 0.7272, lr_0 = 2.4661e-04
Loss = 1.0495e-01, PNorm = 64.2329, GNorm = 0.7453, lr_0 = 2.4183e-04
Validation auc = 0.831818
Epoch 19
Loss = 7.3942e-02, PNorm = 64.2668, GNorm = 0.3265, lr_0 = 2.3667e-04
Loss = 8.2018e-02, PNorm = 64.2941, GNorm = 0.4446, lr_0 = 2.3208e-04
Loss = 1.0944e-01, PNorm = 64.3239, GNorm = 0.3814, lr_0 = 2.2758e-04
Loss = 6.6621e-02, PNorm = 64.3530, GNorm = 0.4438, lr_0 = 2.2317e-04
Loss = 7.8586e-02, PNorm = 64.3875, GNorm = 0.6724, lr_0 = 2.1884e-04
Loss = 2.3029e-04, PNorm = 64.3915, GNorm = 0.0078, lr_0 = 2.1842e-04
Validation auc = 0.845455
Epoch 20
Loss = 7.4491e-02, PNorm = 64.4181, GNorm = 0.8700, lr_0 = 2.1418e-04
Loss = 3.1120e-02, PNorm = 64.4509, GNorm = 0.1830, lr_0 = 2.1003e-04
Loss = 1.1823e-01, PNorm = 64.4641, GNorm = 0.5906, lr_0 = 2.0596e-04
Loss = 1.0337e-01, PNorm = 64.4966, GNorm = 0.9413, lr_0 = 2.0196e-04
Validation auc = 0.829545
Epoch 21
Loss = 8.3678e-02, PNorm = 64.5285, GNorm = 0.7153, lr_0 = 1.9766e-04
Loss = 8.0272e-02, PNorm = 64.5487, GNorm = 0.5882, lr_0 = 1.9383e-04
Loss = 6.0837e-02, PNorm = 64.5766, GNorm = 0.8721, lr_0 = 1.9007e-04
Loss = 7.2910e-02, PNorm = 64.5933, GNorm = 0.6146, lr_0 = 1.8638e-04
Validation auc = 0.829870
Epoch 22
Loss = 3.8326e-02, PNorm = 64.6237, GNorm = 0.4410, lr_0 = 1.8241e-04
Loss = 4.2455e-02, PNorm = 64.6434, GNorm = 0.2805, lr_0 = 1.7888e-04
Loss = 8.6273e-02, PNorm = 64.6627, GNorm = 0.5905, lr_0 = 1.7541e-04
Loss = 6.6214e-02, PNorm = 64.6845, GNorm = 0.2769, lr_0 = 1.7201e-04
Validation auc = 0.843182
Epoch 23
Loss = 6.1514e-02, PNorm = 64.7070, GNorm = 0.4900, lr_0 = 1.6834e-04
Loss = 6.7098e-02, PNorm = 64.7348, GNorm = 0.7996, lr_0 = 1.6508e-04
Loss = 5.0394e-02, PNorm = 64.7497, GNorm = 0.5469, lr_0 = 1.6188e-04
Loss = 8.1321e-02, PNorm = 64.7792, GNorm = 0.6606, lr_0 = 1.5874e-04
Validation auc = 0.840260
Epoch 24
Loss = 5.7757e-02, PNorm = 64.7993, GNorm = 0.3787, lr_0 = 1.5536e-04
Loss = 5.3420e-02, PNorm = 64.8190, GNorm = 0.3873, lr_0 = 1.5234e-04
Loss = 7.1097e-02, PNorm = 64.8350, GNorm = 0.7447, lr_0 = 1.4939e-04
Loss = 6.2629e-02, PNorm = 64.8510, GNorm = 0.6030, lr_0 = 1.4649e-04
Loss = 6.8677e-02, PNorm = 64.8678, GNorm = 0.5185, lr_0 = 1.4365e-04
Loss = 3.7312e-05, PNorm = 64.8704, GNorm = 0.0018, lr_0 = 1.4337e-04
Validation auc = 0.833766
Epoch 25
Loss = 6.5596e-02, PNorm = 64.8835, GNorm = 0.4619, lr_0 = 1.4059e-04
Loss = 5.7898e-02, PNorm = 64.8973, GNorm = 0.1802, lr_0 = 1.3787e-04
Loss = 6.1357e-02, PNorm = 64.9145, GNorm = 0.6739, lr_0 = 1.3519e-04
Loss = 5.4520e-02, PNorm = 64.9330, GNorm = 0.8155, lr_0 = 1.3257e-04
Validation auc = 0.835714
Epoch 26
Loss = 4.3457e-02, PNorm = 64.9484, GNorm = 0.5563, lr_0 = 1.2975e-04
Loss = 7.5784e-02, PNorm = 64.9579, GNorm = 0.7750, lr_0 = 1.2723e-04
Loss = 6.8663e-02, PNorm = 64.9738, GNorm = 1.0631, lr_0 = 1.2476e-04
Loss = 4.6881e-02, PNorm = 64.9859, GNorm = 0.6698, lr_0 = 1.2234e-04
Validation auc = 0.829545
Epoch 27
Loss = 3.6674e-02, PNorm = 64.9990, GNorm = 0.5102, lr_0 = 1.1974e-04
Loss = 5.3355e-02, PNorm = 65.0096, GNorm = 1.4617, lr_0 = 1.1742e-04
Loss = 6.1684e-02, PNorm = 65.0215, GNorm = 0.6152, lr_0 = 1.1514e-04
Loss = 4.9581e-02, PNorm = 65.0401, GNorm = 0.5591, lr_0 = 1.1291e-04
Validation auc = 0.832792
Epoch 28
Loss = 4.2705e-02, PNorm = 65.0539, GNorm = 0.4422, lr_0 = 1.1050e-04
Loss = 3.2629e-02, PNorm = 65.0696, GNorm = 0.6443, lr_0 = 1.0836e-04
Loss = 4.9724e-02, PNorm = 65.0793, GNorm = 0.3827, lr_0 = 1.0626e-04
Loss = 6.6960e-02, PNorm = 65.0836, GNorm = 0.4063, lr_0 = 1.0420e-04
Validation auc = 0.839286
Epoch 29
Loss = 1.7209e-02, PNorm = 65.0984, GNorm = 0.3013, lr_0 = 1.0198e-04
Loss = 3.9706e-02, PNorm = 65.1059, GNorm = 0.7308, lr_0 = 1.0000e-04
Loss = 5.1719e-02, PNorm = 65.1190, GNorm = 0.6000, lr_0 = 1.0000e-04
Loss = 4.8450e-02, PNorm = 65.1270, GNorm = 0.3793, lr_0 = 1.0000e-04
Loss = 4.0940e-02, PNorm = 65.1383, GNorm = 1.1005, lr_0 = 1.0000e-04
Loss = 6.0797e-06, PNorm = 65.1395, GNorm = 0.0004, lr_0 = 1.0000e-04
Validation auc = 0.843831
Model 0 best validation auc = 0.912338 on epoch 1
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 provided with no test set, no metric evaluation will be performed.
Ensemble test auc = nan
1-fold cross validation
	Seed 0 ==> test auc = nan
Overall test auc = nan +/- nan
Elapsed time = 0:10:46
Command line
python antibiotic.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/shxie/aiddsummary/antibio_reproduction/configew.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'antibiotic_reproduction.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.35,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/shxie/aiddsummary/antibio_reproduction/antibiotic/model_3',
 'save_preds': False,
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Activity'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
Activity 0: 94.86%, 1: 5.14%
Total size = 2,335 | train size = 2,101 | val size = 234 | test size = 0
The test data split is empty. This may be either because splitting with no test set was selected,             such as with `cv-no-test`, or because test data provided with `--separate_test_path` was empty or contained only invalid molecules.             Performance on the test set will not be evaluated and metric scores will return `nan` for each task.
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1600, out_features=1, bias=True)
  )
)
Number of parameters = 5,572,801
Epoch 0
Loss = 2.7557e-01, PNorm = 59.4787, GNorm = 0.5901, lr_0 = 2.1786e-04
Loss = 2.3560e-01, PNorm = 59.5048, GNorm = 0.2575, lr_0 = 3.2500e-04
Loss = 2.4763e-01, PNorm = 59.5346, GNorm = 0.4798, lr_0 = 4.3214e-04
Loss = 1.7671e-01, PNorm = 59.5709, GNorm = 0.2499, lr_0 = 5.3929e-04
Validation auc = 0.850325
Epoch 1
Loss = 2.3508e-01, PNorm = 59.6068, GNorm = 0.3332, lr_0 = 6.5714e-04
Loss = 1.7049e-01, PNorm = 59.6449, GNorm = 0.3608, lr_0 = 7.6429e-04
Loss = 2.4138e-01, PNorm = 59.7023, GNorm = 0.1849, lr_0 = 8.7143e-04
Loss = 1.5083e-01, PNorm = 59.7746, GNorm = 0.3543, lr_0 = 9.7857e-04
Validation auc = 0.903896
Epoch 2
Loss = 2.3224e-01, PNorm = 59.8394, GNorm = 0.2838, lr_0 = 9.8253e-04
Loss = 1.5948e-01, PNorm = 59.9063, GNorm = 0.2090, lr_0 = 9.6348e-04
Loss = 1.9519e-01, PNorm = 59.9628, GNorm = 0.7901, lr_0 = 9.4480e-04
Loss = 2.1066e-01, PNorm = 60.0330, GNorm = 0.1734, lr_0 = 9.2648e-04
Validation auc = 0.892857
Epoch 3
Loss = 2.1356e-01, PNorm = 60.1185, GNorm = 0.4248, lr_0 = 9.0674e-04
Loss = 1.8010e-01, PNorm = 60.1815, GNorm = 0.2903, lr_0 = 8.8916e-04
Loss = 1.9727e-01, PNorm = 60.2428, GNorm = 0.5518, lr_0 = 8.7192e-04
Loss = 2.0657e-01, PNorm = 60.3339, GNorm = 0.2925, lr_0 = 8.5501e-04
Validation auc = 0.869805
Epoch 4
Loss = 1.6046e-01, PNorm = 60.4286, GNorm = 0.1290, lr_0 = 8.3679e-04
Loss = 2.1183e-01, PNorm = 60.4959, GNorm = 0.2582, lr_0 = 8.2057e-04
Loss = 1.6854e-01, PNorm = 60.5802, GNorm = 0.1613, lr_0 = 8.0466e-04
Loss = 1.7657e-01, PNorm = 60.6584, GNorm = 0.3268, lr_0 = 7.8906e-04
Loss = 1.6557e-01, PNorm = 60.7411, GNorm = 0.1898, lr_0 = 7.7376e-04
Loss = 2.2703e-02, PNorm = 60.7499, GNorm = 0.2532, lr_0 = 7.7224e-04
Validation auc = 0.884091
Epoch 5
Loss = 1.4660e-01, PNorm = 60.8181, GNorm = 0.1891, lr_0 = 7.5727e-04
Loss = 1.7327e-01, PNorm = 60.8873, GNorm = 0.3013, lr_0 = 7.4259e-04
Loss = 1.7810e-01, PNorm = 60.9775, GNorm = 0.4484, lr_0 = 7.2819e-04
Loss = 1.6471e-01, PNorm = 61.0631, GNorm = 0.3485, lr_0 = 7.1407e-04
Validation auc = 0.808117
Epoch 6
Loss = 2.2889e-01, PNorm = 61.2715, GNorm = 0.4035, lr_0 = 6.9886e-04
Loss = 1.6550e-01, PNorm = 61.5119, GNorm = 0.1788, lr_0 = 6.8531e-04
Loss = 1.8424e-01, PNorm = 61.6491, GNorm = 0.2475, lr_0 = 6.7202e-04
Loss = 2.1107e-01, PNorm = 61.7606, GNorm = 0.1799, lr_0 = 6.5899e-04
Validation auc = 0.870779
Epoch 7
Loss = 1.3920e-01, PNorm = 61.8658, GNorm = 0.3141, lr_0 = 6.4495e-04
Loss = 2.3258e-01, PNorm = 61.9390, GNorm = 0.2445, lr_0 = 6.3244e-04
Loss = 1.2506e-01, PNorm = 62.0382, GNorm = 0.4399, lr_0 = 6.2018e-04
Loss = 1.5959e-01, PNorm = 62.0842, GNorm = 0.2334, lr_0 = 6.0815e-04
Validation auc = 0.834091
Epoch 8
Loss = 1.7775e-01, PNorm = 62.1377, GNorm = 0.2127, lr_0 = 5.9520e-04
Loss = 1.4320e-01, PNorm = 62.1983, GNorm = 0.2614, lr_0 = 5.8366e-04
Loss = 1.9901e-01, PNorm = 62.2618, GNorm = 0.2674, lr_0 = 5.7234e-04
Loss = 1.3616e-01, PNorm = 62.3146, GNorm = 0.2515, lr_0 = 5.6124e-04
Validation auc = 0.850974
Epoch 9
Loss = 5.1004e-02, PNorm = 62.3837, GNorm = 0.2925, lr_0 = 5.4928e-04
Loss = 1.7460e-01, PNorm = 62.4409, GNorm = 0.5363, lr_0 = 5.3863e-04
Loss = 1.7517e-01, PNorm = 62.5029, GNorm = 0.2490, lr_0 = 5.2819e-04
Loss = 1.1072e-01, PNorm = 62.5735, GNorm = 0.3995, lr_0 = 5.1795e-04
Loss = 1.6726e-01, PNorm = 62.6176, GNorm = 0.2176, lr_0 = 5.0790e-04
Loss = 2.1619e-02, PNorm = 62.6216, GNorm = 0.3444, lr_0 = 5.0691e-04
Validation auc = 0.852273
Epoch 10
Loss = 1.4504e-01, PNorm = 62.6693, GNorm = 0.4588, lr_0 = 4.9708e-04
Loss = 1.3757e-01, PNorm = 62.7185, GNorm = 0.3374, lr_0 = 4.8744e-04
Loss = 1.1543e-01, PNorm = 62.7717, GNorm = 0.6752, lr_0 = 4.7799e-04
Loss = 1.3971e-01, PNorm = 62.8121, GNorm = 0.2374, lr_0 = 4.6873e-04
Validation auc = 0.836688
Epoch 11
Loss = 1.3504e-01, PNorm = 62.8719, GNorm = 0.2857, lr_0 = 4.5874e-04
Loss = 1.0922e-01, PNorm = 62.9250, GNorm = 0.2411, lr_0 = 4.4984e-04
Loss = 1.4487e-01, PNorm = 62.9651, GNorm = 0.4977, lr_0 = 4.4112e-04
Loss = 1.2512e-01, PNorm = 63.0098, GNorm = 0.3064, lr_0 = 4.3257e-04
Validation auc = 0.881818
Epoch 12
Loss = 1.1736e-01, PNorm = 63.0643, GNorm = 0.3070, lr_0 = 4.2335e-04
Loss = 1.2084e-01, PNorm = 63.1086, GNorm = 0.7093, lr_0 = 4.1514e-04
Loss = 1.3783e-01, PNorm = 63.1385, GNorm = 0.4218, lr_0 = 4.0709e-04
Loss = 1.1634e-01, PNorm = 63.2051, GNorm = 0.2724, lr_0 = 3.9920e-04
Validation auc = 0.847727
Epoch 13
Loss = 1.5685e-01, PNorm = 63.2491, GNorm = 0.3001, lr_0 = 3.9069e-04
Loss = 8.2138e-02, PNorm = 63.2842, GNorm = 0.1856, lr_0 = 3.8312e-04
Loss = 1.2554e-01, PNorm = 63.3236, GNorm = 0.5144, lr_0 = 3.7569e-04
Loss = 1.0276e-01, PNorm = 63.3730, GNorm = 0.3341, lr_0 = 3.6841e-04
Validation auc = 0.863636
Epoch 14
Loss = 8.6906e-02, PNorm = 63.4132, GNorm = 0.6325, lr_0 = 3.6056e-04
Loss = 1.3955e-01, PNorm = 63.4663, GNorm = 0.2975, lr_0 = 3.5357e-04
Loss = 1.0328e-01, PNorm = 63.5048, GNorm = 0.3835, lr_0 = 3.4671e-04
Loss = 1.1588e-01, PNorm = 63.5460, GNorm = 0.1866, lr_0 = 3.3999e-04
Loss = 9.8047e-02, PNorm = 63.5812, GNorm = 0.2647, lr_0 = 3.3340e-04
Loss = 2.0388e-02, PNorm = 63.5854, GNorm = 0.3314, lr_0 = 3.3274e-04
Validation auc = 0.866883
Epoch 15
Loss = 8.1494e-02, PNorm = 63.6171, GNorm = 1.5188, lr_0 = 3.2629e-04
Loss = 1.2197e-01, PNorm = 63.6524, GNorm = 0.3270, lr_0 = 3.1996e-04
Loss = 1.2106e-01, PNorm = 63.6943, GNorm = 0.4492, lr_0 = 3.1376e-04
Loss = 8.9316e-02, PNorm = 63.7407, GNorm = 0.2237, lr_0 = 3.0768e-04
Validation auc = 0.814935
Epoch 16
Loss = 1.4596e-01, PNorm = 63.7758, GNorm = 0.4922, lr_0 = 3.0112e-04
Loss = 1.0861e-01, PNorm = 63.8334, GNorm = 1.0086, lr_0 = 2.9528e-04
Loss = 1.0100e-01, PNorm = 63.8591, GNorm = 0.3036, lr_0 = 2.8956e-04
Loss = 9.5203e-02, PNorm = 63.8959, GNorm = 0.2325, lr_0 = 2.8394e-04
Validation auc = 0.863636
Epoch 17
Loss = 9.0354e-02, PNorm = 63.9362, GNorm = 0.4781, lr_0 = 2.7789e-04
Loss = 9.0420e-02, PNorm = 63.9591, GNorm = 0.4793, lr_0 = 2.7250e-04
Loss = 1.0971e-01, PNorm = 63.9934, GNorm = 0.4592, lr_0 = 2.6722e-04
Loss = 8.4165e-02, PNorm = 64.0276, GNorm = 0.4475, lr_0 = 2.6204e-04
Validation auc = 0.839286
Epoch 18
Loss = 5.9128e-02, PNorm = 64.0594, GNorm = 0.3291, lr_0 = 2.5646e-04
Loss = 7.0204e-02, PNorm = 64.0830, GNorm = 0.2659, lr_0 = 2.5148e-04
Loss = 8.5222e-02, PNorm = 64.1084, GNorm = 0.5536, lr_0 = 2.4661e-04
Loss = 1.0633e-01, PNorm = 64.1405, GNorm = 0.5883, lr_0 = 2.4183e-04
Validation auc = 0.831169
Epoch 19
Loss = 7.1040e-02, PNorm = 64.1710, GNorm = 0.3069, lr_0 = 2.3667e-04
Loss = 7.1829e-02, PNorm = 64.2020, GNorm = 0.4827, lr_0 = 2.3208e-04
Loss = 1.0957e-01, PNorm = 64.2290, GNorm = 0.4954, lr_0 = 2.2758e-04
Loss = 7.4664e-02, PNorm = 64.2576, GNorm = 0.3738, lr_0 = 2.2317e-04
Loss = 7.9820e-02, PNorm = 64.2893, GNorm = 0.6244, lr_0 = 2.1884e-04
Loss = 2.8415e-04, PNorm = 64.2927, GNorm = 0.0085, lr_0 = 2.1842e-04
Validation auc = 0.850649
Epoch 20
Loss = 6.8714e-02, PNorm = 64.3165, GNorm = 0.8650, lr_0 = 2.1418e-04
Loss = 3.4049e-02, PNorm = 64.3473, GNorm = 0.2711, lr_0 = 2.1003e-04
Loss = 1.0798e-01, PNorm = 64.3652, GNorm = 0.5387, lr_0 = 2.0596e-04
Loss = 9.6736e-02, PNorm = 64.3942, GNorm = 0.9797, lr_0 = 2.0196e-04
Validation auc = 0.831494
Epoch 21
Loss = 8.1034e-02, PNorm = 64.4255, GNorm = 0.6137, lr_0 = 1.9766e-04
Loss = 7.7791e-02, PNorm = 64.4477, GNorm = 0.6351, lr_0 = 1.9383e-04
Loss = 6.2500e-02, PNorm = 64.4741, GNorm = 0.7715, lr_0 = 1.9007e-04
Loss = 6.8234e-02, PNorm = 64.4906, GNorm = 0.6934, lr_0 = 1.8638e-04
Validation auc = 0.837338
Epoch 22
Loss = 3.6184e-02, PNorm = 64.5177, GNorm = 0.5274, lr_0 = 1.8241e-04
Loss = 4.2830e-02, PNorm = 64.5375, GNorm = 0.4130, lr_0 = 1.7888e-04
Loss = 8.2907e-02, PNorm = 64.5569, GNorm = 0.6743, lr_0 = 1.7541e-04
Loss = 6.2064e-02, PNorm = 64.5796, GNorm = 0.3540, lr_0 = 1.7201e-04
Validation auc = 0.839286
Epoch 23
Loss = 7.9137e-02, PNorm = 64.6024, GNorm = 0.5109, lr_0 = 1.6834e-04
Loss = 5.5292e-02, PNorm = 64.6282, GNorm = 0.5689, lr_0 = 1.6508e-04
Loss = 5.8081e-02, PNorm = 64.6430, GNorm = 0.8069, lr_0 = 1.6188e-04
Loss = 8.5814e-02, PNorm = 64.6652, GNorm = 0.6428, lr_0 = 1.5874e-04
Validation auc = 0.843831
Epoch 24
Loss = 4.7029e-02, PNorm = 64.6887, GNorm = 0.2347, lr_0 = 1.5536e-04
Loss = 5.1576e-02, PNorm = 64.7072, GNorm = 0.3430, lr_0 = 1.5234e-04
Loss = 6.8055e-02, PNorm = 64.7254, GNorm = 0.6861, lr_0 = 1.4939e-04
Loss = 6.7094e-02, PNorm = 64.7392, GNorm = 0.6913, lr_0 = 1.4649e-04
Loss = 6.1297e-02, PNorm = 64.7603, GNorm = 0.5084, lr_0 = 1.4365e-04
Loss = 5.9605e-07, PNorm = 64.7628, GNorm = 0.0000, lr_0 = 1.4337e-04
Validation auc = 0.833117
Epoch 25
Loss = 7.4085e-02, PNorm = 64.7749, GNorm = 0.3502, lr_0 = 1.4059e-04
Loss = 5.9371e-02, PNorm = 64.7923, GNorm = 0.1439, lr_0 = 1.3787e-04
Loss = 6.5754e-02, PNorm = 64.8059, GNorm = 0.4308, lr_0 = 1.3519e-04
Loss = 5.7657e-02, PNorm = 64.8273, GNorm = 0.3716, lr_0 = 1.3257e-04
Validation auc = 0.844805
Epoch 26
Loss = 4.3721e-02, PNorm = 64.8408, GNorm = 0.6427, lr_0 = 1.2975e-04
Loss = 7.1091e-02, PNorm = 64.8491, GNorm = 0.6731, lr_0 = 1.2723e-04
Loss = 6.9235e-02, PNorm = 64.8674, GNorm = 0.9832, lr_0 = 1.2476e-04
Loss = 5.0334e-02, PNorm = 64.8803, GNorm = 0.5825, lr_0 = 1.2234e-04
Validation auc = 0.827922
Epoch 27
Loss = 4.4036e-02, PNorm = 64.8940, GNorm = 0.4991, lr_0 = 1.1974e-04
Loss = 5.1177e-02, PNorm = 64.9045, GNorm = 1.6476, lr_0 = 1.1742e-04
Loss = 6.4563e-02, PNorm = 64.9138, GNorm = 1.0059, lr_0 = 1.1514e-04
Loss = 5.8147e-02, PNorm = 64.9312, GNorm = 0.5447, lr_0 = 1.1291e-04
Validation auc = 0.832468
Epoch 28
Loss = 5.7490e-02, PNorm = 64.9451, GNorm = 0.5457, lr_0 = 1.1050e-04
Loss = 3.0181e-02, PNorm = 64.9573, GNorm = 0.4925, lr_0 = 1.0836e-04
Loss = 4.6313e-02, PNorm = 64.9671, GNorm = 0.4329, lr_0 = 1.0626e-04
Loss = 6.0215e-02, PNorm = 64.9732, GNorm = 0.4401, lr_0 = 1.0420e-04
Validation auc = 0.837013
Epoch 29
Loss = 1.8496e-02, PNorm = 64.9878, GNorm = 0.2414, lr_0 = 1.0198e-04
Loss = 4.2072e-02, PNorm = 64.9973, GNorm = 0.4747, lr_0 = 1.0000e-04
Loss = 4.9373e-02, PNorm = 65.0073, GNorm = 0.9234, lr_0 = 1.0000e-04
Loss = 4.5720e-02, PNorm = 65.0158, GNorm = 0.3998, lr_0 = 1.0000e-04
Loss = 3.5877e-02, PNorm = 65.0258, GNorm = 0.8343, lr_0 = 1.0000e-04
Loss = 4.7684e-07, PNorm = 65.0267, GNorm = 0.0000, lr_0 = 1.0000e-04
Validation auc = 0.841558
Model 0 best validation auc = 0.903896 on epoch 1
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 provided with no test set, no metric evaluation will be performed.
Ensemble test auc = nan
1-fold cross validation
	Seed 0 ==> test auc = nan
Overall test auc = nan +/- nan
Elapsed time = 0:10:36
Command line
python antibiotic.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/shxie/aiddsummary/antibio_reproduction/configew.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'antibiotic_reproduction.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.35,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/shxie/aiddsummary/antibio_reproduction/antibiotic/model_4',
 'save_preds': False,
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Activity'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
Activity 0: 94.86%, 1: 5.14%
Total size = 2,335 | train size = 2,101 | val size = 234 | test size = 0
The test data split is empty. This may be either because splitting with no test set was selected,             such as with `cv-no-test`, or because test data provided with `--separate_test_path` was empty or contained only invalid molecules.             Performance on the test set will not be evaluated and metric scores will return `nan` for each task.
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1600, out_features=1, bias=True)
  )
)
Number of parameters = 5,572,801
Epoch 0
Loss = 2.7557e-01, PNorm = 59.4787, GNorm = 0.5901, lr_0 = 2.1786e-04
Loss = 2.3560e-01, PNorm = 59.5048, GNorm = 0.2575, lr_0 = 3.2500e-04
Loss = 2.4763e-01, PNorm = 59.5346, GNorm = 0.4798, lr_0 = 4.3214e-04
Loss = 1.7671e-01, PNorm = 59.5709, GNorm = 0.2502, lr_0 = 5.3929e-04
Validation auc = 0.850649
Epoch 1
Loss = 2.3510e-01, PNorm = 59.6067, GNorm = 0.3343, lr_0 = 6.5714e-04
Loss = 1.7045e-01, PNorm = 59.6449, GNorm = 0.3607, lr_0 = 7.6429e-04
Loss = 2.4145e-01, PNorm = 59.7015, GNorm = 0.1860, lr_0 = 8.7143e-04
Loss = 1.5107e-01, PNorm = 59.7722, GNorm = 0.3750, lr_0 = 9.7857e-04
Validation auc = 0.908117
Epoch 2
Loss = 2.3160e-01, PNorm = 59.8357, GNorm = 0.2871, lr_0 = 9.8253e-04
Loss = 1.5914e-01, PNorm = 59.8998, GNorm = 0.2105, lr_0 = 9.6348e-04
Loss = 1.9445e-01, PNorm = 59.9547, GNorm = 0.8530, lr_0 = 9.4480e-04
Loss = 2.1030e-01, PNorm = 60.0225, GNorm = 0.1671, lr_0 = 9.2648e-04
Validation auc = 0.898377
Epoch 3
Loss = 2.1441e-01, PNorm = 60.1055, GNorm = 0.4276, lr_0 = 9.0674e-04
Loss = 1.8079e-01, PNorm = 60.1639, GNorm = 0.2939, lr_0 = 8.8916e-04
Loss = 1.9951e-01, PNorm = 60.2202, GNorm = 0.5234, lr_0 = 8.7192e-04
Loss = 2.1060e-01, PNorm = 60.3085, GNorm = 0.2905, lr_0 = 8.5501e-04
Validation auc = 0.880195
Epoch 4
Loss = 1.5945e-01, PNorm = 60.3937, GNorm = 0.1528, lr_0 = 8.3679e-04
Loss = 2.0780e-01, PNorm = 60.4639, GNorm = 0.1902, lr_0 = 8.2057e-04
Loss = 1.7092e-01, PNorm = 60.5383, GNorm = 0.1798, lr_0 = 8.0466e-04
Loss = 1.8219e-01, PNorm = 60.6154, GNorm = 0.3657, lr_0 = 7.8906e-04
Loss = 1.6678e-01, PNorm = 60.6942, GNorm = 0.2111, lr_0 = 7.7376e-04
Loss = 1.7133e-02, PNorm = 60.7025, GNorm = 0.2092, lr_0 = 7.7224e-04
Validation auc = 0.907792
Epoch 5
Loss = 1.4723e-01, PNorm = 60.7679, GNorm = 0.2300, lr_0 = 7.5727e-04
Loss = 1.7787e-01, PNorm = 60.8352, GNorm = 0.3106, lr_0 = 7.4259e-04
Loss = 1.8046e-01, PNorm = 60.9208, GNorm = 0.4092, lr_0 = 7.2819e-04
Loss = 1.7407e-01, PNorm = 60.9980, GNorm = 0.2492, lr_0 = 7.1407e-04
Validation auc = 0.857468
Epoch 6
Loss = 2.3964e-01, PNorm = 61.2105, GNorm = 0.6987, lr_0 = 6.9886e-04
Loss = 1.7823e-01, PNorm = 61.4330, GNorm = 0.3411, lr_0 = 6.8531e-04
Loss = 2.0145e-01, PNorm = 61.5692, GNorm = 0.1959, lr_0 = 6.7202e-04
Loss = 2.1372e-01, PNorm = 61.6645, GNorm = 0.2394, lr_0 = 6.5899e-04
Validation auc = 0.881818
Epoch 7
Loss = 1.6530e-01, PNorm = 61.7514, GNorm = 0.3836, lr_0 = 6.4495e-04
Loss = 2.3806e-01, PNorm = 61.8008, GNorm = 0.2224, lr_0 = 6.3244e-04
Loss = 1.3752e-01, PNorm = 61.8830, GNorm = 0.4454, lr_0 = 6.2018e-04
Loss = 1.6283e-01, PNorm = 61.9220, GNorm = 0.2112, lr_0 = 6.0815e-04
Validation auc = 0.850325
Epoch 8
Loss = 1.8382e-01, PNorm = 61.9733, GNorm = 0.2020, lr_0 = 5.9520e-04
Loss = 1.6150e-01, PNorm = 62.0299, GNorm = 0.2763, lr_0 = 5.8366e-04
Loss = 2.0859e-01, PNorm = 62.1008, GNorm = 0.1715, lr_0 = 5.7234e-04
Loss = 1.3953e-01, PNorm = 62.1703, GNorm = 0.2611, lr_0 = 5.6124e-04
Validation auc = 0.842857
Epoch 9
Loss = 7.4682e-02, PNorm = 62.2675, GNorm = 0.1929, lr_0 = 5.4928e-04
Loss = 1.7092e-01, PNorm = 62.3353, GNorm = 0.2896, lr_0 = 5.3863e-04
Loss = 1.7495e-01, PNorm = 62.4173, GNorm = 0.2608, lr_0 = 5.2819e-04
Loss = 1.1809e-01, PNorm = 62.5087, GNorm = 0.6368, lr_0 = 5.1795e-04
Loss = 1.6889e-01, PNorm = 62.5527, GNorm = 0.2987, lr_0 = 5.0790e-04
Loss = 3.1884e-02, PNorm = 62.5584, GNorm = 0.4152, lr_0 = 5.0691e-04
Validation auc = 0.859740
Epoch 10
Loss = 1.4801e-01, PNorm = 62.6235, GNorm = 0.4485, lr_0 = 4.9708e-04
Loss = 1.3790e-01, PNorm = 62.6840, GNorm = 0.3215, lr_0 = 4.8744e-04
Loss = 1.2340e-01, PNorm = 62.7453, GNorm = 0.3970, lr_0 = 4.7799e-04
Loss = 1.3713e-01, PNorm = 62.7920, GNorm = 0.2428, lr_0 = 4.6873e-04
Validation auc = 0.843831
Epoch 11
Loss = 1.3288e-01, PNorm = 62.8711, GNorm = 0.2481, lr_0 = 4.5874e-04
Loss = 1.2012e-01, PNorm = 62.9207, GNorm = 0.1870, lr_0 = 4.4984e-04
Loss = 1.5511e-01, PNorm = 62.9741, GNorm = 0.5045, lr_0 = 4.4112e-04
Loss = 1.2320e-01, PNorm = 63.0406, GNorm = 0.4130, lr_0 = 4.3257e-04
Validation auc = 0.869481
Epoch 12
Loss = 1.1453e-01, PNorm = 63.1004, GNorm = 0.2819, lr_0 = 4.2335e-04
Loss = 1.2651e-01, PNorm = 63.1480, GNorm = 0.6115, lr_0 = 4.1514e-04
Loss = 1.4089e-01, PNorm = 63.1899, GNorm = 0.4814, lr_0 = 4.0709e-04
Loss = 1.2040e-01, PNorm = 63.2652, GNorm = 0.2617, lr_0 = 3.9920e-04
Validation auc = 0.846104
Epoch 13
Loss = 1.6070e-01, PNorm = 63.3191, GNorm = 0.3143, lr_0 = 3.9069e-04
Loss = 8.4290e-02, PNorm = 63.3573, GNorm = 0.1761, lr_0 = 3.8312e-04
Loss = 1.2541e-01, PNorm = 63.4001, GNorm = 0.4440, lr_0 = 3.7569e-04
Loss = 1.1180e-01, PNorm = 63.4462, GNorm = 0.2201, lr_0 = 3.6841e-04
Validation auc = 0.834416
Epoch 14
Loss = 6.9839e-02, PNorm = 63.4841, GNorm = 0.4779, lr_0 = 3.6056e-04
Loss = 1.3449e-01, PNorm = 63.5329, GNorm = 0.3862, lr_0 = 3.5357e-04
Loss = 9.8912e-02, PNorm = 63.5746, GNorm = 0.4378, lr_0 = 3.4671e-04
Loss = 1.1615e-01, PNorm = 63.6113, GNorm = 0.1763, lr_0 = 3.3999e-04
Loss = 1.0274e-01, PNorm = 63.6538, GNorm = 0.2943, lr_0 = 3.3340e-04
Loss = 4.4155e-02, PNorm = 63.6601, GNorm = 0.6910, lr_0 = 3.3274e-04
Validation auc = 0.841883
Epoch 15
Loss = 8.0191e-02, PNorm = 63.6993, GNorm = 1.3962, lr_0 = 3.2629e-04
Loss = 1.2909e-01, PNorm = 63.7407, GNorm = 0.4822, lr_0 = 3.1996e-04
Loss = 1.2166e-01, PNorm = 63.7882, GNorm = 0.4255, lr_0 = 3.1376e-04
Loss = 8.7091e-02, PNorm = 63.8377, GNorm = 0.2080, lr_0 = 3.0768e-04
Validation auc = 0.825649
Epoch 16
Loss = 1.5391e-01, PNorm = 63.8724, GNorm = 0.4074, lr_0 = 3.0112e-04
Loss = 1.0244e-01, PNorm = 63.9232, GNorm = 1.1378, lr_0 = 2.9528e-04
Loss = 1.0542e-01, PNorm = 63.9465, GNorm = 0.3572, lr_0 = 2.8956e-04
Loss = 9.5176e-02, PNorm = 63.9847, GNorm = 0.2182, lr_0 = 2.8394e-04
Validation auc = 0.868506
Epoch 17
Loss = 8.8436e-02, PNorm = 64.0245, GNorm = 0.5719, lr_0 = 2.7789e-04
Loss = 8.9775e-02, PNorm = 64.0502, GNorm = 0.4170, lr_0 = 2.7250e-04
Loss = 1.1568e-01, PNorm = 64.0840, GNorm = 0.4107, lr_0 = 2.6722e-04
Loss = 8.2433e-02, PNorm = 64.1194, GNorm = 0.3512, lr_0 = 2.6204e-04
Validation auc = 0.836039
Epoch 18
Loss = 6.0144e-02, PNorm = 64.1501, GNorm = 0.2552, lr_0 = 2.5646e-04
Loss = 6.9808e-02, PNorm = 64.1750, GNorm = 0.2796, lr_0 = 2.5148e-04
Loss = 8.6134e-02, PNorm = 64.1998, GNorm = 0.8029, lr_0 = 2.4661e-04
Loss = 1.0741e-01, PNorm = 64.2262, GNorm = 0.6020, lr_0 = 2.4183e-04
Validation auc = 0.835714
Epoch 19
Loss = 7.7404e-02, PNorm = 64.2582, GNorm = 0.3160, lr_0 = 2.3667e-04
Loss = 7.8882e-02, PNorm = 64.2878, GNorm = 0.4347, lr_0 = 2.3208e-04
Loss = 1.0651e-01, PNorm = 64.3173, GNorm = 0.3331, lr_0 = 2.2758e-04
Loss = 6.3958e-02, PNorm = 64.3469, GNorm = 0.3362, lr_0 = 2.2317e-04
Loss = 7.7173e-02, PNorm = 64.3796, GNorm = 0.6639, lr_0 = 2.1884e-04
Loss = 2.7164e-04, PNorm = 64.3834, GNorm = 0.0086, lr_0 = 2.1842e-04
Validation auc = 0.844156
Epoch 20
Loss = 7.0879e-02, PNorm = 64.4096, GNorm = 0.5755, lr_0 = 2.1418e-04
Loss = 2.6056e-02, PNorm = 64.4410, GNorm = 0.1965, lr_0 = 2.1003e-04
Loss = 1.1544e-01, PNorm = 64.4573, GNorm = 0.5246, lr_0 = 2.0596e-04
Loss = 9.6556e-02, PNorm = 64.4875, GNorm = 0.8575, lr_0 = 2.0196e-04
Validation auc = 0.829545
Epoch 21
Loss = 8.0338e-02, PNorm = 64.5227, GNorm = 0.7011, lr_0 = 1.9766e-04
Loss = 7.9936e-02, PNorm = 64.5460, GNorm = 0.6956, lr_0 = 1.9383e-04
Loss = 5.6344e-02, PNorm = 64.5748, GNorm = 0.7695, lr_0 = 1.9007e-04
Loss = 7.0872e-02, PNorm = 64.5928, GNorm = 0.6985, lr_0 = 1.8638e-04
Validation auc = 0.841234
Epoch 22
Loss = 3.1887e-02, PNorm = 64.6227, GNorm = 0.5212, lr_0 = 1.8241e-04
Loss = 4.9799e-02, PNorm = 64.6415, GNorm = 0.2946, lr_0 = 1.7888e-04
Loss = 8.3112e-02, PNorm = 64.6597, GNorm = 0.8724, lr_0 = 1.7541e-04
Loss = 6.4068e-02, PNorm = 64.6833, GNorm = 0.3065, lr_0 = 1.7201e-04
Validation auc = 0.843831
Epoch 23
Loss = 7.5848e-02, PNorm = 64.7066, GNorm = 0.4681, lr_0 = 1.6834e-04
Loss = 6.4586e-02, PNorm = 64.7353, GNorm = 0.6712, lr_0 = 1.6508e-04
Loss = 5.6320e-02, PNorm = 64.7502, GNorm = 0.5441, lr_0 = 1.6188e-04
Loss = 8.8737e-02, PNorm = 64.7744, GNorm = 0.7235, lr_0 = 1.5874e-04
Validation auc = 0.844481
Epoch 24
Loss = 6.4449e-02, PNorm = 64.7976, GNorm = 0.2207, lr_0 = 1.5536e-04
Loss = 5.1225e-02, PNorm = 64.8129, GNorm = 0.3081, lr_0 = 1.5234e-04
Loss = 6.3694e-02, PNorm = 64.8308, GNorm = 0.7433, lr_0 = 1.4939e-04
Loss = 6.6483e-02, PNorm = 64.8454, GNorm = 0.6557, lr_0 = 1.4649e-04
Loss = 7.0014e-02, PNorm = 64.8632, GNorm = 0.8184, lr_0 = 1.4365e-04
Loss = 2.7895e-05, PNorm = 64.8657, GNorm = 0.0013, lr_0 = 1.4337e-04
Validation auc = 0.843182
Epoch 25
Loss = 7.3217e-02, PNorm = 64.8779, GNorm = 0.3887, lr_0 = 1.4059e-04
Loss = 6.1479e-02, PNorm = 64.8917, GNorm = 0.1374, lr_0 = 1.3787e-04
Loss = 6.0864e-02, PNorm = 64.9068, GNorm = 0.6075, lr_0 = 1.3519e-04
Loss = 5.0784e-02, PNorm = 64.9265, GNorm = 0.4624, lr_0 = 1.3257e-04
Validation auc = 0.842532
Epoch 26
Loss = 4.7291e-02, PNorm = 64.9419, GNorm = 0.7466, lr_0 = 1.2975e-04
Loss = 6.9740e-02, PNorm = 64.9520, GNorm = 0.7537, lr_0 = 1.2723e-04
Loss = 6.7475e-02, PNorm = 64.9719, GNorm = 1.0171, lr_0 = 1.2476e-04
Loss = 5.2512e-02, PNorm = 64.9851, GNorm = 0.5498, lr_0 = 1.2234e-04
Validation auc = 0.834091
Epoch 27
Loss = 4.0917e-02, PNorm = 64.9984, GNorm = 0.6465, lr_0 = 1.1974e-04
Loss = 4.9333e-02, PNorm = 65.0101, GNorm = 1.3228, lr_0 = 1.1742e-04
Loss = 5.3080e-02, PNorm = 65.0200, GNorm = 0.8131, lr_0 = 1.1514e-04
Loss = 5.4039e-02, PNorm = 65.0384, GNorm = 0.3567, lr_0 = 1.1291e-04
Validation auc = 0.832792
Epoch 28
Loss = 4.9454e-02, PNorm = 65.0515, GNorm = 0.7833, lr_0 = 1.1050e-04
Loss = 3.1701e-02, PNorm = 65.0661, GNorm = 0.4661, lr_0 = 1.0836e-04
Loss = 4.7322e-02, PNorm = 65.0776, GNorm = 0.4107, lr_0 = 1.0626e-04
Loss = 6.2850e-02, PNorm = 65.0821, GNorm = 0.3699, lr_0 = 1.0420e-04
Validation auc = 0.843506
Epoch 29
Loss = 2.8618e-02, PNorm = 65.0969, GNorm = 0.4246, lr_0 = 1.0198e-04
Loss = 4.1544e-02, PNorm = 65.1063, GNorm = 0.5686, lr_0 = 1.0000e-04
Loss = 5.0969e-02, PNorm = 65.1156, GNorm = 0.7430, lr_0 = 1.0000e-04
Loss = 5.4546e-02, PNorm = 65.1240, GNorm = 0.5046, lr_0 = 1.0000e-04
Loss = 3.6081e-02, PNorm = 65.1345, GNorm = 0.6814, lr_0 = 1.0000e-04
Loss = 1.8000e-05, PNorm = 65.1355, GNorm = 0.0011, lr_0 = 1.0000e-04
Validation auc = 0.847727
Model 0 best validation auc = 0.908117 on epoch 1
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 provided with no test set, no metric evaluation will be performed.
Ensemble test auc = nan
1-fold cross validation
	Seed 0 ==> test auc = nan
Overall test auc = nan +/- nan
Elapsed time = 0:10:27
Command line
python antibiotic.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/shxie/aiddsummary/antibio_reproduction/configew.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'antibiotic_reproduction.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.35,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/shxie/aiddsummary/antibio_reproduction/antibiotic/model_5',
 'save_preds': False,
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Activity'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
Activity 0: 94.86%, 1: 5.14%
Total size = 2,335 | train size = 2,101 | val size = 234 | test size = 0
The test data split is empty. This may be either because splitting with no test set was selected,             such as with `cv-no-test`, or because test data provided with `--separate_test_path` was empty or contained only invalid molecules.             Performance on the test set will not be evaluated and metric scores will return `nan` for each task.
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1600, out_features=1, bias=True)
  )
)
Number of parameters = 5,572,801
Epoch 0
Loss = 2.7557e-01, PNorm = 59.4787, GNorm = 0.5901, lr_0 = 2.1786e-04
Loss = 2.3560e-01, PNorm = 59.5048, GNorm = 0.2575, lr_0 = 3.2500e-04
Loss = 2.4763e-01, PNorm = 59.5346, GNorm = 0.4798, lr_0 = 4.3214e-04
Loss = 1.7671e-01, PNorm = 59.5709, GNorm = 0.2502, lr_0 = 5.3929e-04
Validation auc = 0.850000
Epoch 1
Loss = 2.3511e-01, PNorm = 59.6067, GNorm = 0.3356, lr_0 = 6.5714e-04
Loss = 1.7039e-01, PNorm = 59.6452, GNorm = 0.3607, lr_0 = 7.6429e-04
Loss = 2.4157e-01, PNorm = 59.7020, GNorm = 0.1846, lr_0 = 8.7143e-04
Loss = 1.5125e-01, PNorm = 59.7726, GNorm = 0.3682, lr_0 = 9.7857e-04
Validation auc = 0.912662
Epoch 2
Loss = 2.3118e-01, PNorm = 59.8353, GNorm = 0.2861, lr_0 = 9.8253e-04
Loss = 1.5895e-01, PNorm = 59.8980, GNorm = 0.2108, lr_0 = 9.6348e-04
Loss = 1.9345e-01, PNorm = 59.9548, GNorm = 0.9798, lr_0 = 9.4480e-04
Loss = 2.0697e-01, PNorm = 60.0260, GNorm = 0.1687, lr_0 = 9.2648e-04
Validation auc = 0.894481
Epoch 3
Loss = 2.1386e-01, PNorm = 60.1120, GNorm = 0.4322, lr_0 = 9.0674e-04
Loss = 1.7949e-01, PNorm = 60.1775, GNorm = 0.2948, lr_0 = 8.8916e-04
Loss = 1.9686e-01, PNorm = 60.2420, GNorm = 0.6620, lr_0 = 8.7192e-04
Loss = 2.1015e-01, PNorm = 60.3346, GNorm = 0.2645, lr_0 = 8.5501e-04
Validation auc = 0.891558
Epoch 4
Loss = 1.5753e-01, PNorm = 60.4247, GNorm = 0.1620, lr_0 = 8.3679e-04
Loss = 2.0358e-01, PNorm = 60.5031, GNorm = 0.2100, lr_0 = 8.2057e-04
Loss = 1.7227e-01, PNorm = 60.5850, GNorm = 0.1945, lr_0 = 8.0466e-04
Loss = 1.8066e-01, PNorm = 60.6688, GNorm = 0.3284, lr_0 = 7.8906e-04
Loss = 1.6509e-01, PNorm = 60.7478, GNorm = 0.1998, lr_0 = 7.7376e-04
Loss = 1.5155e-02, PNorm = 60.7563, GNorm = 0.1932, lr_0 = 7.7224e-04
Validation auc = 0.892208
Epoch 5
Loss = 1.4464e-01, PNorm = 60.8227, GNorm = 0.2076, lr_0 = 7.5727e-04
Loss = 1.8616e-01, PNorm = 60.9003, GNorm = 0.2912, lr_0 = 7.4259e-04
Loss = 1.8337e-01, PNorm = 60.9992, GNorm = 0.4666, lr_0 = 7.2819e-04
Loss = 1.8211e-01, PNorm = 61.0698, GNorm = 0.3877, lr_0 = 7.1407e-04
Validation auc = 0.886364
Epoch 6
Loss = 2.5648e-01, PNorm = 61.2583, GNorm = 0.2938, lr_0 = 6.9886e-04
Loss = 1.8561e-01, PNorm = 61.4416, GNorm = 0.3448, lr_0 = 6.8531e-04
Loss = 2.0000e-01, PNorm = 61.5495, GNorm = 0.3217, lr_0 = 6.7202e-04
Loss = 2.0606e-01, PNorm = 61.6085, GNorm = 0.2771, lr_0 = 6.5899e-04
Validation auc = 0.891558
Epoch 7
Loss = 1.6196e-01, PNorm = 61.6878, GNorm = 0.3854, lr_0 = 6.4495e-04
Loss = 2.3942e-01, PNorm = 61.7473, GNorm = 0.2541, lr_0 = 6.3244e-04
Loss = 1.3102e-01, PNorm = 61.8413, GNorm = 0.8511, lr_0 = 6.2018e-04
Loss = 1.5888e-01, PNorm = 61.8889, GNorm = 0.2358, lr_0 = 6.0815e-04
Validation auc = 0.863961
Epoch 8
Loss = 1.8135e-01, PNorm = 61.9543, GNorm = 0.1977, lr_0 = 5.9520e-04
Loss = 1.5056e-01, PNorm = 62.0284, GNorm = 0.2600, lr_0 = 5.8366e-04
Loss = 2.0936e-01, PNorm = 62.1099, GNorm = 0.2577, lr_0 = 5.7234e-04
Loss = 1.3651e-01, PNorm = 62.1918, GNorm = 0.2951, lr_0 = 5.6124e-04
Validation auc = 0.845779
Epoch 9
Loss = 6.7198e-02, PNorm = 62.2740, GNorm = 0.2409, lr_0 = 5.4928e-04
Loss = 1.9956e-01, PNorm = 62.3368, GNorm = 0.3727, lr_0 = 5.3863e-04
Loss = 1.9799e-01, PNorm = 62.4213, GNorm = 0.1947, lr_0 = 5.2819e-04
Loss = 1.2800e-01, PNorm = 62.4940, GNorm = 0.2522, lr_0 = 5.1795e-04
Loss = 1.8444e-01, PNorm = 62.5359, GNorm = 0.1794, lr_0 = 5.0790e-04
Loss = 4.8005e-02, PNorm = 62.5398, GNorm = 0.9172, lr_0 = 5.0691e-04
Validation auc = 0.837013
Epoch 10
Loss = 1.6584e-01, PNorm = 62.5891, GNorm = 0.3231, lr_0 = 4.9708e-04
Loss = 1.4822e-01, PNorm = 62.6449, GNorm = 0.4802, lr_0 = 4.8744e-04
Loss = 1.3803e-01, PNorm = 62.6953, GNorm = 0.5066, lr_0 = 4.7799e-04
Loss = 1.4795e-01, PNorm = 62.7379, GNorm = 0.2212, lr_0 = 4.6873e-04
Validation auc = 0.837987
Epoch 11
Loss = 1.4063e-01, PNorm = 62.7909, GNorm = 0.2865, lr_0 = 4.5874e-04
Loss = 1.1894e-01, PNorm = 62.8374, GNorm = 0.1887, lr_0 = 4.4984e-04
Loss = 1.6261e-01, PNorm = 62.8847, GNorm = 0.6226, lr_0 = 4.4112e-04
Loss = 1.3489e-01, PNorm = 62.9451, GNorm = 0.4549, lr_0 = 4.3257e-04
Validation auc = 0.862987
Epoch 12
Loss = 1.2045e-01, PNorm = 63.0031, GNorm = 0.3509, lr_0 = 4.2335e-04
Loss = 1.2860e-01, PNorm = 63.0530, GNorm = 0.5914, lr_0 = 4.1514e-04
Loss = 1.4275e-01, PNorm = 63.0856, GNorm = 0.4454, lr_0 = 4.0709e-04
Loss = 1.3160e-01, PNorm = 63.1505, GNorm = 0.2534, lr_0 = 3.9920e-04
Validation auc = 0.845779
Epoch 13
Loss = 1.5990e-01, PNorm = 63.2037, GNorm = 0.2558, lr_0 = 3.9069e-04
Loss = 8.7145e-02, PNorm = 63.2420, GNorm = 0.1767, lr_0 = 3.8312e-04
Loss = 1.3088e-01, PNorm = 63.2818, GNorm = 0.4731, lr_0 = 3.7569e-04
Loss = 1.1009e-01, PNorm = 63.3309, GNorm = 0.2465, lr_0 = 3.6841e-04
Validation auc = 0.837013
Epoch 14
Loss = 6.6431e-02, PNorm = 63.3747, GNorm = 0.6156, lr_0 = 3.6056e-04
Loss = 1.4960e-01, PNorm = 63.4228, GNorm = 0.3056, lr_0 = 3.5357e-04
Loss = 1.0867e-01, PNorm = 63.4716, GNorm = 0.3872, lr_0 = 3.4671e-04
Loss = 1.1605e-01, PNorm = 63.5173, GNorm = 0.2250, lr_0 = 3.3999e-04
Loss = 1.0552e-01, PNorm = 63.5636, GNorm = 0.2178, lr_0 = 3.3340e-04
Loss = 1.8038e-02, PNorm = 63.5692, GNorm = 0.2651, lr_0 = 3.3274e-04
Validation auc = 0.844805
Epoch 15
Loss = 7.6452e-02, PNorm = 63.6137, GNorm = 1.2163, lr_0 = 3.2629e-04
Loss = 1.3863e-01, PNorm = 63.6608, GNorm = 0.4748, lr_0 = 3.1996e-04
Loss = 1.3211e-01, PNorm = 63.7099, GNorm = 0.3543, lr_0 = 3.1376e-04
Loss = 9.3222e-02, PNorm = 63.7608, GNorm = 0.2129, lr_0 = 3.0768e-04
Validation auc = 0.838636
Epoch 16
Loss = 1.5736e-01, PNorm = 63.7963, GNorm = 0.4030, lr_0 = 3.0112e-04
Loss = 1.1467e-01, PNorm = 63.8548, GNorm = 0.9255, lr_0 = 2.9528e-04
Loss = 1.2014e-01, PNorm = 63.8755, GNorm = 0.2608, lr_0 = 2.8956e-04
Loss = 1.0138e-01, PNorm = 63.9096, GNorm = 0.2609, lr_0 = 2.8394e-04
Validation auc = 0.857143
Epoch 17
Loss = 1.0548e-01, PNorm = 63.9577, GNorm = 0.4043, lr_0 = 2.7789e-04
Loss = 9.5089e-02, PNorm = 63.9876, GNorm = 0.5454, lr_0 = 2.7250e-04
Loss = 1.1826e-01, PNorm = 64.0221, GNorm = 0.4704, lr_0 = 2.6722e-04
Loss = 9.5130e-02, PNorm = 64.0552, GNorm = 0.4054, lr_0 = 2.6204e-04
Validation auc = 0.836688
Epoch 18
Loss = 6.5155e-02, PNorm = 64.0807, GNorm = 0.3894, lr_0 = 2.5646e-04
Loss = 7.0310e-02, PNorm = 64.1080, GNorm = 0.2563, lr_0 = 2.5148e-04
Loss = 1.0010e-01, PNorm = 64.1370, GNorm = 0.7343, lr_0 = 2.4661e-04
Loss = 1.1165e-01, PNorm = 64.1705, GNorm = 0.7242, lr_0 = 2.4183e-04
Validation auc = 0.831494
Epoch 19
Loss = 8.2172e-02, PNorm = 64.2063, GNorm = 0.2968, lr_0 = 2.3667e-04
Loss = 8.6024e-02, PNorm = 64.2353, GNorm = 0.4757, lr_0 = 2.3208e-04
Loss = 1.1556e-01, PNorm = 64.2674, GNorm = 0.3178, lr_0 = 2.2758e-04
Loss = 7.6745e-02, PNorm = 64.2945, GNorm = 0.3207, lr_0 = 2.2317e-04
Loss = 8.1114e-02, PNorm = 64.3321, GNorm = 0.4791, lr_0 = 2.1884e-04
Loss = 3.6972e-04, PNorm = 64.3367, GNorm = 0.0116, lr_0 = 2.1842e-04
Validation auc = 0.842857
Epoch 20
Loss = 8.3399e-02, PNorm = 64.3651, GNorm = 0.9956, lr_0 = 2.1418e-04
Loss = 3.4380e-02, PNorm = 64.3998, GNorm = 0.1754, lr_0 = 2.1003e-04
Loss = 1.2688e-01, PNorm = 64.4182, GNorm = 0.5274, lr_0 = 2.0596e-04
Loss = 1.0450e-01, PNorm = 64.4510, GNorm = 0.8631, lr_0 = 2.0196e-04
Validation auc = 0.825649
Epoch 21
Loss = 9.1168e-02, PNorm = 64.4872, GNorm = 0.7071, lr_0 = 1.9766e-04
Loss = 8.9450e-02, PNorm = 64.5103, GNorm = 0.6096, lr_0 = 1.9383e-04
Loss = 6.4812e-02, PNorm = 64.5406, GNorm = 0.6337, lr_0 = 1.9007e-04
Loss = 8.1516e-02, PNorm = 64.5578, GNorm = 0.5974, lr_0 = 1.8638e-04
Validation auc = 0.833117
Epoch 22
Loss = 4.0336e-02, PNorm = 64.5839, GNorm = 0.3805, lr_0 = 1.8241e-04
Loss = 4.9516e-02, PNorm = 64.6036, GNorm = 0.2792, lr_0 = 1.7888e-04
Loss = 9.4094e-02, PNorm = 64.6201, GNorm = 0.8576, lr_0 = 1.7541e-04
Loss = 6.6757e-02, PNorm = 64.6451, GNorm = 0.3909, lr_0 = 1.7201e-04
Validation auc = 0.841558
Epoch 23
Loss = 9.1197e-02, PNorm = 64.6622, GNorm = 0.4992, lr_0 = 1.6834e-04
Loss = 7.5824e-02, PNorm = 64.6915, GNorm = 0.6522, lr_0 = 1.6508e-04
Loss = 5.9008e-02, PNorm = 64.7057, GNorm = 0.5424, lr_0 = 1.6188e-04
Loss = 8.8608e-02, PNorm = 64.7348, GNorm = 0.6313, lr_0 = 1.5874e-04
Validation auc = 0.832468
Epoch 24
Loss = 7.1708e-02, PNorm = 64.7541, GNorm = 0.3646, lr_0 = 1.5536e-04
Loss = 5.5771e-02, PNorm = 64.7735, GNorm = 0.2811, lr_0 = 1.5234e-04
Loss = 8.0637e-02, PNorm = 64.7905, GNorm = 0.6175, lr_0 = 1.4939e-04
Loss = 6.5305e-02, PNorm = 64.8057, GNorm = 0.4601, lr_0 = 1.4649e-04
Loss = 7.5722e-02, PNorm = 64.8268, GNorm = 0.5353, lr_0 = 1.4365e-04
Loss = 3.4689e-05, PNorm = 64.8296, GNorm = 0.0018, lr_0 = 1.4337e-04
Validation auc = 0.828247
Epoch 25
Loss = 7.8225e-02, PNorm = 64.8436, GNorm = 0.5074, lr_0 = 1.4059e-04
Loss = 6.1613e-02, PNorm = 64.8564, GNorm = 0.1759, lr_0 = 1.3787e-04
Loss = 6.2437e-02, PNorm = 64.8728, GNorm = 0.6921, lr_0 = 1.3519e-04
Loss = 5.8216e-02, PNorm = 64.8919, GNorm = 0.5069, lr_0 = 1.3257e-04
Validation auc = 0.825000
Epoch 26
Loss = 5.1592e-02, PNorm = 64.9076, GNorm = 1.0498, lr_0 = 1.2975e-04
Loss = 7.3467e-02, PNorm = 64.9165, GNorm = 0.5974, lr_0 = 1.2723e-04
Loss = 7.7533e-02, PNorm = 64.9361, GNorm = 0.9412, lr_0 = 1.2476e-04
Loss = 5.9758e-02, PNorm = 64.9490, GNorm = 0.6096, lr_0 = 1.2234e-04
Validation auc = 0.825000
Epoch 27
Loss = 4.8539e-02, PNorm = 64.9606, GNorm = 0.4763, lr_0 = 1.1974e-04
Loss = 5.9454e-02, PNorm = 64.9722, GNorm = 1.2617, lr_0 = 1.1742e-04
Loss = 6.8214e-02, PNorm = 64.9810, GNorm = 0.6554, lr_0 = 1.1514e-04
Loss = 6.3027e-02, PNorm = 64.9960, GNorm = 0.4024, lr_0 = 1.1291e-04
Validation auc = 0.822403
Epoch 28
Loss = 5.1020e-02, PNorm = 65.0098, GNorm = 0.5461, lr_0 = 1.1050e-04
Loss = 3.6184e-02, PNorm = 65.0227, GNorm = 0.5947, lr_0 = 1.0836e-04
Loss = 5.4510e-02, PNorm = 65.0340, GNorm = 0.3841, lr_0 = 1.0626e-04
Loss = 6.1946e-02, PNorm = 65.0401, GNorm = 0.3088, lr_0 = 1.0420e-04
Validation auc = 0.832143
Epoch 29
Loss = 1.9894e-02, PNorm = 65.0537, GNorm = 0.2950, lr_0 = 1.0198e-04
Loss = 4.2704e-02, PNorm = 65.0641, GNorm = 0.7931, lr_0 = 1.0000e-04
Loss = 5.6709e-02, PNorm = 65.0761, GNorm = 0.7889, lr_0 = 1.0000e-04
Loss = 5.9423e-02, PNorm = 65.0861, GNorm = 0.3019, lr_0 = 1.0000e-04
Loss = 4.3708e-02, PNorm = 65.0936, GNorm = 0.6630, lr_0 = 1.0000e-04
Loss = 2.2650e-06, PNorm = 65.0947, GNorm = 0.0002, lr_0 = 1.0000e-04
Validation auc = 0.834091
Model 0 best validation auc = 0.912662 on epoch 1
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 provided with no test set, no metric evaluation will be performed.
Ensemble test auc = nan
1-fold cross validation
	Seed 0 ==> test auc = nan
Overall test auc = nan +/- nan
Elapsed time = 0:10:38
Command line
python antibiotic.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/shxie/aiddsummary/antibio_reproduction/configew.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'antibiotic_reproduction.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.35,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/shxie/aiddsummary/antibio_reproduction/antibiotic/model_6',
 'save_preds': False,
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Activity'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
Activity 0: 94.86%, 1: 5.14%
Total size = 2,335 | train size = 2,101 | val size = 234 | test size = 0
The test data split is empty. This may be either because splitting with no test set was selected,             such as with `cv-no-test`, or because test data provided with `--separate_test_path` was empty or contained only invalid molecules.             Performance on the test set will not be evaluated and metric scores will return `nan` for each task.
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1600, out_features=1, bias=True)
  )
)
Number of parameters = 5,572,801
Epoch 0
Loss = 2.7557e-01, PNorm = 59.4787, GNorm = 0.5901, lr_0 = 2.1786e-04
Loss = 2.3560e-01, PNorm = 59.5048, GNorm = 0.2575, lr_0 = 3.2500e-04
Loss = 2.4763e-01, PNorm = 59.5346, GNorm = 0.4798, lr_0 = 4.3214e-04
Loss = 1.7671e-01, PNorm = 59.5709, GNorm = 0.2502, lr_0 = 5.3929e-04
Validation auc = 0.850000
Epoch 1
Loss = 2.3511e-01, PNorm = 59.6067, GNorm = 0.3356, lr_0 = 6.5714e-04
Loss = 1.7040e-01, PNorm = 59.6452, GNorm = 0.3607, lr_0 = 7.6429e-04
Loss = 2.4157e-01, PNorm = 59.7020, GNorm = 0.1843, lr_0 = 8.7143e-04
Loss = 1.5122e-01, PNorm = 59.7729, GNorm = 0.3662, lr_0 = 9.7857e-04
Validation auc = 0.912013
Epoch 2
Loss = 2.3145e-01, PNorm = 59.8357, GNorm = 0.2871, lr_0 = 9.8253e-04
Loss = 1.5921e-01, PNorm = 59.8989, GNorm = 0.2108, lr_0 = 9.6348e-04
Loss = 1.9452e-01, PNorm = 59.9540, GNorm = 0.8977, lr_0 = 9.4480e-04
Loss = 2.0884e-01, PNorm = 60.0247, GNorm = 0.1762, lr_0 = 9.2648e-04
Validation auc = 0.895130
Epoch 3
Loss = 2.1342e-01, PNorm = 60.1083, GNorm = 0.4240, lr_0 = 9.0674e-04
Loss = 1.7955e-01, PNorm = 60.1740, GNorm = 0.3058, lr_0 = 8.8916e-04
Loss = 1.9627e-01, PNorm = 60.2397, GNorm = 0.8605, lr_0 = 8.7192e-04
Loss = 2.1095e-01, PNorm = 60.3352, GNorm = 0.2808, lr_0 = 8.5501e-04
Validation auc = 0.900000
Epoch 4
Loss = 1.5839e-01, PNorm = 60.4225, GNorm = 0.1590, lr_0 = 8.3679e-04
Loss = 2.0853e-01, PNorm = 60.4921, GNorm = 0.1836, lr_0 = 8.2057e-04
Loss = 1.7110e-01, PNorm = 60.5671, GNorm = 0.1832, lr_0 = 8.0466e-04
Loss = 1.8344e-01, PNorm = 60.6415, GNorm = 0.3078, lr_0 = 7.8906e-04
Loss = 1.6595e-01, PNorm = 60.7150, GNorm = 0.2134, lr_0 = 7.7376e-04
Loss = 1.7220e-02, PNorm = 60.7220, GNorm = 0.2057, lr_0 = 7.7224e-04
Validation auc = 0.879545
Epoch 5
Loss = 1.4317e-01, PNorm = 60.7885, GNorm = 0.2241, lr_0 = 7.5727e-04
Loss = 1.7596e-01, PNorm = 60.8563, GNorm = 0.2980, lr_0 = 7.4259e-04
Loss = 1.8339e-01, PNorm = 60.9457, GNorm = 0.4757, lr_0 = 7.2819e-04
Loss = 1.7534e-01, PNorm = 61.0255, GNorm = 0.3570, lr_0 = 7.1407e-04
Validation auc = 0.860065
Epoch 6
Loss = 2.5421e-01, PNorm = 61.2339, GNorm = 0.6189, lr_0 = 6.9886e-04
Loss = 1.8514e-01, PNorm = 61.4386, GNorm = 0.3574, lr_0 = 6.8531e-04
Loss = 2.0162e-01, PNorm = 61.5667, GNorm = 0.1867, lr_0 = 6.7202e-04
Loss = 2.1432e-01, PNorm = 61.6615, GNorm = 0.2283, lr_0 = 6.5899e-04
Validation auc = 0.901299
Epoch 7
Loss = 1.6212e-01, PNorm = 61.7498, GNorm = 0.3452, lr_0 = 6.4495e-04
Loss = 2.3528e-01, PNorm = 61.8147, GNorm = 0.5140, lr_0 = 6.3244e-04
Loss = 1.2457e-01, PNorm = 61.8912, GNorm = 0.4692, lr_0 = 6.2018e-04
Loss = 1.5947e-01, PNorm = 61.9415, GNorm = 0.2965, lr_0 = 6.0815e-04
Validation auc = 0.858117
Epoch 8
Loss = 1.8171e-01, PNorm = 62.0062, GNorm = 0.2383, lr_0 = 5.9520e-04
Loss = 1.5140e-01, PNorm = 62.0784, GNorm = 0.3844, lr_0 = 5.8366e-04
Loss = 2.0572e-01, PNorm = 62.1611, GNorm = 0.2326, lr_0 = 5.7234e-04
Loss = 1.4120e-01, PNorm = 62.2400, GNorm = 0.3520, lr_0 = 5.6124e-04
Validation auc = 0.880844
Epoch 9
Loss = 6.7600e-02, PNorm = 62.3172, GNorm = 0.2484, lr_0 = 5.4928e-04
Loss = 1.9205e-01, PNorm = 62.3875, GNorm = 0.5026, lr_0 = 5.3863e-04
Loss = 1.9490e-01, PNorm = 62.4693, GNorm = 0.2672, lr_0 = 5.2819e-04
Loss = 1.2149e-01, PNorm = 62.5461, GNorm = 0.2744, lr_0 = 5.1795e-04
Loss = 1.7345e-01, PNorm = 62.5921, GNorm = 0.2256, lr_0 = 5.0790e-04
Loss = 2.9294e-02, PNorm = 62.5968, GNorm = 0.4870, lr_0 = 5.0691e-04
Validation auc = 0.866234
Epoch 10
Loss = 1.4738e-01, PNorm = 62.6563, GNorm = 0.4842, lr_0 = 4.9708e-04
Loss = 1.3832e-01, PNorm = 62.7062, GNorm = 0.3333, lr_0 = 4.8744e-04
Loss = 1.2541e-01, PNorm = 62.7606, GNorm = 0.4168, lr_0 = 4.7799e-04
Loss = 1.3604e-01, PNorm = 62.8023, GNorm = 0.2626, lr_0 = 4.6873e-04
Validation auc = 0.848377
Epoch 11
Loss = 1.2721e-01, PNorm = 62.8757, GNorm = 0.2288, lr_0 = 4.5874e-04
Loss = 1.1613e-01, PNorm = 62.9163, GNorm = 0.4220, lr_0 = 4.4984e-04
Loss = 1.4877e-01, PNorm = 62.9640, GNorm = 0.3891, lr_0 = 4.4112e-04
Loss = 1.1821e-01, PNorm = 63.0204, GNorm = 0.3500, lr_0 = 4.3257e-04
Validation auc = 0.871429
Epoch 12
Loss = 1.1144e-01, PNorm = 63.0753, GNorm = 0.3061, lr_0 = 4.2335e-04
Loss = 1.2172e-01, PNorm = 63.1201, GNorm = 0.4111, lr_0 = 4.1514e-04
Loss = 1.3713e-01, PNorm = 63.1634, GNorm = 0.4856, lr_0 = 4.0709e-04
Loss = 1.1824e-01, PNorm = 63.2360, GNorm = 0.2031, lr_0 = 3.9920e-04
Validation auc = 0.857143
Epoch 13
Loss = 1.5694e-01, PNorm = 63.2823, GNorm = 0.3063, lr_0 = 3.9069e-04
Loss = 8.3205e-02, PNorm = 63.3230, GNorm = 0.1681, lr_0 = 3.8312e-04
Loss = 1.2961e-01, PNorm = 63.3629, GNorm = 0.5293, lr_0 = 3.7569e-04
Loss = 1.1392e-01, PNorm = 63.4107, GNorm = 0.2775, lr_0 = 3.6841e-04
Validation auc = 0.853896
Epoch 14
Loss = 7.6756e-02, PNorm = 63.4546, GNorm = 0.6911, lr_0 = 3.6056e-04
Loss = 1.4388e-01, PNorm = 63.5057, GNorm = 0.2624, lr_0 = 3.5357e-04
Loss = 1.0255e-01, PNorm = 63.5468, GNorm = 0.3750, lr_0 = 3.4671e-04
Loss = 1.1666e-01, PNorm = 63.5873, GNorm = 0.1842, lr_0 = 3.3999e-04
Loss = 1.0233e-01, PNorm = 63.6280, GNorm = 0.2808, lr_0 = 3.3340e-04
Loss = 2.1509e-02, PNorm = 63.6333, GNorm = 0.3873, lr_0 = 3.3274e-04
Validation auc = 0.856169
Epoch 15
Loss = 7.3924e-02, PNorm = 63.6687, GNorm = 1.5318, lr_0 = 3.2629e-04
Loss = 1.3202e-01, PNorm = 63.7077, GNorm = 0.4428, lr_0 = 3.1996e-04
Loss = 1.2547e-01, PNorm = 63.7545, GNorm = 0.4068, lr_0 = 3.1376e-04
Loss = 8.5829e-02, PNorm = 63.8053, GNorm = 0.2730, lr_0 = 3.0768e-04
Validation auc = 0.805519
Epoch 16
Loss = 1.4870e-01, PNorm = 63.8377, GNorm = 0.5224, lr_0 = 3.0112e-04
Loss = 1.0925e-01, PNorm = 63.8973, GNorm = 1.0018, lr_0 = 2.9528e-04
Loss = 1.1138e-01, PNorm = 63.9227, GNorm = 0.2273, lr_0 = 2.8956e-04
Loss = 9.6411e-02, PNorm = 63.9589, GNorm = 0.2205, lr_0 = 2.8394e-04
Validation auc = 0.862987
Epoch 17
Loss = 8.8697e-02, PNorm = 64.0012, GNorm = 0.4691, lr_0 = 2.7789e-04
Loss = 9.2849e-02, PNorm = 64.0261, GNorm = 0.5378, lr_0 = 2.7250e-04
Loss = 1.1332e-01, PNorm = 64.0586, GNorm = 0.3659, lr_0 = 2.6722e-04
Loss = 8.7789e-02, PNorm = 64.0951, GNorm = 0.3515, lr_0 = 2.6204e-04
Validation auc = 0.848052
Epoch 18
Loss = 5.9111e-02, PNorm = 64.1230, GNorm = 0.2128, lr_0 = 2.5646e-04
Loss = 6.9701e-02, PNorm = 64.1484, GNorm = 0.2797, lr_0 = 2.5148e-04
Loss = 9.4991e-02, PNorm = 64.1730, GNorm = 0.7280, lr_0 = 2.4661e-04
Loss = 1.0344e-01, PNorm = 64.2023, GNorm = 0.6029, lr_0 = 2.4183e-04
Validation auc = 0.844481
Epoch 19
Loss = 7.5054e-02, PNorm = 64.2339, GNorm = 0.3164, lr_0 = 2.3667e-04
Loss = 7.5737e-02, PNorm = 64.2631, GNorm = 0.4130, lr_0 = 2.3208e-04
Loss = 1.1306e-01, PNorm = 64.2940, GNorm = 0.4692, lr_0 = 2.2758e-04
Loss = 6.6988e-02, PNorm = 64.3251, GNorm = 0.4192, lr_0 = 2.2317e-04
Loss = 7.6514e-02, PNorm = 64.3588, GNorm = 0.5239, lr_0 = 2.1884e-04
Loss = 3.9784e-04, PNorm = 64.3626, GNorm = 0.0110, lr_0 = 2.1842e-04
Validation auc = 0.851948
Epoch 20
Loss = 6.8331e-02, PNorm = 64.3893, GNorm = 0.9709, lr_0 = 2.1418e-04
Loss = 2.9394e-02, PNorm = 64.4208, GNorm = 0.1774, lr_0 = 2.1003e-04
Loss = 1.1537e-01, PNorm = 64.4360, GNorm = 0.5354, lr_0 = 2.0596e-04
Loss = 9.8976e-02, PNorm = 64.4676, GNorm = 1.0136, lr_0 = 2.0196e-04
Validation auc = 0.827922
Epoch 21
Loss = 9.0339e-02, PNorm = 64.5028, GNorm = 0.7979, lr_0 = 1.9766e-04
Loss = 8.3534e-02, PNorm = 64.5263, GNorm = 0.7065, lr_0 = 1.9383e-04
Loss = 6.5943e-02, PNorm = 64.5599, GNorm = 0.8314, lr_0 = 1.9007e-04
Loss = 7.3515e-02, PNorm = 64.5746, GNorm = 0.6950, lr_0 = 1.8638e-04
Validation auc = 0.837987
Epoch 22
Loss = 3.6560e-02, PNorm = 64.6040, GNorm = 0.6093, lr_0 = 1.8241e-04
Loss = 4.3600e-02, PNorm = 64.6236, GNorm = 0.3031, lr_0 = 1.7888e-04
Loss = 8.7543e-02, PNorm = 64.6417, GNorm = 0.5336, lr_0 = 1.7541e-04
Loss = 6.4273e-02, PNorm = 64.6646, GNorm = 0.3462, lr_0 = 1.7201e-04
Validation auc = 0.846429
Epoch 23
Loss = 6.9795e-02, PNorm = 64.6886, GNorm = 0.6135, lr_0 = 1.6834e-04
Loss = 7.0665e-02, PNorm = 64.7162, GNorm = 0.8199, lr_0 = 1.6508e-04
Loss = 5.2885e-02, PNorm = 64.7300, GNorm = 0.6508, lr_0 = 1.6188e-04
Loss = 8.2539e-02, PNorm = 64.7567, GNorm = 0.5848, lr_0 = 1.5874e-04
Validation auc = 0.848701
Epoch 24
Loss = 6.3005e-02, PNorm = 64.7773, GNorm = 0.3280, lr_0 = 1.5536e-04
Loss = 4.5222e-02, PNorm = 64.7957, GNorm = 0.3076, lr_0 = 1.5234e-04
Loss = 6.9229e-02, PNorm = 64.8131, GNorm = 0.7209, lr_0 = 1.4939e-04
Loss = 6.5848e-02, PNorm = 64.8278, GNorm = 0.5855, lr_0 = 1.4649e-04
Loss = 7.1807e-02, PNorm = 64.8461, GNorm = 0.5213, lr_0 = 1.4365e-04
Loss = 9.4409e-05, PNorm = 64.8489, GNorm = 0.0036, lr_0 = 1.4337e-04
Validation auc = 0.843831
Epoch 25
Loss = 7.1235e-02, PNorm = 64.8616, GNorm = 0.4070, lr_0 = 1.4059e-04
Loss = 6.1810e-02, PNorm = 64.8771, GNorm = 0.1843, lr_0 = 1.3787e-04
Loss = 5.7329e-02, PNorm = 64.8919, GNorm = 0.4505, lr_0 = 1.3519e-04
Loss = 5.6184e-02, PNorm = 64.9115, GNorm = 0.3736, lr_0 = 1.3257e-04
Validation auc = 0.842532
Epoch 26
Loss = 4.6509e-02, PNorm = 64.9257, GNorm = 0.7564, lr_0 = 1.2975e-04
Loss = 7.3692e-02, PNorm = 64.9374, GNorm = 0.6547, lr_0 = 1.2723e-04
Loss = 6.7856e-02, PNorm = 64.9570, GNorm = 1.0709, lr_0 = 1.2476e-04
Loss = 5.4736e-02, PNorm = 64.9689, GNorm = 0.8371, lr_0 = 1.2234e-04
Validation auc = 0.840909
Epoch 27
Loss = 4.7462e-02, PNorm = 64.9798, GNorm = 0.7327, lr_0 = 1.1974e-04
Loss = 5.3951e-02, PNorm = 64.9923, GNorm = 1.4007, lr_0 = 1.1742e-04
Loss = 6.0896e-02, PNorm = 64.9970, GNorm = 0.9809, lr_0 = 1.1514e-04
Loss = 6.3149e-02, PNorm = 65.0154, GNorm = 0.4611, lr_0 = 1.1291e-04
Validation auc = 0.836688
Epoch 28
Loss = 5.0463e-02, PNorm = 65.0292, GNorm = 0.5792, lr_0 = 1.1050e-04
Loss = 3.3119e-02, PNorm = 65.0408, GNorm = 0.4545, lr_0 = 1.0836e-04
Loss = 4.8092e-02, PNorm = 65.0530, GNorm = 0.4890, lr_0 = 1.0626e-04
Loss = 6.7394e-02, PNorm = 65.0581, GNorm = 0.3641, lr_0 = 1.0420e-04
Validation auc = 0.846429
Epoch 29
Loss = 2.5576e-02, PNorm = 65.0741, GNorm = 0.3187, lr_0 = 1.0198e-04
Loss = 4.2057e-02, PNorm = 65.0844, GNorm = 0.6440, lr_0 = 1.0000e-04
Loss = 5.2304e-02, PNorm = 65.0944, GNorm = 0.8622, lr_0 = 1.0000e-04
Loss = 5.4572e-02, PNorm = 65.1041, GNorm = 0.4533, lr_0 = 1.0000e-04
Loss = 3.6597e-02, PNorm = 65.1119, GNorm = 1.0245, lr_0 = 1.0000e-04
Loss = 2.9683e-05, PNorm = 65.1126, GNorm = 0.0018, lr_0 = 1.0000e-04
Validation auc = 0.844805
Model 0 best validation auc = 0.912013 on epoch 1
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 provided with no test set, no metric evaluation will be performed.
Ensemble test auc = nan
1-fold cross validation
	Seed 0 ==> test auc = nan
Overall test auc = nan +/- nan
Elapsed time = 0:10:44
Command line
python antibiotic.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/shxie/aiddsummary/antibio_reproduction/configew.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'antibiotic_reproduction.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.35,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/shxie/aiddsummary/antibio_reproduction/antibiotic/model_7',
 'save_preds': False,
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Activity'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
Activity 0: 94.86%, 1: 5.14%
Total size = 2,335 | train size = 2,101 | val size = 234 | test size = 0
The test data split is empty. This may be either because splitting with no test set was selected,             such as with `cv-no-test`, or because test data provided with `--separate_test_path` was empty or contained only invalid molecules.             Performance on the test set will not be evaluated and metric scores will return `nan` for each task.
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1600, out_features=1, bias=True)
  )
)
Number of parameters = 5,572,801
Epoch 0
Loss = 2.7557e-01, PNorm = 59.4787, GNorm = 0.5901, lr_0 = 2.1786e-04
Loss = 2.3560e-01, PNorm = 59.5048, GNorm = 0.2572, lr_0 = 3.2500e-04
Loss = 2.4763e-01, PNorm = 59.5346, GNorm = 0.4798, lr_0 = 4.3214e-04
Loss = 1.7675e-01, PNorm = 59.5709, GNorm = 0.2502, lr_0 = 5.3929e-04
Validation auc = 0.847078
Epoch 1
Loss = 2.3511e-01, PNorm = 59.6065, GNorm = 0.3313, lr_0 = 6.5714e-04
Loss = 1.7081e-01, PNorm = 59.6446, GNorm = 0.3609, lr_0 = 7.6429e-04
Loss = 2.4149e-01, PNorm = 59.7015, GNorm = 0.1832, lr_0 = 8.7143e-04
Loss = 1.5115e-01, PNorm = 59.7723, GNorm = 0.3510, lr_0 = 9.7857e-04
Validation auc = 0.908442
Epoch 2
Loss = 2.3032e-01, PNorm = 59.8352, GNorm = 0.2708, lr_0 = 9.8253e-04
Loss = 1.5866e-01, PNorm = 59.8965, GNorm = 0.2029, lr_0 = 9.6348e-04
Loss = 1.9152e-01, PNorm = 59.9529, GNorm = 1.0311, lr_0 = 9.4480e-04
Loss = 2.0528e-01, PNorm = 60.0248, GNorm = 0.1538, lr_0 = 9.2648e-04
Validation auc = 0.889286
Epoch 3
Loss = 2.1616e-01, PNorm = 60.1152, GNorm = 0.4706, lr_0 = 9.0674e-04
Loss = 1.8047e-01, PNorm = 60.1814, GNorm = 0.3010, lr_0 = 8.8916e-04
Loss = 1.9848e-01, PNorm = 60.2436, GNorm = 0.4446, lr_0 = 8.7192e-04
Loss = 2.1152e-01, PNorm = 60.3360, GNorm = 0.2749, lr_0 = 8.5501e-04
Validation auc = 0.883766
Epoch 4
Loss = 1.6064e-01, PNorm = 60.4217, GNorm = 0.1499, lr_0 = 8.3679e-04
Loss = 2.0782e-01, PNorm = 60.4896, GNorm = 0.2003, lr_0 = 8.2057e-04
Loss = 1.6656e-01, PNorm = 60.5693, GNorm = 0.1939, lr_0 = 8.0466e-04
Loss = 1.8606e-01, PNorm = 60.6545, GNorm = 0.3120, lr_0 = 7.8906e-04
Loss = 1.6215e-01, PNorm = 60.7475, GNorm = 0.2206, lr_0 = 7.7376e-04
Loss = 2.2536e-02, PNorm = 60.7560, GNorm = 0.2948, lr_0 = 7.7224e-04
Validation auc = 0.870130
Epoch 5
Loss = 1.4749e-01, PNorm = 60.8307, GNorm = 0.1975, lr_0 = 7.5727e-04
Loss = 1.8078e-01, PNorm = 60.9097, GNorm = 0.2684, lr_0 = 7.4259e-04
Loss = 1.7885e-01, PNorm = 61.0194, GNorm = 0.3838, lr_0 = 7.2819e-04
Loss = 1.8499e-01, PNorm = 61.1096, GNorm = 0.3800, lr_0 = 7.1407e-04
Validation auc = 0.848377
Epoch 6
Loss = 2.4342e-01, PNorm = 61.3191, GNorm = 0.5667, lr_0 = 6.9886e-04
Loss = 1.7425e-01, PNorm = 61.5143, GNorm = 0.2763, lr_0 = 6.8531e-04
Loss = 1.9932e-01, PNorm = 61.6378, GNorm = 0.1876, lr_0 = 6.7202e-04
Loss = 2.1242e-01, PNorm = 61.7329, GNorm = 0.1783, lr_0 = 6.5899e-04
Validation auc = 0.887013
Epoch 7
Loss = 1.5255e-01, PNorm = 61.8188, GNorm = 0.3083, lr_0 = 6.4495e-04
Loss = 2.3125e-01, PNorm = 61.8931, GNorm = 1.3466, lr_0 = 6.3244e-04
Loss = 1.2235e-01, PNorm = 61.9782, GNorm = 0.4485, lr_0 = 6.2018e-04
Loss = 1.5605e-01, PNorm = 62.0283, GNorm = 0.2615, lr_0 = 6.0815e-04
Validation auc = 0.856494
Epoch 8
Loss = 1.7486e-01, PNorm = 62.0895, GNorm = 0.2170, lr_0 = 5.9520e-04
Loss = 1.3548e-01, PNorm = 62.1604, GNorm = 0.3712, lr_0 = 5.8366e-04
Loss = 2.0343e-01, PNorm = 62.2259, GNorm = 0.2650, lr_0 = 5.7234e-04
Loss = 1.3500e-01, PNorm = 62.2947, GNorm = 0.3273, lr_0 = 5.6124e-04
Validation auc = 0.860714
Epoch 9
Loss = 6.7369e-02, PNorm = 62.3678, GNorm = 0.2976, lr_0 = 5.4928e-04
Loss = 1.8463e-01, PNorm = 62.4342, GNorm = 0.2992, lr_0 = 5.3863e-04
Loss = 1.9007e-01, PNorm = 62.5079, GNorm = 0.2145, lr_0 = 5.2819e-04
Loss = 1.1829e-01, PNorm = 62.5840, GNorm = 0.4387, lr_0 = 5.1795e-04
Loss = 1.7707e-01, PNorm = 62.6352, GNorm = 0.3170, lr_0 = 5.0790e-04
Loss = 6.1974e-02, PNorm = 62.6408, GNorm = 1.1553, lr_0 = 5.0691e-04
Validation auc = 0.826948
Epoch 10
Loss = 1.7185e-01, PNorm = 62.6783, GNorm = 0.4558, lr_0 = 4.9708e-04
Loss = 1.3869e-01, PNorm = 62.7196, GNorm = 0.2356, lr_0 = 4.8744e-04
Loss = 1.2664e-01, PNorm = 62.7778, GNorm = 0.4445, lr_0 = 4.7799e-04
Loss = 1.3834e-01, PNorm = 62.8221, GNorm = 0.2149, lr_0 = 4.6873e-04
Validation auc = 0.854870
Epoch 11
Loss = 1.3481e-01, PNorm = 62.8842, GNorm = 0.3190, lr_0 = 4.5874e-04
Loss = 1.1998e-01, PNorm = 62.9165, GNorm = 0.3160, lr_0 = 4.4984e-04
Loss = 1.5865e-01, PNorm = 62.9691, GNorm = 0.3781, lr_0 = 4.4112e-04
Loss = 1.2024e-01, PNorm = 63.0260, GNorm = 0.3792, lr_0 = 4.3257e-04
Validation auc = 0.868506
Epoch 12
Loss = 1.1486e-01, PNorm = 63.0774, GNorm = 0.2882, lr_0 = 4.2335e-04
Loss = 1.2906e-01, PNorm = 63.1131, GNorm = 0.5456, lr_0 = 4.1514e-04
Loss = 1.4307e-01, PNorm = 63.1457, GNorm = 0.5377, lr_0 = 4.0709e-04
Loss = 1.2488e-01, PNorm = 63.2121, GNorm = 0.2077, lr_0 = 3.9920e-04
Validation auc = 0.851299
Epoch 13
Loss = 1.5859e-01, PNorm = 63.2609, GNorm = 0.2548, lr_0 = 3.9069e-04
Loss = 8.5433e-02, PNorm = 63.2967, GNorm = 0.2169, lr_0 = 3.8312e-04
Loss = 1.2980e-01, PNorm = 63.3383, GNorm = 0.7126, lr_0 = 3.7569e-04
Loss = 1.0347e-01, PNorm = 63.3836, GNorm = 0.3942, lr_0 = 3.6841e-04
Validation auc = 0.856169
Epoch 14
Loss = 8.4280e-02, PNorm = 63.4193, GNorm = 0.6685, lr_0 = 3.6056e-04
Loss = 1.4544e-01, PNorm = 63.4723, GNorm = 0.2512, lr_0 = 3.5357e-04
Loss = 1.0774e-01, PNorm = 63.5094, GNorm = 0.3407, lr_0 = 3.4671e-04
Loss = 1.1765e-01, PNorm = 63.5496, GNorm = 0.1845, lr_0 = 3.3999e-04
Loss = 1.0259e-01, PNorm = 63.5879, GNorm = 0.2633, lr_0 = 3.3340e-04
Loss = 1.9755e-02, PNorm = 63.5925, GNorm = 0.2976, lr_0 = 3.3274e-04
Validation auc = 0.878896
Epoch 15
Loss = 8.0177e-02, PNorm = 63.6265, GNorm = 1.0785, lr_0 = 3.2629e-04
Loss = 1.2536e-01, PNorm = 63.6584, GNorm = 0.4634, lr_0 = 3.1996e-04
Loss = 1.2728e-01, PNorm = 63.7003, GNorm = 0.2830, lr_0 = 3.1376e-04
Loss = 8.6842e-02, PNorm = 63.7467, GNorm = 0.2920, lr_0 = 3.0768e-04
Validation auc = 0.822078
Epoch 16
Loss = 1.5471e-01, PNorm = 63.7830, GNorm = 0.4972, lr_0 = 3.0112e-04
Loss = 1.1305e-01, PNorm = 63.8377, GNorm = 0.9673, lr_0 = 2.9528e-04
Loss = 1.0788e-01, PNorm = 63.8622, GNorm = 0.3503, lr_0 = 2.8956e-04
Loss = 9.8075e-02, PNorm = 63.8953, GNorm = 0.2379, lr_0 = 2.8394e-04
Validation auc = 0.857143
Epoch 17
Loss = 9.0301e-02, PNorm = 63.9309, GNorm = 0.4358, lr_0 = 2.7789e-04
Loss = 9.0308e-02, PNorm = 63.9521, GNorm = 0.5628, lr_0 = 2.7250e-04
Loss = 1.1547e-01, PNorm = 63.9809, GNorm = 0.3524, lr_0 = 2.6722e-04
Loss = 9.3209e-02, PNorm = 64.0104, GNorm = 0.4588, lr_0 = 2.6204e-04
Validation auc = 0.843506
Epoch 18
Loss = 5.7991e-02, PNorm = 64.0395, GNorm = 0.3556, lr_0 = 2.5646e-04
Loss = 7.3569e-02, PNorm = 64.0601, GNorm = 0.3311, lr_0 = 2.5148e-04
Loss = 9.2107e-02, PNorm = 64.0845, GNorm = 0.7595, lr_0 = 2.4661e-04
Loss = 1.0370e-01, PNorm = 64.1126, GNorm = 0.6675, lr_0 = 2.4183e-04
Validation auc = 0.839286
Epoch 19
Loss = 7.5095e-02, PNorm = 64.1421, GNorm = 0.3363, lr_0 = 2.3667e-04
Loss = 8.2341e-02, PNorm = 64.1727, GNorm = 0.3244, lr_0 = 2.3208e-04
Loss = 1.1201e-01, PNorm = 64.2012, GNorm = 0.5060, lr_0 = 2.2758e-04
Loss = 7.3416e-02, PNorm = 64.2292, GNorm = 0.4506, lr_0 = 2.2317e-04
Loss = 7.8117e-02, PNorm = 64.2570, GNorm = 0.5282, lr_0 = 2.1884e-04
Loss = 5.4476e-04, PNorm = 64.2601, GNorm = 0.0155, lr_0 = 2.1842e-04
Validation auc = 0.850649
Epoch 20
Loss = 6.8676e-02, PNorm = 64.2861, GNorm = 0.8685, lr_0 = 2.1418e-04
Loss = 2.9775e-02, PNorm = 64.3131, GNorm = 0.2646, lr_0 = 2.1003e-04
Loss = 1.2058e-01, PNorm = 64.3312, GNorm = 0.5888, lr_0 = 2.0596e-04
Loss = 8.9133e-02, PNorm = 64.3572, GNorm = 0.6763, lr_0 = 2.0196e-04
Validation auc = 0.828896
Epoch 21
Loss = 8.8085e-02, PNorm = 64.3908, GNorm = 0.7451, lr_0 = 1.9766e-04
Loss = 8.4130e-02, PNorm = 64.4083, GNorm = 0.7009, lr_0 = 1.9383e-04
Loss = 6.3276e-02, PNorm = 64.4361, GNorm = 0.7545, lr_0 = 1.9007e-04
Loss = 7.8366e-02, PNorm = 64.4507, GNorm = 0.7850, lr_0 = 1.8638e-04
Validation auc = 0.839286
Epoch 22
Loss = 3.6768e-02, PNorm = 64.4808, GNorm = 0.4643, lr_0 = 1.8241e-04
Loss = 4.8805e-02, PNorm = 64.4993, GNorm = 0.2791, lr_0 = 1.7888e-04
Loss = 8.9299e-02, PNorm = 64.5176, GNorm = 0.5919, lr_0 = 1.7541e-04
Loss = 6.8261e-02, PNorm = 64.5374, GNorm = 0.2377, lr_0 = 1.7201e-04
Validation auc = 0.838961
Epoch 23
Loss = 8.1617e-02, PNorm = 64.5571, GNorm = 0.7411, lr_0 = 1.6834e-04
Loss = 7.2045e-02, PNorm = 64.5789, GNorm = 0.7925, lr_0 = 1.6508e-04
Loss = 5.7970e-02, PNorm = 64.5907, GNorm = 0.5458, lr_0 = 1.6188e-04
Loss = 8.4761e-02, PNorm = 64.6146, GNorm = 0.6493, lr_0 = 1.5874e-04
Validation auc = 0.846753
Epoch 24
Loss = 6.0353e-02, PNorm = 64.6353, GNorm = 0.2794, lr_0 = 1.5536e-04
Loss = 4.7550e-02, PNorm = 64.6531, GNorm = 0.3824, lr_0 = 1.5234e-04
Loss = 6.9236e-02, PNorm = 64.6674, GNorm = 0.7236, lr_0 = 1.4939e-04
Loss = 6.7356e-02, PNorm = 64.6808, GNorm = 0.6742, lr_0 = 1.4649e-04
Loss = 6.7512e-02, PNorm = 64.6985, GNorm = 0.3459, lr_0 = 1.4365e-04
Loss = 6.8662e-05, PNorm = 64.7009, GNorm = 0.0029, lr_0 = 1.4337e-04
Validation auc = 0.844481
Epoch 25
Loss = 7.6986e-02, PNorm = 64.7131, GNorm = 0.2955, lr_0 = 1.4059e-04
Loss = 5.7573e-02, PNorm = 64.7287, GNorm = 0.1717, lr_0 = 1.3787e-04
Loss = 6.1204e-02, PNorm = 64.7433, GNorm = 0.7202, lr_0 = 1.3519e-04
Loss = 5.4264e-02, PNorm = 64.7591, GNorm = 0.5399, lr_0 = 1.3257e-04
Validation auc = 0.842208
Epoch 26
Loss = 4.3608e-02, PNorm = 64.7728, GNorm = 0.7879, lr_0 = 1.2975e-04
Loss = 7.3317e-02, PNorm = 64.7840, GNorm = 0.6804, lr_0 = 1.2723e-04
Loss = 6.6748e-02, PNorm = 64.8009, GNorm = 1.2640, lr_0 = 1.2476e-04
Loss = 5.3619e-02, PNorm = 64.8117, GNorm = 0.6465, lr_0 = 1.2234e-04
Validation auc = 0.844481
Epoch 27
Loss = 4.2880e-02, PNorm = 64.8222, GNorm = 0.4589, lr_0 = 1.1974e-04
Loss = 5.1936e-02, PNorm = 64.8306, GNorm = 1.3288, lr_0 = 1.1742e-04
Loss = 6.0518e-02, PNorm = 64.8399, GNorm = 0.9106, lr_0 = 1.1514e-04
Loss = 5.3714e-02, PNorm = 64.8553, GNorm = 0.4070, lr_0 = 1.1291e-04
Validation auc = 0.845130
Epoch 28
Loss = 6.0177e-02, PNorm = 64.8701, GNorm = 0.6909, lr_0 = 1.1050e-04
Loss = 3.2808e-02, PNorm = 64.8817, GNorm = 0.7146, lr_0 = 1.0836e-04
Loss = 4.8959e-02, PNorm = 64.8912, GNorm = 0.4446, lr_0 = 1.0626e-04
Loss = 6.7291e-02, PNorm = 64.8954, GNorm = 0.6511, lr_0 = 1.0420e-04
Validation auc = 0.851623
Epoch 29
Loss = 1.6341e-02, PNorm = 64.9078, GNorm = 0.2024, lr_0 = 1.0198e-04
Loss = 4.4174e-02, PNorm = 64.9175, GNorm = 0.5538, lr_0 = 1.0000e-04
Loss = 5.3539e-02, PNorm = 64.9275, GNorm = 0.7996, lr_0 = 1.0000e-04
Loss = 5.2102e-02, PNorm = 64.9360, GNorm = 0.4382, lr_0 = 1.0000e-04
Loss = 4.0254e-02, PNorm = 64.9443, GNorm = 0.5404, lr_0 = 1.0000e-04
Loss = 2.4199e-05, PNorm = 64.9453, GNorm = 0.0016, lr_0 = 1.0000e-04
Validation auc = 0.849026
Model 0 best validation auc = 0.908442 on epoch 1
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 provided with no test set, no metric evaluation will be performed.
Ensemble test auc = nan
1-fold cross validation
	Seed 0 ==> test auc = nan
Overall test auc = nan +/- nan
Elapsed time = 0:10:41
Command line
python antibiotic.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/shxie/aiddsummary/antibio_reproduction/configew.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'antibiotic_reproduction.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.35,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/shxie/aiddsummary/antibio_reproduction/antibiotic/model_8',
 'save_preds': False,
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Activity'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
Activity 0: 94.86%, 1: 5.14%
Total size = 2,335 | train size = 2,101 | val size = 234 | test size = 0
The test data split is empty. This may be either because splitting with no test set was selected,             such as with `cv-no-test`, or because test data provided with `--separate_test_path` was empty or contained only invalid molecules.             Performance on the test set will not be evaluated and metric scores will return `nan` for each task.
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1600, out_features=1, bias=True)
  )
)
Number of parameters = 5,572,801
Epoch 0
Loss = 2.7557e-01, PNorm = 59.4787, GNorm = 0.5901, lr_0 = 2.1786e-04
Loss = 2.3560e-01, PNorm = 59.5048, GNorm = 0.2575, lr_0 = 3.2500e-04
Loss = 2.4763e-01, PNorm = 59.5346, GNorm = 0.4798, lr_0 = 4.3214e-04
Loss = 1.7671e-01, PNorm = 59.5709, GNorm = 0.2502, lr_0 = 5.3929e-04
Validation auc = 0.850000
Epoch 1
Loss = 2.3511e-01, PNorm = 59.6067, GNorm = 0.3356, lr_0 = 6.5714e-04
Loss = 1.7039e-01, PNorm = 59.6452, GNorm = 0.3606, lr_0 = 7.6429e-04
Loss = 2.4158e-01, PNorm = 59.7020, GNorm = 0.1843, lr_0 = 8.7143e-04
Loss = 1.5128e-01, PNorm = 59.7726, GNorm = 0.3683, lr_0 = 9.7857e-04
Validation auc = 0.912662
Epoch 2
Loss = 2.3135e-01, PNorm = 59.8350, GNorm = 0.2870, lr_0 = 9.8253e-04
Loss = 1.5901e-01, PNorm = 59.8974, GNorm = 0.2096, lr_0 = 9.6348e-04
Loss = 1.9412e-01, PNorm = 59.9531, GNorm = 0.9502, lr_0 = 9.4480e-04
Loss = 2.0783e-01, PNorm = 60.0245, GNorm = 0.1704, lr_0 = 9.2648e-04
Validation auc = 0.895455
Epoch 3
Loss = 2.1522e-01, PNorm = 60.1097, GNorm = 0.4923, lr_0 = 9.0674e-04
Loss = 1.7949e-01, PNorm = 60.1758, GNorm = 0.3254, lr_0 = 8.8916e-04
Loss = 1.9821e-01, PNorm = 60.2368, GNorm = 0.6199, lr_0 = 8.7192e-04
Loss = 2.0994e-01, PNorm = 60.3255, GNorm = 0.2761, lr_0 = 8.5501e-04
Validation auc = 0.869481
Epoch 4
Loss = 1.5647e-01, PNorm = 60.4143, GNorm = 0.1572, lr_0 = 8.3679e-04
Loss = 2.0620e-01, PNorm = 60.4878, GNorm = 0.1803, lr_0 = 8.2057e-04
Loss = 1.7316e-01, PNorm = 60.5650, GNorm = 0.1829, lr_0 = 8.0466e-04
Loss = 1.8158e-01, PNorm = 60.6462, GNorm = 0.3462, lr_0 = 7.8906e-04
Loss = 1.6663e-01, PNorm = 60.7215, GNorm = 0.2058, lr_0 = 7.7376e-04
Loss = 1.8497e-02, PNorm = 60.7296, GNorm = 0.2250, lr_0 = 7.7224e-04
Validation auc = 0.918182
Epoch 5
Loss = 1.4741e-01, PNorm = 60.7893, GNorm = 0.2231, lr_0 = 7.5727e-04
Loss = 1.7311e-01, PNorm = 60.8596, GNorm = 0.3129, lr_0 = 7.4259e-04
Loss = 1.7684e-01, PNorm = 60.9519, GNorm = 0.3703, lr_0 = 7.2819e-04
Loss = 1.7339e-01, PNorm = 61.0286, GNorm = 0.2785, lr_0 = 7.1407e-04
Validation auc = 0.857468
Epoch 6
Loss = 2.5119e-01, PNorm = 61.2507, GNorm = 0.3944, lr_0 = 6.9886e-04
Loss = 1.8722e-01, PNorm = 61.4725, GNorm = 0.4049, lr_0 = 6.8531e-04
Loss = 2.0231e-01, PNorm = 61.6110, GNorm = 0.3454, lr_0 = 6.7202e-04
Loss = 2.1093e-01, PNorm = 61.6774, GNorm = 0.3018, lr_0 = 6.5899e-04
Validation auc = 0.894805
Epoch 7
Loss = 1.6582e-01, PNorm = 61.7604, GNorm = 0.3606, lr_0 = 6.4495e-04
Loss = 2.4035e-01, PNorm = 61.8128, GNorm = 0.2472, lr_0 = 6.3244e-04
Loss = 1.3192e-01, PNorm = 61.8911, GNorm = 0.4157, lr_0 = 6.2018e-04
Loss = 1.6354e-01, PNorm = 61.9290, GNorm = 0.1985, lr_0 = 6.0815e-04
Validation auc = 0.836688
Epoch 8
Loss = 1.8365e-01, PNorm = 61.9841, GNorm = 0.1972, lr_0 = 5.9520e-04
Loss = 1.6296e-01, PNorm = 62.0437, GNorm = 0.2793, lr_0 = 5.8366e-04
Loss = 2.1290e-01, PNorm = 62.1174, GNorm = 0.1736, lr_0 = 5.7234e-04
Loss = 1.4062e-01, PNorm = 62.1903, GNorm = 0.3381, lr_0 = 5.6124e-04
Validation auc = 0.825649
Epoch 9
Loss = 6.6965e-02, PNorm = 62.2820, GNorm = 0.1816, lr_0 = 5.4928e-04
Loss = 2.0162e-01, PNorm = 62.3485, GNorm = 0.2514, lr_0 = 5.3863e-04
Loss = 2.0433e-01, PNorm = 62.4397, GNorm = 0.1768, lr_0 = 5.2819e-04
Loss = 1.3666e-01, PNorm = 62.5245, GNorm = 0.2163, lr_0 = 5.1795e-04
Loss = 1.8170e-01, PNorm = 62.5743, GNorm = 0.1495, lr_0 = 5.0790e-04
Loss = 2.7118e-02, PNorm = 62.5784, GNorm = 0.3125, lr_0 = 5.0691e-04
Validation auc = 0.870455
Epoch 10
Loss = 1.6688e-01, PNorm = 62.6287, GNorm = 0.3252, lr_0 = 4.9708e-04
Loss = 1.5224e-01, PNorm = 62.6902, GNorm = 0.4735, lr_0 = 4.8744e-04
Loss = 1.3973e-01, PNorm = 62.7496, GNorm = 0.2858, lr_0 = 4.7799e-04
Loss = 1.3534e-01, PNorm = 62.8137, GNorm = 0.2290, lr_0 = 4.6873e-04
Validation auc = 0.845130
Epoch 11
Loss = 1.3426e-01, PNorm = 62.8976, GNorm = 0.2782, lr_0 = 4.5874e-04
Loss = 1.2036e-01, PNorm = 62.9425, GNorm = 0.4359, lr_0 = 4.4984e-04
Loss = 1.5570e-01, PNorm = 63.0099, GNorm = 0.3712, lr_0 = 4.4112e-04
Loss = 1.2469e-01, PNorm = 63.0788, GNorm = 0.3378, lr_0 = 4.3257e-04
Validation auc = 0.871753
Epoch 12
Loss = 1.1522e-01, PNorm = 63.1493, GNorm = 0.2839, lr_0 = 4.2335e-04
Loss = 1.2846e-01, PNorm = 63.1987, GNorm = 0.6336, lr_0 = 4.1514e-04
Loss = 1.4560e-01, PNorm = 63.2373, GNorm = 0.9828, lr_0 = 4.0709e-04
Loss = 1.2179e-01, PNorm = 63.3133, GNorm = 0.2319, lr_0 = 3.9920e-04
Validation auc = 0.851948
Epoch 13
Loss = 1.5240e-01, PNorm = 63.3615, GNorm = 0.4005, lr_0 = 3.9069e-04
Loss = 8.8625e-02, PNorm = 63.4048, GNorm = 0.1355, lr_0 = 3.8312e-04
Loss = 1.2856e-01, PNorm = 63.4440, GNorm = 0.4757, lr_0 = 3.7569e-04
Loss = 1.1764e-01, PNorm = 63.4940, GNorm = 0.2231, lr_0 = 3.6841e-04
Validation auc = 0.833117
Epoch 14
Loss = 7.3165e-02, PNorm = 63.5371, GNorm = 0.6016, lr_0 = 3.6056e-04
Loss = 1.3669e-01, PNorm = 63.5878, GNorm = 0.4566, lr_0 = 3.5357e-04
Loss = 1.0673e-01, PNorm = 63.6347, GNorm = 0.5904, lr_0 = 3.4671e-04
Loss = 1.0958e-01, PNorm = 63.6733, GNorm = 0.2602, lr_0 = 3.3999e-04
Loss = 1.0213e-01, PNorm = 63.7181, GNorm = 0.2519, lr_0 = 3.3340e-04
Loss = 2.9202e-02, PNorm = 63.7232, GNorm = 0.4579, lr_0 = 3.3274e-04
Validation auc = 0.847727
Epoch 15
Loss = 7.4198e-02, PNorm = 63.7626, GNorm = 1.1120, lr_0 = 3.2629e-04
Loss = 1.3775e-01, PNorm = 63.7970, GNorm = 0.4595, lr_0 = 3.1996e-04
Loss = 1.2746e-01, PNorm = 63.8400, GNorm = 0.3693, lr_0 = 3.1376e-04
Loss = 9.0431e-02, PNorm = 63.8857, GNorm = 0.2710, lr_0 = 3.0768e-04
Validation auc = 0.838636
Epoch 16
Loss = 1.4788e-01, PNorm = 63.9176, GNorm = 0.4483, lr_0 = 3.0112e-04
Loss = 1.0988e-01, PNorm = 63.9732, GNorm = 0.9544, lr_0 = 2.9528e-04
Loss = 1.0959e-01, PNorm = 63.9944, GNorm = 0.2459, lr_0 = 2.8956e-04
Loss = 9.6340e-02, PNorm = 64.0302, GNorm = 0.2432, lr_0 = 2.8394e-04
Validation auc = 0.866558
Epoch 17
Loss = 9.0764e-02, PNorm = 64.0779, GNorm = 0.5371, lr_0 = 2.7789e-04
Loss = 9.1434e-02, PNorm = 64.1038, GNorm = 0.5665, lr_0 = 2.7250e-04
Loss = 1.1776e-01, PNorm = 64.1394, GNorm = 0.4107, lr_0 = 2.6722e-04
Loss = 8.6031e-02, PNorm = 64.1732, GNorm = 0.4039, lr_0 = 2.6204e-04
Validation auc = 0.841883
Epoch 18
Loss = 5.9251e-02, PNorm = 64.2024, GNorm = 0.2531, lr_0 = 2.5646e-04
Loss = 7.2072e-02, PNorm = 64.2261, GNorm = 0.3607, lr_0 = 2.5148e-04
Loss = 9.0067e-02, PNorm = 64.2517, GNorm = 0.5991, lr_0 = 2.4661e-04
Loss = 1.0109e-01, PNorm = 64.2789, GNorm = 0.6934, lr_0 = 2.4183e-04
Validation auc = 0.834416
Epoch 19
Loss = 6.9347e-02, PNorm = 64.3113, GNorm = 0.3504, lr_0 = 2.3667e-04
Loss = 8.1680e-02, PNorm = 64.3364, GNorm = 0.4356, lr_0 = 2.3208e-04
Loss = 1.1676e-01, PNorm = 64.3663, GNorm = 0.3533, lr_0 = 2.2758e-04
Loss = 6.7140e-02, PNorm = 64.3943, GNorm = 0.3988, lr_0 = 2.2317e-04
Loss = 8.2082e-02, PNorm = 64.4269, GNorm = 0.6004, lr_0 = 2.1884e-04
Loss = 5.0222e-04, PNorm = 64.4309, GNorm = 0.0134, lr_0 = 2.1842e-04
Validation auc = 0.859416
Epoch 20
Loss = 7.2247e-02, PNorm = 64.4560, GNorm = 0.5521, lr_0 = 2.1418e-04
Loss = 3.2825e-02, PNorm = 64.4862, GNorm = 0.2655, lr_0 = 2.1003e-04
Loss = 1.1458e-01, PNorm = 64.5062, GNorm = 0.5402, lr_0 = 2.0596e-04
Loss = 9.7364e-02, PNorm = 64.5367, GNorm = 1.0656, lr_0 = 2.0196e-04
Validation auc = 0.827922
Epoch 21
Loss = 7.9891e-02, PNorm = 64.5684, GNorm = 0.6394, lr_0 = 1.9766e-04
Loss = 8.6939e-02, PNorm = 64.5896, GNorm = 0.9262, lr_0 = 1.9383e-04
Loss = 6.4070e-02, PNorm = 64.6166, GNorm = 0.7727, lr_0 = 1.9007e-04
Loss = 7.5594e-02, PNorm = 64.6346, GNorm = 0.7779, lr_0 = 1.8638e-04
Validation auc = 0.837338
Epoch 22
Loss = 3.5089e-02, PNorm = 64.6657, GNorm = 0.4234, lr_0 = 1.8241e-04
Loss = 4.3241e-02, PNorm = 64.6850, GNorm = 0.2180, lr_0 = 1.7888e-04
Loss = 8.8958e-02, PNorm = 64.7022, GNorm = 0.8544, lr_0 = 1.7541e-04
Loss = 6.8723e-02, PNorm = 64.7259, GNorm = 0.2316, lr_0 = 1.7201e-04
Validation auc = 0.838961
Epoch 23
Loss = 7.0419e-02, PNorm = 64.7470, GNorm = 0.4671, lr_0 = 1.6834e-04
Loss = 6.9149e-02, PNorm = 64.7769, GNorm = 0.7117, lr_0 = 1.6508e-04
Loss = 5.8111e-02, PNorm = 64.7906, GNorm = 0.5935, lr_0 = 1.6188e-04
Loss = 8.8814e-02, PNorm = 64.8174, GNorm = 0.8473, lr_0 = 1.5874e-04
Validation auc = 0.841883
Epoch 24
Loss = 7.3017e-02, PNorm = 64.8394, GNorm = 0.3901, lr_0 = 1.5536e-04
Loss = 5.6421e-02, PNorm = 64.8553, GNorm = 0.3739, lr_0 = 1.5234e-04
Loss = 7.2693e-02, PNorm = 64.8728, GNorm = 0.7161, lr_0 = 1.4939e-04
Loss = 6.4064e-02, PNorm = 64.8871, GNorm = 0.6145, lr_0 = 1.4649e-04
Loss = 6.8733e-02, PNorm = 64.9083, GNorm = 0.4976, lr_0 = 1.4365e-04
Loss = 1.9453e-04, PNorm = 64.9107, GNorm = 0.0083, lr_0 = 1.4337e-04
Validation auc = 0.834740
Epoch 25
Loss = 6.8725e-02, PNorm = 64.9245, GNorm = 0.4202, lr_0 = 1.4059e-04
Loss = 5.8723e-02, PNorm = 64.9400, GNorm = 0.1684, lr_0 = 1.3787e-04
Loss = 6.3079e-02, PNorm = 64.9552, GNorm = 0.4920, lr_0 = 1.3519e-04
Loss = 5.3264e-02, PNorm = 64.9757, GNorm = 0.3776, lr_0 = 1.3257e-04
Validation auc = 0.837662
Epoch 26
Loss = 4.5419e-02, PNorm = 64.9912, GNorm = 0.6779, lr_0 = 1.2975e-04
Loss = 7.2199e-02, PNorm = 65.0019, GNorm = 0.7258, lr_0 = 1.2723e-04
Loss = 7.1130e-02, PNorm = 65.0192, GNorm = 1.0701, lr_0 = 1.2476e-04
Loss = 5.3390e-02, PNorm = 65.0291, GNorm = 0.8320, lr_0 = 1.2234e-04
Validation auc = 0.831818
Epoch 27
Loss = 4.2141e-02, PNorm = 65.0416, GNorm = 0.4999, lr_0 = 1.1974e-04
Loss = 5.8513e-02, PNorm = 65.0530, GNorm = 1.2508, lr_0 = 1.1742e-04
Loss = 6.0846e-02, PNorm = 65.0613, GNorm = 0.7088, lr_0 = 1.1514e-04
Loss = 5.6523e-02, PNorm = 65.0783, GNorm = 0.4573, lr_0 = 1.1291e-04
Validation auc = 0.831169
Epoch 28
Loss = 5.8047e-02, PNorm = 65.0904, GNorm = 0.6204, lr_0 = 1.1050e-04
Loss = 4.1010e-02, PNorm = 65.1056, GNorm = 0.5188, lr_0 = 1.0836e-04
Loss = 5.0272e-02, PNorm = 65.1178, GNorm = 0.4535, lr_0 = 1.0626e-04
Loss = 6.6036e-02, PNorm = 65.1224, GNorm = 0.3117, lr_0 = 1.0420e-04
Validation auc = 0.838312
Epoch 29
Loss = 2.4465e-02, PNorm = 65.1375, GNorm = 0.2903, lr_0 = 1.0198e-04
Loss = 4.2845e-02, PNorm = 65.1482, GNorm = 0.6353, lr_0 = 1.0000e-04
Loss = 4.5950e-02, PNorm = 65.1581, GNorm = 0.5623, lr_0 = 1.0000e-04
Loss = 5.1429e-02, PNorm = 65.1690, GNorm = 0.4847, lr_0 = 1.0000e-04
Loss = 3.9145e-02, PNorm = 65.1788, GNorm = 0.9151, lr_0 = 1.0000e-04
Loss = 3.9457e-05, PNorm = 65.1798, GNorm = 0.0026, lr_0 = 1.0000e-04
Validation auc = 0.843831
Model 0 best validation auc = 0.918182 on epoch 4
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 provided with no test set, no metric evaluation will be performed.
Ensemble test auc = nan
1-fold cross validation
	Seed 0 ==> test auc = nan
Overall test auc = nan +/- nan
Elapsed time = 0:10:35
Command line
python antibiotic.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/shxie/aiddsummary/antibio_reproduction/configew.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'antibiotic_reproduction.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.35,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/shxie/aiddsummary/antibio_reproduction/antibiotic/model_9',
 'save_preds': False,
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Activity'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
Activity 0: 94.86%, 1: 5.14%
Total size = 2,335 | train size = 2,101 | val size = 234 | test size = 0
The test data split is empty. This may be either because splitting with no test set was selected,             such as with `cv-no-test`, or because test data provided with `--separate_test_path` was empty or contained only invalid molecules.             Performance on the test set will not be evaluated and metric scores will return `nan` for each task.
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1600, out_features=1, bias=True)
  )
)
Number of parameters = 5,572,801
Epoch 0
Loss = 2.7557e-01, PNorm = 59.4787, GNorm = 0.5901, lr_0 = 2.1786e-04
Loss = 2.3560e-01, PNorm = 59.5048, GNorm = 0.2575, lr_0 = 3.2500e-04
Loss = 2.4763e-01, PNorm = 59.5346, GNorm = 0.4798, lr_0 = 4.3214e-04
Loss = 1.7671e-01, PNorm = 59.5709, GNorm = 0.2502, lr_0 = 5.3929e-04
Validation auc = 0.850000
Epoch 1
Loss = 2.3509e-01, PNorm = 59.6068, GNorm = 0.3348, lr_0 = 6.5714e-04
Loss = 1.7039e-01, PNorm = 59.6452, GNorm = 0.3607, lr_0 = 7.6429e-04
Loss = 2.4138e-01, PNorm = 59.7021, GNorm = 0.1848, lr_0 = 8.7143e-04
Loss = 1.5109e-01, PNorm = 59.7730, GNorm = 0.3484, lr_0 = 9.7857e-04
Validation auc = 0.911688
Epoch 2
Loss = 2.3166e-01, PNorm = 59.8367, GNorm = 0.2866, lr_0 = 9.8253e-04
Loss = 1.5913e-01, PNorm = 59.9004, GNorm = 0.2110, lr_0 = 9.6348e-04
Loss = 1.9507e-01, PNorm = 59.9537, GNorm = 0.7739, lr_0 = 9.4480e-04
Loss = 2.1285e-01, PNorm = 60.0224, GNorm = 0.1787, lr_0 = 9.2648e-04
Validation auc = 0.903571
Epoch 3
Loss = 2.1319e-01, PNorm = 60.1054, GNorm = 0.3871, lr_0 = 9.0674e-04
Loss = 1.8070e-01, PNorm = 60.1644, GNorm = 0.2973, lr_0 = 8.8916e-04
Loss = 1.9947e-01, PNorm = 60.2201, GNorm = 0.4637, lr_0 = 8.7192e-04
Loss = 2.0979e-01, PNorm = 60.3055, GNorm = 0.2850, lr_0 = 8.5501e-04
Validation auc = 0.865909
Epoch 4
Loss = 1.6135e-01, PNorm = 60.3954, GNorm = 0.1474, lr_0 = 8.3679e-04
Loss = 2.0803e-01, PNorm = 60.4703, GNorm = 0.1736, lr_0 = 8.2057e-04
Loss = 1.7371e-01, PNorm = 60.5500, GNorm = 0.1580, lr_0 = 8.0466e-04
Loss = 1.8310e-01, PNorm = 60.6234, GNorm = 0.2857, lr_0 = 7.8906e-04
Loss = 1.6629e-01, PNorm = 60.6939, GNorm = 0.1911, lr_0 = 7.7376e-04
Loss = 1.9555e-02, PNorm = 60.7018, GNorm = 0.2270, lr_0 = 7.7224e-04
Validation auc = 0.909091
Epoch 5
Loss = 1.4512e-01, PNorm = 60.7709, GNorm = 0.2113, lr_0 = 7.5727e-04
Loss = 1.7769e-01, PNorm = 60.8436, GNorm = 0.2772, lr_0 = 7.4259e-04
Loss = 1.7716e-01, PNorm = 60.9391, GNorm = 0.3906, lr_0 = 7.2819e-04
Loss = 1.7731e-01, PNorm = 61.0120, GNorm = 0.3970, lr_0 = 7.1407e-04
Validation auc = 0.862987
Epoch 6
Loss = 2.3613e-01, PNorm = 61.2149, GNorm = 0.4400, lr_0 = 6.9886e-04
Loss = 1.8653e-01, PNorm = 61.4150, GNorm = 0.3924, lr_0 = 6.8531e-04
Loss = 2.0119e-01, PNorm = 61.5429, GNorm = 0.3679, lr_0 = 6.7202e-04
Loss = 2.0810e-01, PNorm = 61.6127, GNorm = 0.3115, lr_0 = 6.5899e-04
Validation auc = 0.879870
Epoch 7
Loss = 1.6457e-01, PNorm = 61.7012, GNorm = 0.4281, lr_0 = 6.4495e-04
Loss = 2.3450e-01, PNorm = 61.7729, GNorm = 0.3820, lr_0 = 6.3244e-04
Loss = 1.2198e-01, PNorm = 61.8613, GNorm = 0.4512, lr_0 = 6.2018e-04
Loss = 1.6072e-01, PNorm = 61.9237, GNorm = 0.4679, lr_0 = 6.0815e-04
Validation auc = 0.858442
Epoch 8
Loss = 1.8151e-01, PNorm = 62.0015, GNorm = 0.3128, lr_0 = 5.9520e-04
Loss = 1.3859e-01, PNorm = 62.0848, GNorm = 0.6662, lr_0 = 5.8366e-04
Loss = 1.9598e-01, PNorm = 62.1717, GNorm = 0.9816, lr_0 = 5.7234e-04
Loss = 1.4312e-01, PNorm = 62.2472, GNorm = 0.2787, lr_0 = 5.6124e-04
Validation auc = 0.864286
Epoch 9
Loss = 7.9322e-02, PNorm = 62.3276, GNorm = 0.2477, lr_0 = 5.4928e-04
Loss = 1.7327e-01, PNorm = 62.4062, GNorm = 0.2854, lr_0 = 5.3863e-04
Loss = 1.8193e-01, PNorm = 62.4844, GNorm = 0.2409, lr_0 = 5.2819e-04
Loss = 1.1614e-01, PNorm = 62.5771, GNorm = 0.5271, lr_0 = 5.1795e-04
Loss = 1.6985e-01, PNorm = 62.6171, GNorm = 0.2190, lr_0 = 5.0790e-04
Loss = 4.1149e-02, PNorm = 62.6218, GNorm = 0.5865, lr_0 = 5.0691e-04
Validation auc = 0.855519
Epoch 10
Loss = 1.4935e-01, PNorm = 62.6750, GNorm = 0.4345, lr_0 = 4.9708e-04
Loss = 1.3428e-01, PNorm = 62.7316, GNorm = 0.3658, lr_0 = 4.8744e-04
Loss = 1.1927e-01, PNorm = 62.7887, GNorm = 0.3987, lr_0 = 4.7799e-04
Loss = 1.3251e-01, PNorm = 62.8312, GNorm = 0.2756, lr_0 = 4.6873e-04
Validation auc = 0.850325
Epoch 11
Loss = 1.2928e-01, PNorm = 62.9088, GNorm = 0.2625, lr_0 = 4.5874e-04
Loss = 1.1729e-01, PNorm = 62.9455, GNorm = 0.3750, lr_0 = 4.4984e-04
Loss = 1.5340e-01, PNorm = 63.0007, GNorm = 0.4975, lr_0 = 4.4112e-04
Loss = 1.2517e-01, PNorm = 63.0643, GNorm = 0.4101, lr_0 = 4.3257e-04
Validation auc = 0.886039
Epoch 12
Loss = 1.1476e-01, PNorm = 63.1222, GNorm = 0.2914, lr_0 = 4.2335e-04
Loss = 1.2448e-01, PNorm = 63.1629, GNorm = 0.4164, lr_0 = 4.1514e-04
Loss = 1.3825e-01, PNorm = 63.2044, GNorm = 0.3740, lr_0 = 4.0709e-04
Loss = 1.1739e-01, PNorm = 63.2732, GNorm = 0.3199, lr_0 = 3.9920e-04
Validation auc = 0.837987
Epoch 13
Loss = 1.6204e-01, PNorm = 63.3192, GNorm = 0.3387, lr_0 = 3.9069e-04
Loss = 8.7399e-02, PNorm = 63.3618, GNorm = 0.1651, lr_0 = 3.8312e-04
Loss = 1.2687e-01, PNorm = 63.4082, GNorm = 0.4615, lr_0 = 3.7569e-04
Loss = 1.0929e-01, PNorm = 63.4572, GNorm = 0.2838, lr_0 = 3.6841e-04
Validation auc = 0.850974
Epoch 14
Loss = 7.8101e-02, PNorm = 63.5004, GNorm = 0.5484, lr_0 = 3.6056e-04
Loss = 1.4363e-01, PNorm = 63.5498, GNorm = 0.3643, lr_0 = 3.5357e-04
Loss = 1.0067e-01, PNorm = 63.5935, GNorm = 0.3759, lr_0 = 3.4671e-04
Loss = 1.1813e-01, PNorm = 63.6337, GNorm = 0.1776, lr_0 = 3.3999e-04
Loss = 1.0485e-01, PNorm = 63.6761, GNorm = 0.2760, lr_0 = 3.3340e-04
Loss = 3.2795e-02, PNorm = 63.6819, GNorm = 0.4724, lr_0 = 3.3274e-04
Validation auc = 0.847727
Epoch 15
Loss = 8.1914e-02, PNorm = 63.7216, GNorm = 1.5895, lr_0 = 3.2629e-04
Loss = 1.2454e-01, PNorm = 63.7566, GNorm = 0.4791, lr_0 = 3.1996e-04
Loss = 1.2443e-01, PNorm = 63.8039, GNorm = 0.3538, lr_0 = 3.1376e-04
Loss = 8.7850e-02, PNorm = 63.8561, GNorm = 0.2422, lr_0 = 3.0768e-04
Validation auc = 0.814610
Epoch 16
Loss = 1.5493e-01, PNorm = 63.8870, GNorm = 0.4775, lr_0 = 3.0112e-04
Loss = 1.1118e-01, PNorm = 63.9458, GNorm = 0.8147, lr_0 = 2.9528e-04
Loss = 1.1849e-01, PNorm = 63.9758, GNorm = 0.1923, lr_0 = 2.8956e-04
Loss = 9.8686e-02, PNorm = 64.0104, GNorm = 0.2486, lr_0 = 2.8394e-04
Validation auc = 0.859091
Epoch 17
Loss = 8.9310e-02, PNorm = 64.0616, GNorm = 0.4977, lr_0 = 2.7789e-04
Loss = 9.1052e-02, PNorm = 64.0873, GNorm = 0.5288, lr_0 = 2.7250e-04
Loss = 1.1452e-01, PNorm = 64.1246, GNorm = 0.3358, lr_0 = 2.6722e-04
Loss = 8.7551e-02, PNorm = 64.1607, GNorm = 0.6048, lr_0 = 2.6204e-04
Validation auc = 0.838636
Epoch 18
Loss = 6.3928e-02, PNorm = 64.1949, GNorm = 0.3625, lr_0 = 2.5646e-04
Loss = 7.2092e-02, PNorm = 64.2206, GNorm = 0.3070, lr_0 = 2.5148e-04
Loss = 9.1526e-02, PNorm = 64.2466, GNorm = 0.7576, lr_0 = 2.4661e-04
Loss = 1.0871e-01, PNorm = 64.2800, GNorm = 0.6563, lr_0 = 2.4183e-04
Validation auc = 0.835390
Epoch 19
Loss = 7.4351e-02, PNorm = 64.3113, GNorm = 0.2527, lr_0 = 2.3667e-04
Loss = 7.4143e-02, PNorm = 64.3430, GNorm = 0.5157, lr_0 = 2.3208e-04
Loss = 1.1652e-01, PNorm = 64.3718, GNorm = 0.3818, lr_0 = 2.2758e-04
Loss = 7.1051e-02, PNorm = 64.4056, GNorm = 0.4046, lr_0 = 2.2317e-04
Loss = 8.3235e-02, PNorm = 64.4385, GNorm = 0.4175, lr_0 = 2.1884e-04
Loss = 4.3454e-04, PNorm = 64.4422, GNorm = 0.0122, lr_0 = 2.1842e-04
Validation auc = 0.852922
Epoch 20
Loss = 7.0920e-02, PNorm = 64.4704, GNorm = 0.6037, lr_0 = 2.1418e-04
Loss = 3.1724e-02, PNorm = 64.5053, GNorm = 0.2405, lr_0 = 2.1003e-04
Loss = 1.1643e-01, PNorm = 64.5216, GNorm = 0.5689, lr_0 = 2.0596e-04
Loss = 9.7969e-02, PNorm = 64.5517, GNorm = 0.9607, lr_0 = 2.0196e-04
Validation auc = 0.825649
Epoch 21
Loss = 8.2142e-02, PNorm = 64.5913, GNorm = 0.7557, lr_0 = 1.9766e-04
Loss = 7.9081e-02, PNorm = 64.6172, GNorm = 0.8274, lr_0 = 1.9383e-04
Loss = 6.3907e-02, PNorm = 64.6491, GNorm = 0.8990, lr_0 = 1.9007e-04
Loss = 7.6388e-02, PNorm = 64.6634, GNorm = 0.5137, lr_0 = 1.8638e-04
Validation auc = 0.831818
Epoch 22
Loss = 4.4774e-02, PNorm = 64.6960, GNorm = 0.5744, lr_0 = 1.8241e-04
Loss = 4.8570e-02, PNorm = 64.7165, GNorm = 0.2894, lr_0 = 1.7888e-04
Loss = 8.7467e-02, PNorm = 64.7351, GNorm = 0.7222, lr_0 = 1.7541e-04
Loss = 6.0987e-02, PNorm = 64.7605, GNorm = 0.3580, lr_0 = 1.7201e-04
Validation auc = 0.836364
Epoch 23
Loss = 7.6658e-02, PNorm = 64.7843, GNorm = 0.4846, lr_0 = 1.6834e-04
Loss = 6.3456e-02, PNorm = 64.8131, GNorm = 0.7744, lr_0 = 1.6508e-04
Loss = 5.3546e-02, PNorm = 64.8283, GNorm = 0.7076, lr_0 = 1.6188e-04
Loss = 9.7583e-02, PNorm = 64.8528, GNorm = 0.6882, lr_0 = 1.5874e-04
Validation auc = 0.842532
Epoch 24
Loss = 5.9209e-02, PNorm = 64.8778, GNorm = 0.2528, lr_0 = 1.5536e-04
Loss = 5.4419e-02, PNorm = 64.8964, GNorm = 0.4051, lr_0 = 1.5234e-04
Loss = 6.9527e-02, PNorm = 64.9162, GNorm = 0.7478, lr_0 = 1.4939e-04
Loss = 6.0306e-02, PNorm = 64.9334, GNorm = 0.5169, lr_0 = 1.4649e-04
Loss = 6.2897e-02, PNorm = 64.9513, GNorm = 0.5244, lr_0 = 1.4365e-04
Loss = 2.0742e-05, PNorm = 64.9538, GNorm = 0.0012, lr_0 = 1.4337e-04
Validation auc = 0.830519
Epoch 25
Loss = 7.0340e-02, PNorm = 64.9651, GNorm = 0.4223, lr_0 = 1.4059e-04
Loss = 6.3015e-02, PNorm = 64.9806, GNorm = 0.2814, lr_0 = 1.3787e-04
Loss = 6.0381e-02, PNorm = 65.0010, GNorm = 0.7060, lr_0 = 1.3519e-04
Loss = 5.4934e-02, PNorm = 65.0195, GNorm = 0.3994, lr_0 = 1.3257e-04
Validation auc = 0.849351
Epoch 26
Loss = 4.1198e-02, PNorm = 65.0386, GNorm = 0.5334, lr_0 = 1.2975e-04
Loss = 7.4849e-02, PNorm = 65.0517, GNorm = 0.6239, lr_0 = 1.2723e-04
Loss = 6.9090e-02, PNorm = 65.0730, GNorm = 1.1949, lr_0 = 1.2476e-04
Loss = 4.9126e-02, PNorm = 65.0863, GNorm = 0.6875, lr_0 = 1.2234e-04
Validation auc = 0.829870
Epoch 27
Loss = 4.1193e-02, PNorm = 65.0991, GNorm = 0.5886, lr_0 = 1.1974e-04
Loss = 4.9364e-02, PNorm = 65.1093, GNorm = 1.5719, lr_0 = 1.1742e-04
Loss = 6.6617e-02, PNorm = 65.1236, GNorm = 0.8815, lr_0 = 1.1514e-04
Loss = 6.4836e-02, PNorm = 65.1397, GNorm = 0.6588, lr_0 = 1.1291e-04
Validation auc = 0.829545
Epoch 28
Loss = 4.8251e-02, PNorm = 65.1574, GNorm = 0.5715, lr_0 = 1.1050e-04
Loss = 3.2439e-02, PNorm = 65.1682, GNorm = 0.6157, lr_0 = 1.0836e-04
Loss = 4.2848e-02, PNorm = 65.1793, GNorm = 0.4078, lr_0 = 1.0626e-04
Loss = 5.8317e-02, PNorm = 65.1871, GNorm = 0.3394, lr_0 = 1.0420e-04
Validation auc = 0.836688
Epoch 29
Loss = 2.1302e-02, PNorm = 65.2007, GNorm = 0.2689, lr_0 = 1.0198e-04
Loss = 4.0883e-02, PNorm = 65.2123, GNorm = 0.9896, lr_0 = 1.0000e-04
Loss = 4.7052e-02, PNorm = 65.2248, GNorm = 0.8746, lr_0 = 1.0000e-04
Loss = 5.4567e-02, PNorm = 65.2351, GNorm = 0.4732, lr_0 = 1.0000e-04
Loss = 3.7820e-02, PNorm = 65.2453, GNorm = 0.9867, lr_0 = 1.0000e-04
Loss = 6.0318e-05, PNorm = 65.2460, GNorm = 0.0042, lr_0 = 1.0000e-04
Validation auc = 0.837013
Model 0 best validation auc = 0.911688 on epoch 1
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 provided with no test set, no metric evaluation will be performed.
Ensemble test auc = nan
1-fold cross validation
	Seed 0 ==> test auc = nan
Overall test auc = nan +/- nan
Elapsed time = 0:10:37
Command line
python antibiotic.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/shxie/aiddsummary/antibio_reproduction/configew.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'antibiotic_reproduction.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.35,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/shxie/aiddsummary/antibio_reproduction/antibiotic/model_10',
 'save_preds': False,
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Activity'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
Activity 0: 94.86%, 1: 5.14%
Total size = 2,335 | train size = 2,101 | val size = 234 | test size = 0
The test data split is empty. This may be either because splitting with no test set was selected,             such as with `cv-no-test`, or because test data provided with `--separate_test_path` was empty or contained only invalid molecules.             Performance on the test set will not be evaluated and metric scores will return `nan` for each task.
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1600, out_features=1, bias=True)
  )
)
Number of parameters = 5,572,801
Epoch 0
Loss = 2.7557e-01, PNorm = 59.4787, GNorm = 0.5901, lr_0 = 2.1786e-04
Loss = 2.3560e-01, PNorm = 59.5048, GNorm = 0.2575, lr_0 = 3.2500e-04
Loss = 2.4763e-01, PNorm = 59.5346, GNorm = 0.4798, lr_0 = 4.3214e-04
Loss = 1.7671e-01, PNorm = 59.5709, GNorm = 0.2502, lr_0 = 5.3929e-04
Validation auc = 0.850000
Epoch 1
Loss = 2.3511e-01, PNorm = 59.6067, GNorm = 0.3356, lr_0 = 6.5714e-04
Loss = 1.7039e-01, PNorm = 59.6452, GNorm = 0.3607, lr_0 = 7.6429e-04
Loss = 2.4159e-01, PNorm = 59.7020, GNorm = 0.1847, lr_0 = 8.7143e-04
Loss = 1.5136e-01, PNorm = 59.7727, GNorm = 0.3715, lr_0 = 9.7857e-04
Validation auc = 0.912662
Epoch 2
Loss = 2.3121e-01, PNorm = 59.8348, GNorm = 0.2870, lr_0 = 9.8253e-04
Loss = 1.5894e-01, PNorm = 59.8973, GNorm = 0.2094, lr_0 = 9.6348e-04
Loss = 1.9383e-01, PNorm = 59.9528, GNorm = 0.9936, lr_0 = 9.4480e-04
Loss = 2.0695e-01, PNorm = 60.0245, GNorm = 0.1717, lr_0 = 9.2648e-04
Validation auc = 0.893182
Epoch 3
Loss = 2.1388e-01, PNorm = 60.1101, GNorm = 0.4406, lr_0 = 9.0674e-04
Loss = 1.7943e-01, PNorm = 60.1755, GNorm = 0.2993, lr_0 = 8.8916e-04
Loss = 1.9744e-01, PNorm = 60.2390, GNorm = 0.6333, lr_0 = 8.7192e-04
Loss = 2.0991e-01, PNorm = 60.3333, GNorm = 0.2748, lr_0 = 8.5501e-04
Validation auc = 0.891883
Epoch 4
Loss = 1.5749e-01, PNorm = 60.4220, GNorm = 0.1573, lr_0 = 8.3679e-04
Loss = 2.0813e-01, PNorm = 60.4968, GNorm = 0.2099, lr_0 = 8.2057e-04
Loss = 1.7309e-01, PNorm = 60.5781, GNorm = 0.1861, lr_0 = 8.0466e-04
Loss = 1.8542e-01, PNorm = 60.6578, GNorm = 0.3265, lr_0 = 7.8906e-04
Loss = 1.6737e-01, PNorm = 60.7334, GNorm = 0.2043, lr_0 = 7.7376e-04
Loss = 1.8366e-02, PNorm = 60.7411, GNorm = 0.2101, lr_0 = 7.7224e-04
Validation auc = 0.875649
Epoch 5
Loss = 1.4261e-01, PNorm = 60.8109, GNorm = 0.2255, lr_0 = 7.5727e-04
Loss = 1.7184e-01, PNorm = 60.8768, GNorm = 0.3427, lr_0 = 7.4259e-04
Loss = 1.8449e-01, PNorm = 60.9672, GNorm = 0.5609, lr_0 = 7.2819e-04
Loss = 1.6971e-01, PNorm = 61.0480, GNorm = 0.2985, lr_0 = 7.1407e-04
Validation auc = 0.854545
Epoch 6
Loss = 2.6413e-01, PNorm = 61.2746, GNorm = 0.8795, lr_0 = 6.9886e-04
Loss = 1.7495e-01, PNorm = 61.5066, GNorm = 0.2295, lr_0 = 6.8531e-04
Loss = 1.9845e-01, PNorm = 61.6448, GNorm = 0.1808, lr_0 = 6.7202e-04
Loss = 2.1462e-01, PNorm = 61.7492, GNorm = 0.1930, lr_0 = 6.5899e-04
Validation auc = 0.868182
Epoch 7
Loss = 1.5967e-01, PNorm = 61.8319, GNorm = 0.3373, lr_0 = 6.4495e-04
Loss = 2.3539e-01, PNorm = 61.8886, GNorm = 0.2689, lr_0 = 6.3244e-04
Loss = 1.3055e-01, PNorm = 61.9762, GNorm = 0.4199, lr_0 = 6.2018e-04
Loss = 1.6228e-01, PNorm = 62.0157, GNorm = 0.2749, lr_0 = 6.0815e-04
Validation auc = 0.867532
Epoch 8
Loss = 1.7819e-01, PNorm = 62.0781, GNorm = 0.2480, lr_0 = 5.9520e-04
Loss = 1.5432e-01, PNorm = 62.1333, GNorm = 0.3804, lr_0 = 5.8366e-04
Loss = 2.0994e-01, PNorm = 62.2057, GNorm = 0.1884, lr_0 = 5.7234e-04
Loss = 1.3249e-01, PNorm = 62.2783, GNorm = 0.2916, lr_0 = 5.6124e-04
Validation auc = 0.837662
Epoch 9
Loss = 7.0758e-02, PNorm = 62.3653, GNorm = 0.1928, lr_0 = 5.4928e-04
Loss = 1.8672e-01, PNorm = 62.4360, GNorm = 0.3252, lr_0 = 5.3863e-04
Loss = 1.9508e-01, PNorm = 62.5214, GNorm = 0.1948, lr_0 = 5.2819e-04
Loss = 1.2651e-01, PNorm = 62.6084, GNorm = 0.2609, lr_0 = 5.1795e-04
Loss = 1.7536e-01, PNorm = 62.6591, GNorm = 0.1823, lr_0 = 5.0790e-04
Loss = 4.0710e-02, PNorm = 62.6634, GNorm = 0.9305, lr_0 = 5.0691e-04
Validation auc = 0.851299
Epoch 10
Loss = 1.5258e-01, PNorm = 62.7132, GNorm = 0.4028, lr_0 = 4.9708e-04
Loss = 1.4403e-01, PNorm = 62.7647, GNorm = 0.7431, lr_0 = 4.8744e-04
Loss = 1.2993e-01, PNorm = 62.8114, GNorm = 0.4554, lr_0 = 4.7799e-04
Loss = 1.4268e-01, PNorm = 62.8602, GNorm = 0.2341, lr_0 = 4.6873e-04
Validation auc = 0.842857
Epoch 11
Loss = 1.3580e-01, PNorm = 62.9271, GNorm = 0.2268, lr_0 = 4.5874e-04
Loss = 1.2059e-01, PNorm = 62.9709, GNorm = 0.3008, lr_0 = 4.4984e-04
Loss = 1.5394e-01, PNorm = 63.0239, GNorm = 0.3449, lr_0 = 4.4112e-04
Loss = 1.2495e-01, PNorm = 63.0777, GNorm = 0.4302, lr_0 = 4.3257e-04
Validation auc = 0.866558
Epoch 12
Loss = 1.0772e-01, PNorm = 63.1332, GNorm = 0.2877, lr_0 = 4.2335e-04
Loss = 1.2472e-01, PNorm = 63.1769, GNorm = 0.6280, lr_0 = 4.1514e-04
Loss = 1.5250e-01, PNorm = 63.2113, GNorm = 0.6088, lr_0 = 4.0709e-04
Loss = 1.2691e-01, PNorm = 63.2833, GNorm = 0.2271, lr_0 = 3.9920e-04
Validation auc = 0.856494
Epoch 13
Loss = 1.5774e-01, PNorm = 63.3405, GNorm = 0.2533, lr_0 = 3.9069e-04
Loss = 8.7374e-02, PNorm = 63.3792, GNorm = 0.2619, lr_0 = 3.8312e-04
Loss = 1.3040e-01, PNorm = 63.4245, GNorm = 0.7209, lr_0 = 3.7569e-04
Loss = 1.0512e-01, PNorm = 63.4715, GNorm = 0.3000, lr_0 = 3.6841e-04
Validation auc = 0.843182
Epoch 14
Loss = 7.2677e-02, PNorm = 63.5096, GNorm = 0.8036, lr_0 = 3.6056e-04
Loss = 1.4081e-01, PNorm = 63.5613, GNorm = 0.3785, lr_0 = 3.5357e-04
Loss = 1.0424e-01, PNorm = 63.6052, GNorm = 0.3774, lr_0 = 3.4671e-04
Loss = 1.1561e-01, PNorm = 63.6448, GNorm = 0.2197, lr_0 = 3.3999e-04
Loss = 1.0136e-01, PNorm = 63.6906, GNorm = 0.2573, lr_0 = 3.3340e-04
Loss = 1.8592e-02, PNorm = 63.6966, GNorm = 0.3455, lr_0 = 3.3274e-04
Validation auc = 0.851948
Epoch 15
Loss = 8.2268e-02, PNorm = 63.7359, GNorm = 1.4458, lr_0 = 3.2629e-04
Loss = 1.2978e-01, PNorm = 63.7779, GNorm = 0.4761, lr_0 = 3.1996e-04
Loss = 1.2371e-01, PNorm = 63.8254, GNorm = 0.2825, lr_0 = 3.1376e-04
Loss = 8.8614e-02, PNorm = 63.8731, GNorm = 0.2613, lr_0 = 3.0768e-04
Validation auc = 0.827597
Epoch 16
Loss = 1.5200e-01, PNorm = 63.9056, GNorm = 0.4955, lr_0 = 3.0112e-04
Loss = 1.0541e-01, PNorm = 63.9596, GNorm = 1.0844, lr_0 = 2.9528e-04
Loss = 1.0528e-01, PNorm = 63.9790, GNorm = 0.3578, lr_0 = 2.8956e-04
Loss = 9.4330e-02, PNorm = 64.0188, GNorm = 0.2156, lr_0 = 2.8394e-04
Validation auc = 0.858442
Epoch 17
Loss = 9.1955e-02, PNorm = 64.0617, GNorm = 0.5335, lr_0 = 2.7789e-04
Loss = 9.0292e-02, PNorm = 64.0898, GNorm = 0.6253, lr_0 = 2.7250e-04
Loss = 1.1224e-01, PNorm = 64.1187, GNorm = 0.3793, lr_0 = 2.6722e-04
Loss = 8.4637e-02, PNorm = 64.1562, GNorm = 0.4163, lr_0 = 2.6204e-04
Validation auc = 0.853896
Epoch 18
Loss = 5.4920e-02, PNorm = 64.1866, GNorm = 0.2657, lr_0 = 2.5646e-04
Loss = 6.7761e-02, PNorm = 64.2129, GNorm = 0.2797, lr_0 = 2.5148e-04
Loss = 8.6454e-02, PNorm = 64.2395, GNorm = 0.7558, lr_0 = 2.4661e-04
Loss = 1.0116e-01, PNorm = 64.2701, GNorm = 0.6386, lr_0 = 2.4183e-04
Validation auc = 0.842532
Epoch 19
Loss = 6.8695e-02, PNorm = 64.3021, GNorm = 0.3494, lr_0 = 2.3667e-04
Loss = 7.6860e-02, PNorm = 64.3331, GNorm = 0.4768, lr_0 = 2.3208e-04
Loss = 1.1320e-01, PNorm = 64.3658, GNorm = 0.8383, lr_0 = 2.2758e-04
Loss = 7.2647e-02, PNorm = 64.3973, GNorm = 0.3380, lr_0 = 2.2317e-04
Loss = 7.5990e-02, PNorm = 64.4264, GNorm = 0.4841, lr_0 = 2.1884e-04
Loss = 6.9499e-04, PNorm = 64.4295, GNorm = 0.0193, lr_0 = 2.1842e-04
Validation auc = 0.854870
Epoch 20
Loss = 7.0623e-02, PNorm = 64.4564, GNorm = 1.2164, lr_0 = 2.1418e-04
Loss = 3.1042e-02, PNorm = 64.4869, GNorm = 0.2125, lr_0 = 2.1003e-04
Loss = 1.2007e-01, PNorm = 64.5020, GNorm = 0.6078, lr_0 = 2.0596e-04
Loss = 9.6536e-02, PNorm = 64.5320, GNorm = 0.9512, lr_0 = 2.0196e-04
Validation auc = 0.839286
Epoch 21
Loss = 8.5387e-02, PNorm = 64.5704, GNorm = 0.7675, lr_0 = 1.9766e-04
Loss = 8.0686e-02, PNorm = 64.5932, GNorm = 0.7111, lr_0 = 1.9383e-04
Loss = 6.1297e-02, PNorm = 64.6231, GNorm = 0.7750, lr_0 = 1.9007e-04
Loss = 7.5844e-02, PNorm = 64.6344, GNorm = 0.6273, lr_0 = 1.8638e-04
Validation auc = 0.844156
Epoch 22
Loss = 4.0626e-02, PNorm = 64.6646, GNorm = 0.5758, lr_0 = 1.8241e-04
Loss = 4.7465e-02, PNorm = 64.6847, GNorm = 0.2883, lr_0 = 1.7888e-04
Loss = 8.3307e-02, PNorm = 64.7067, GNorm = 0.6203, lr_0 = 1.7541e-04
Loss = 6.4872e-02, PNorm = 64.7275, GNorm = 0.2734, lr_0 = 1.7201e-04
Validation auc = 0.849675
Epoch 23
Loss = 6.6698e-02, PNorm = 64.7475, GNorm = 0.5730, lr_0 = 1.6834e-04
Loss = 6.5068e-02, PNorm = 64.7724, GNorm = 0.7156, lr_0 = 1.6508e-04
Loss = 5.3537e-02, PNorm = 64.7871, GNorm = 0.9271, lr_0 = 1.6188e-04
Loss = 7.9373e-02, PNorm = 64.8103, GNorm = 0.6170, lr_0 = 1.5874e-04
Validation auc = 0.847078
Epoch 24
Loss = 5.8406e-02, PNorm = 64.8301, GNorm = 0.3147, lr_0 = 1.5536e-04
Loss = 5.1668e-02, PNorm = 64.8477, GNorm = 0.2937, lr_0 = 1.5234e-04
Loss = 6.8222e-02, PNorm = 64.8636, GNorm = 0.7753, lr_0 = 1.4939e-04
Loss = 6.5423e-02, PNorm = 64.8786, GNorm = 0.5477, lr_0 = 1.4649e-04
Loss = 6.1969e-02, PNorm = 64.8948, GNorm = 0.4088, lr_0 = 1.4365e-04
Loss = 2.8868e-04, PNorm = 64.8969, GNorm = 0.0109, lr_0 = 1.4337e-04
Validation auc = 0.846753
Epoch 25
Loss = 6.9937e-02, PNorm = 64.9106, GNorm = 0.3604, lr_0 = 1.4059e-04
Loss = 5.7650e-02, PNorm = 64.9234, GNorm = 0.1684, lr_0 = 1.3787e-04
Loss = 5.3595e-02, PNorm = 64.9397, GNorm = 0.8348, lr_0 = 1.3519e-04
Loss = 4.9303e-02, PNorm = 64.9568, GNorm = 0.4743, lr_0 = 1.3257e-04
Validation auc = 0.846429
Epoch 26
Loss = 4.6086e-02, PNorm = 64.9719, GNorm = 0.7814, lr_0 = 1.2975e-04
Loss = 6.8907e-02, PNorm = 64.9841, GNorm = 0.7693, lr_0 = 1.2723e-04
Loss = 5.9808e-02, PNorm = 65.0022, GNorm = 1.3432, lr_0 = 1.2476e-04
Loss = 5.3314e-02, PNorm = 65.0134, GNorm = 0.6568, lr_0 = 1.2234e-04
Validation auc = 0.845779
Epoch 27
Loss = 4.1431e-02, PNorm = 65.0272, GNorm = 0.6506, lr_0 = 1.1974e-04
Loss = 4.9640e-02, PNorm = 65.0366, GNorm = 1.6097, lr_0 = 1.1742e-04
Loss = 5.9872e-02, PNorm = 65.0462, GNorm = 1.0205, lr_0 = 1.1514e-04
Loss = 5.8938e-02, PNorm = 65.0620, GNorm = 0.5484, lr_0 = 1.1291e-04
Validation auc = 0.842208
Epoch 28
Loss = 5.1213e-02, PNorm = 65.0776, GNorm = 0.6833, lr_0 = 1.1050e-04
Loss = 3.2986e-02, PNorm = 65.0888, GNorm = 0.6644, lr_0 = 1.0836e-04
Loss = 4.5721e-02, PNorm = 65.0987, GNorm = 0.4263, lr_0 = 1.0626e-04
Loss = 5.8115e-02, PNorm = 65.1048, GNorm = 0.5912, lr_0 = 1.0420e-04
Validation auc = 0.849351
Epoch 29
Loss = 2.8905e-02, PNorm = 65.1192, GNorm = 0.6436, lr_0 = 1.0198e-04
Loss = 4.4247e-02, PNorm = 65.1279, GNorm = 0.9588, lr_0 = 1.0000e-04
Loss = 5.3295e-02, PNorm = 65.1416, GNorm = 0.6420, lr_0 = 1.0000e-04
Loss = 5.0478e-02, PNorm = 65.1505, GNorm = 0.4509, lr_0 = 1.0000e-04
Loss = 3.8416e-02, PNorm = 65.1599, GNorm = 0.9768, lr_0 = 1.0000e-04
Loss = 1.1802e-05, PNorm = 65.1607, GNorm = 0.0007, lr_0 = 1.0000e-04
Validation auc = 0.852273
Model 0 best validation auc = 0.912662 on epoch 1
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 provided with no test set, no metric evaluation will be performed.
Ensemble test auc = nan
1-fold cross validation
	Seed 0 ==> test auc = nan
Overall test auc = nan +/- nan
Elapsed time = 0:10:35
Command line
python antibiotic.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/shxie/aiddsummary/antibio_reproduction/configew.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'antibiotic_reproduction.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.35,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/shxie/aiddsummary/antibio_reproduction/antibiotic/model_11',
 'save_preds': False,
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Activity'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
Activity 0: 94.86%, 1: 5.14%
Total size = 2,335 | train size = 2,101 | val size = 234 | test size = 0
The test data split is empty. This may be either because splitting with no test set was selected,             such as with `cv-no-test`, or because test data provided with `--separate_test_path` was empty or contained only invalid molecules.             Performance on the test set will not be evaluated and metric scores will return `nan` for each task.
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1600, out_features=1, bias=True)
  )
)
Number of parameters = 5,572,801
Epoch 0
Loss = 2.7557e-01, PNorm = 59.4787, GNorm = 0.5901, lr_0 = 2.1786e-04
Loss = 2.3560e-01, PNorm = 59.5048, GNorm = 0.2575, lr_0 = 3.2500e-04
Loss = 2.4763e-01, PNorm = 59.5346, GNorm = 0.4798, lr_0 = 4.3214e-04
Loss = 1.7670e-01, PNorm = 59.5709, GNorm = 0.2500, lr_0 = 5.3929e-04
Validation auc = 0.849675
Epoch 1
Loss = 2.3511e-01, PNorm = 59.6067, GNorm = 0.3356, lr_0 = 6.5714e-04
Loss = 1.7050e-01, PNorm = 59.6451, GNorm = 0.3613, lr_0 = 7.6429e-04
Loss = 2.4141e-01, PNorm = 59.7015, GNorm = 0.1858, lr_0 = 8.7143e-04
Loss = 1.5083e-01, PNorm = 59.7723, GNorm = 0.3606, lr_0 = 9.7857e-04
Validation auc = 0.909091
Epoch 2
Loss = 2.3122e-01, PNorm = 59.8353, GNorm = 0.2909, lr_0 = 9.8253e-04
Loss = 1.5912e-01, PNorm = 59.8976, GNorm = 0.2108, lr_0 = 9.6348e-04
Loss = 1.9472e-01, PNorm = 59.9518, GNorm = 0.8479, lr_0 = 9.4480e-04
Loss = 2.1100e-01, PNorm = 60.0204, GNorm = 0.1734, lr_0 = 9.2648e-04
Validation auc = 0.898701
Epoch 3
Loss = 2.1381e-01, PNorm = 60.1025, GNorm = 0.3993, lr_0 = 9.0674e-04
Loss = 1.8026e-01, PNorm = 60.1629, GNorm = 0.2950, lr_0 = 8.8916e-04
Loss = 1.9685e-01, PNorm = 60.2235, GNorm = 0.7430, lr_0 = 8.7192e-04
Loss = 2.0737e-01, PNorm = 60.3115, GNorm = 0.2748, lr_0 = 8.5501e-04
Validation auc = 0.877922
Epoch 4
Loss = 1.5887e-01, PNorm = 60.3974, GNorm = 0.1513, lr_0 = 8.3679e-04
Loss = 2.0867e-01, PNorm = 60.4677, GNorm = 0.1740, lr_0 = 8.2057e-04
Loss = 1.7334e-01, PNorm = 60.5473, GNorm = 0.1627, lr_0 = 8.0466e-04
Loss = 1.8090e-01, PNorm = 60.6270, GNorm = 0.3560, lr_0 = 7.8906e-04
Loss = 1.6411e-01, PNorm = 60.7118, GNorm = 0.2453, lr_0 = 7.7376e-04
Loss = 1.6345e-02, PNorm = 60.7202, GNorm = 0.2216, lr_0 = 7.7224e-04
Validation auc = 0.912662
Epoch 5
Loss = 1.4556e-01, PNorm = 60.7913, GNorm = 0.2167, lr_0 = 7.5727e-04
Loss = 1.7395e-01, PNorm = 60.8707, GNorm = 0.3054, lr_0 = 7.4259e-04
Loss = 1.7677e-01, PNorm = 60.9688, GNorm = 0.4974, lr_0 = 7.2819e-04
Loss = 1.7471e-01, PNorm = 61.0453, GNorm = 0.3022, lr_0 = 7.1407e-04
Validation auc = 0.852273
Epoch 6
Loss = 2.5469e-01, PNorm = 61.2616, GNorm = 0.3039, lr_0 = 6.9886e-04
Loss = 1.8742e-01, PNorm = 61.4775, GNorm = 0.3634, lr_0 = 6.8531e-04
Loss = 1.9961e-01, PNorm = 61.6124, GNorm = 0.3000, lr_0 = 6.7202e-04
Loss = 2.0992e-01, PNorm = 61.6859, GNorm = 0.2756, lr_0 = 6.5899e-04
Validation auc = 0.855844
Epoch 7
Loss = 1.6505e-01, PNorm = 61.7732, GNorm = 0.4273, lr_0 = 6.4495e-04
Loss = 2.3891e-01, PNorm = 61.8340, GNorm = 0.2638, lr_0 = 6.3244e-04
Loss = 1.2962e-01, PNorm = 61.9202, GNorm = 0.4973, lr_0 = 6.2018e-04
Loss = 1.6075e-01, PNorm = 61.9636, GNorm = 0.2389, lr_0 = 6.0815e-04
Validation auc = 0.837987
Epoch 8
Loss = 1.7724e-01, PNorm = 62.0340, GNorm = 0.2211, lr_0 = 5.9520e-04
Loss = 1.5477e-01, PNorm = 62.1161, GNorm = 0.3622, lr_0 = 5.8366e-04
Loss = 2.1446e-01, PNorm = 62.2075, GNorm = 0.2069, lr_0 = 5.7234e-04
Loss = 1.4139e-01, PNorm = 62.2883, GNorm = 0.1876, lr_0 = 5.6124e-04
Validation auc = 0.803571
Epoch 9
Loss = 7.3745e-02, PNorm = 62.3849, GNorm = 0.1661, lr_0 = 5.4928e-04
Loss = 1.9276e-01, PNorm = 62.4527, GNorm = 0.3329, lr_0 = 5.3863e-04
Loss = 2.0120e-01, PNorm = 62.5366, GNorm = 0.1928, lr_0 = 5.2819e-04
Loss = 1.2947e-01, PNorm = 62.6169, GNorm = 0.2142, lr_0 = 5.1795e-04
Loss = 1.7367e-01, PNorm = 62.6723, GNorm = 0.1699, lr_0 = 5.0790e-04
Loss = 2.1847e-02, PNorm = 62.6770, GNorm = 0.3021, lr_0 = 5.0691e-04
Validation auc = 0.866558
Epoch 10
Loss = 1.5187e-01, PNorm = 62.7363, GNorm = 0.3513, lr_0 = 4.9708e-04
Loss = 1.4111e-01, PNorm = 62.7941, GNorm = 0.3001, lr_0 = 4.8744e-04
Loss = 1.2856e-01, PNorm = 62.8449, GNorm = 0.5078, lr_0 = 4.7799e-04
Loss = 1.3590e-01, PNorm = 62.8873, GNorm = 0.2344, lr_0 = 4.6873e-04
Validation auc = 0.847403
Epoch 11
Loss = 1.3572e-01, PNorm = 62.9473, GNorm = 0.2217, lr_0 = 4.5874e-04
Loss = 1.1647e-01, PNorm = 62.9934, GNorm = 0.1721, lr_0 = 4.4984e-04
Loss = 1.5756e-01, PNorm = 63.0365, GNorm = 0.5066, lr_0 = 4.4112e-04
Loss = 1.3261e-01, PNorm = 63.0902, GNorm = 0.3521, lr_0 = 4.3257e-04
Validation auc = 0.876299
Epoch 12
Loss = 1.2000e-01, PNorm = 63.1447, GNorm = 0.3389, lr_0 = 4.2335e-04
Loss = 1.2503e-01, PNorm = 63.1925, GNorm = 0.4357, lr_0 = 4.1514e-04
Loss = 1.3090e-01, PNorm = 63.2267, GNorm = 0.4693, lr_0 = 4.0709e-04
Loss = 1.1757e-01, PNorm = 63.2884, GNorm = 0.2056, lr_0 = 3.9920e-04
Validation auc = 0.844805
Epoch 13
Loss = 1.5429e-01, PNorm = 63.3347, GNorm = 0.3576, lr_0 = 3.9069e-04
Loss = 8.6563e-02, PNorm = 63.3766, GNorm = 0.1694, lr_0 = 3.8312e-04
Loss = 1.2662e-01, PNorm = 63.4192, GNorm = 0.4228, lr_0 = 3.7569e-04
Loss = 1.0276e-01, PNorm = 63.4704, GNorm = 0.2710, lr_0 = 3.6841e-04
Validation auc = 0.850000
Epoch 14
Loss = 7.0577e-02, PNorm = 63.5139, GNorm = 0.5675, lr_0 = 3.6056e-04
Loss = 1.4014e-01, PNorm = 63.5641, GNorm = 0.3501, lr_0 = 3.5357e-04
Loss = 1.0131e-01, PNorm = 63.6070, GNorm = 0.4505, lr_0 = 3.4671e-04
Loss = 1.1809e-01, PNorm = 63.6506, GNorm = 0.1713, lr_0 = 3.3999e-04
Loss = 1.0710e-01, PNorm = 63.6946, GNorm = 0.2447, lr_0 = 3.3340e-04
Loss = 3.3270e-02, PNorm = 63.7003, GNorm = 0.4662, lr_0 = 3.3274e-04
Validation auc = 0.851948
Epoch 15
Loss = 7.9904e-02, PNorm = 63.7404, GNorm = 0.9743, lr_0 = 3.2629e-04
Loss = 1.2333e-01, PNorm = 63.7787, GNorm = 0.4423, lr_0 = 3.1996e-04
Loss = 1.2524e-01, PNorm = 63.8207, GNorm = 0.4734, lr_0 = 3.1376e-04
Loss = 8.5593e-02, PNorm = 63.8713, GNorm = 0.2459, lr_0 = 3.0768e-04
Validation auc = 0.818831
Epoch 16
Loss = 1.5299e-01, PNorm = 63.9059, GNorm = 0.4599, lr_0 = 3.0112e-04
Loss = 1.0800e-01, PNorm = 63.9635, GNorm = 0.9132, lr_0 = 2.9528e-04
Loss = 1.0618e-01, PNorm = 63.9888, GNorm = 0.2675, lr_0 = 2.8956e-04
Loss = 9.2969e-02, PNorm = 64.0232, GNorm = 0.2291, lr_0 = 2.8394e-04
Validation auc = 0.856169
Epoch 17
Loss = 9.2600e-02, PNorm = 64.0670, GNorm = 0.6033, lr_0 = 2.7789e-04
Loss = 8.6771e-02, PNorm = 64.0924, GNorm = 0.5238, lr_0 = 2.7250e-04
Loss = 1.1757e-01, PNorm = 64.1280, GNorm = 0.4637, lr_0 = 2.6722e-04
Loss = 8.5815e-02, PNorm = 64.1627, GNorm = 0.3950, lr_0 = 2.6204e-04
Validation auc = 0.834416
Epoch 18
Loss = 6.7193e-02, PNorm = 64.1914, GNorm = 0.3464, lr_0 = 2.5646e-04
Loss = 6.7234e-02, PNorm = 64.2162, GNorm = 0.3403, lr_0 = 2.5148e-04
Loss = 9.7183e-02, PNorm = 64.2381, GNorm = 0.8424, lr_0 = 2.4661e-04
Loss = 1.0680e-01, PNorm = 64.2643, GNorm = 0.5392, lr_0 = 2.4183e-04
Validation auc = 0.837338
Epoch 19
Loss = 7.1108e-02, PNorm = 64.2943, GNorm = 0.2792, lr_0 = 2.3667e-04
Loss = 7.8966e-02, PNorm = 64.3247, GNorm = 0.3763, lr_0 = 2.3208e-04
Loss = 1.0887e-01, PNorm = 64.3524, GNorm = 0.3479, lr_0 = 2.2758e-04
Loss = 6.5981e-02, PNorm = 64.3830, GNorm = 0.4148, lr_0 = 2.2317e-04
Loss = 8.0231e-02, PNorm = 64.4163, GNorm = 0.6526, lr_0 = 2.1884e-04
Loss = 4.5492e-04, PNorm = 64.4207, GNorm = 0.0133, lr_0 = 2.1842e-04
Validation auc = 0.850325
Epoch 20
Loss = 7.0388e-02, PNorm = 64.4505, GNorm = 0.4687, lr_0 = 2.1418e-04
Loss = 3.1743e-02, PNorm = 64.4833, GNorm = 0.2715, lr_0 = 2.1003e-04
Loss = 1.1386e-01, PNorm = 64.4993, GNorm = 0.5483, lr_0 = 2.0596e-04
Loss = 9.5322e-02, PNorm = 64.5239, GNorm = 0.7633, lr_0 = 2.0196e-04
Validation auc = 0.829545
Epoch 21
Loss = 7.9665e-02, PNorm = 64.5552, GNorm = 0.6835, lr_0 = 1.9766e-04
Loss = 8.0130e-02, PNorm = 64.5778, GNorm = 0.7139, lr_0 = 1.9383e-04
Loss = 6.1823e-02, PNorm = 64.6051, GNorm = 0.6915, lr_0 = 1.9007e-04
Loss = 7.1333e-02, PNorm = 64.6205, GNorm = 0.6748, lr_0 = 1.8638e-04
Validation auc = 0.835714
Epoch 22
Loss = 3.7521e-02, PNorm = 64.6485, GNorm = 0.4364, lr_0 = 1.8241e-04
Loss = 4.2214e-02, PNorm = 64.6679, GNorm = 0.2257, lr_0 = 1.7888e-04
Loss = 8.6061e-02, PNorm = 64.6851, GNorm = 0.8503, lr_0 = 1.7541e-04
Loss = 6.1795e-02, PNorm = 64.7089, GNorm = 0.2498, lr_0 = 1.7201e-04
Validation auc = 0.842857
Epoch 23
Loss = 8.0078e-02, PNorm = 64.7321, GNorm = 0.4456, lr_0 = 1.6834e-04
Loss = 7.7725e-02, PNorm = 64.7631, GNorm = 0.8203, lr_0 = 1.6508e-04
Loss = 5.4602e-02, PNorm = 64.7775, GNorm = 0.5588, lr_0 = 1.6188e-04
Loss = 8.5330e-02, PNorm = 64.8043, GNorm = 0.7253, lr_0 = 1.5874e-04
Validation auc = 0.838312
Epoch 24
Loss = 6.9480e-02, PNorm = 64.8289, GNorm = 0.2668, lr_0 = 1.5536e-04
Loss = 4.6907e-02, PNorm = 64.8446, GNorm = 0.3229, lr_0 = 1.5234e-04
Loss = 7.3339e-02, PNorm = 64.8606, GNorm = 0.7722, lr_0 = 1.4939e-04
Loss = 6.3073e-02, PNorm = 64.8735, GNorm = 0.5265, lr_0 = 1.4649e-04
Loss = 6.5985e-02, PNorm = 64.8944, GNorm = 0.4877, lr_0 = 1.4365e-04
Loss = 1.2171e-04, PNorm = 64.8971, GNorm = 0.0048, lr_0 = 1.4337e-04
Validation auc = 0.839286
Epoch 25
Loss = 7.0313e-02, PNorm = 64.9099, GNorm = 0.5247, lr_0 = 1.4059e-04
Loss = 5.6407e-02, PNorm = 64.9261, GNorm = 0.1426, lr_0 = 1.3787e-04
Loss = 6.0814e-02, PNorm = 64.9429, GNorm = 0.6286, lr_0 = 1.3519e-04
Loss = 5.2568e-02, PNorm = 64.9617, GNorm = 0.5470, lr_0 = 1.3257e-04
Validation auc = 0.832468
Epoch 26
Loss = 3.8913e-02, PNorm = 64.9774, GNorm = 0.7962, lr_0 = 1.2975e-04
Loss = 7.2160e-02, PNorm = 64.9886, GNorm = 0.6976, lr_0 = 1.2723e-04
Loss = 7.0681e-02, PNorm = 65.0058, GNorm = 1.0554, lr_0 = 1.2476e-04
Loss = 5.0453e-02, PNorm = 65.0197, GNorm = 0.6895, lr_0 = 1.2234e-04
Validation auc = 0.833766
Epoch 27
Loss = 4.0534e-02, PNorm = 65.0340, GNorm = 0.5746, lr_0 = 1.1974e-04
Loss = 5.4373e-02, PNorm = 65.0455, GNorm = 1.3544, lr_0 = 1.1742e-04
Loss = 6.0107e-02, PNorm = 65.0554, GNorm = 1.0375, lr_0 = 1.1514e-04
Loss = 5.2232e-02, PNorm = 65.0720, GNorm = 0.6041, lr_0 = 1.1291e-04
Validation auc = 0.825325
Epoch 28
Loss = 4.4822e-02, PNorm = 65.0870, GNorm = 0.7418, lr_0 = 1.1050e-04
Loss = 3.4147e-02, PNorm = 65.0996, GNorm = 0.4891, lr_0 = 1.0836e-04
Loss = 3.8218e-02, PNorm = 65.1107, GNorm = 0.3909, lr_0 = 1.0626e-04
Loss = 6.3077e-02, PNorm = 65.1192, GNorm = 0.4261, lr_0 = 1.0420e-04
Validation auc = 0.832143
Epoch 29
Loss = 2.1558e-02, PNorm = 65.1326, GNorm = 0.3176, lr_0 = 1.0198e-04
Loss = 3.9102e-02, PNorm = 65.1437, GNorm = 0.7131, lr_0 = 1.0000e-04
Loss = 4.5712e-02, PNorm = 65.1557, GNorm = 0.5331, lr_0 = 1.0000e-04
Loss = 5.4644e-02, PNorm = 65.1647, GNorm = 0.6745, lr_0 = 1.0000e-04
Loss = 4.1198e-02, PNorm = 65.1775, GNorm = 1.0588, lr_0 = 1.0000e-04
Loss = 2.0623e-05, PNorm = 65.1786, GNorm = 0.0012, lr_0 = 1.0000e-04
Validation auc = 0.833766
Model 0 best validation auc = 0.912662 on epoch 4
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 provided with no test set, no metric evaluation will be performed.
Ensemble test auc = nan
1-fold cross validation
	Seed 0 ==> test auc = nan
Overall test auc = nan +/- nan
Elapsed time = 0:10:37
Command line
python antibiotic.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/shxie/aiddsummary/antibio_reproduction/configew.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'antibiotic_reproduction.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.35,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/shxie/aiddsummary/antibio_reproduction/antibiotic/model_12',
 'save_preds': False,
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Activity'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
Activity 0: 94.86%, 1: 5.14%
Total size = 2,335 | train size = 2,101 | val size = 234 | test size = 0
The test data split is empty. This may be either because splitting with no test set was selected,             such as with `cv-no-test`, or because test data provided with `--separate_test_path` was empty or contained only invalid molecules.             Performance on the test set will not be evaluated and metric scores will return `nan` for each task.
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1600, out_features=1, bias=True)
  )
)
Number of parameters = 5,572,801
Epoch 0
Loss = 2.7557e-01, PNorm = 59.4787, GNorm = 0.5901, lr_0 = 2.1786e-04
Loss = 2.3560e-01, PNorm = 59.5048, GNorm = 0.2575, lr_0 = 3.2500e-04
Loss = 2.4763e-01, PNorm = 59.5346, GNorm = 0.4798, lr_0 = 4.3214e-04
Loss = 1.7671e-01, PNorm = 59.5709, GNorm = 0.2502, lr_0 = 5.3929e-04
Validation auc = 0.850000
Epoch 1
Loss = 2.3511e-01, PNorm = 59.6067, GNorm = 0.3356, lr_0 = 6.5714e-04
Loss = 1.7039e-01, PNorm = 59.6452, GNorm = 0.3606, lr_0 = 7.6429e-04
Loss = 2.4154e-01, PNorm = 59.7020, GNorm = 0.1843, lr_0 = 8.7143e-04
Loss = 1.5121e-01, PNorm = 59.7728, GNorm = 0.3686, lr_0 = 9.7857e-04
Validation auc = 0.912338
Epoch 2
Loss = 2.3137e-01, PNorm = 59.8356, GNorm = 0.2860, lr_0 = 9.8253e-04
Loss = 1.5903e-01, PNorm = 59.9000, GNorm = 0.2092, lr_0 = 9.6348e-04
Loss = 1.9340e-01, PNorm = 59.9565, GNorm = 0.9728, lr_0 = 9.4480e-04
Loss = 2.0776e-01, PNorm = 60.0267, GNorm = 0.1621, lr_0 = 9.2648e-04
Validation auc = 0.896429
Epoch 3
Loss = 2.1430e-01, PNorm = 60.1131, GNorm = 0.4255, lr_0 = 9.0674e-04
Loss = 1.7978e-01, PNorm = 60.1774, GNorm = 0.2845, lr_0 = 8.8916e-04
Loss = 1.9753e-01, PNorm = 60.2414, GNorm = 0.8006, lr_0 = 8.7192e-04
Loss = 2.0745e-01, PNorm = 60.3328, GNorm = 0.2604, lr_0 = 8.5501e-04
Validation auc = 0.875974
Epoch 4
Loss = 1.5775e-01, PNorm = 60.4207, GNorm = 0.1590, lr_0 = 8.3679e-04
Loss = 2.0312e-01, PNorm = 60.4945, GNorm = 0.1840, lr_0 = 8.2057e-04
Loss = 1.7251e-01, PNorm = 60.5744, GNorm = 0.1936, lr_0 = 8.0466e-04
Loss = 1.8216e-01, PNorm = 60.6553, GNorm = 0.3778, lr_0 = 7.8906e-04
Loss = 1.6465e-01, PNorm = 60.7344, GNorm = 0.2068, lr_0 = 7.7376e-04
Loss = 1.8225e-02, PNorm = 60.7429, GNorm = 0.2326, lr_0 = 7.7224e-04
Validation auc = 0.913636
Epoch 5
Loss = 1.4824e-01, PNorm = 60.8005, GNorm = 0.2106, lr_0 = 7.5727e-04
Loss = 1.7498e-01, PNorm = 60.8688, GNorm = 0.3039, lr_0 = 7.4259e-04
Loss = 1.7871e-01, PNorm = 60.9563, GNorm = 0.3411, lr_0 = 7.2819e-04
Loss = 1.7262e-01, PNorm = 61.0291, GNorm = 0.4127, lr_0 = 7.1407e-04
Validation auc = 0.852922
Epoch 6
Loss = 2.3824e-01, PNorm = 61.2338, GNorm = 0.3459, lr_0 = 6.9886e-04
Loss = 1.8775e-01, PNorm = 61.4442, GNorm = 0.4069, lr_0 = 6.8531e-04
Loss = 2.0140e-01, PNorm = 61.5791, GNorm = 0.2714, lr_0 = 6.7202e-04
Loss = 2.1041e-01, PNorm = 61.6561, GNorm = 0.2880, lr_0 = 6.5899e-04
Validation auc = 0.892857
Epoch 7
Loss = 1.6635e-01, PNorm = 61.7390, GNorm = 0.3741, lr_0 = 6.4495e-04
Loss = 2.3756e-01, PNorm = 61.7954, GNorm = 0.2468, lr_0 = 6.3244e-04
Loss = 1.3040e-01, PNorm = 61.8696, GNorm = 0.5482, lr_0 = 6.2018e-04
Loss = 1.6177e-01, PNorm = 61.9086, GNorm = 0.2401, lr_0 = 6.0815e-04
Validation auc = 0.853571
Epoch 8
Loss = 1.8165e-01, PNorm = 61.9666, GNorm = 0.2140, lr_0 = 5.9520e-04
Loss = 1.5227e-01, PNorm = 62.0317, GNorm = 0.3008, lr_0 = 5.8366e-04
Loss = 2.1143e-01, PNorm = 62.1164, GNorm = 0.2181, lr_0 = 5.7234e-04
Loss = 1.4372e-01, PNorm = 62.1918, GNorm = 0.2276, lr_0 = 5.6124e-04
Validation auc = 0.857468
Epoch 9
Loss = 6.0296e-02, PNorm = 62.2819, GNorm = 0.2270, lr_0 = 5.4928e-04
Loss = 1.8308e-01, PNorm = 62.3478, GNorm = 0.2680, lr_0 = 5.3863e-04
Loss = 1.9879e-01, PNorm = 62.4232, GNorm = 0.2219, lr_0 = 5.2819e-04
Loss = 1.2841e-01, PNorm = 62.5116, GNorm = 0.2796, lr_0 = 5.1795e-04
Loss = 1.7332e-01, PNorm = 62.5707, GNorm = 0.1995, lr_0 = 5.0790e-04
Loss = 2.5269e-02, PNorm = 62.5755, GNorm = 0.3594, lr_0 = 5.0691e-04
Validation auc = 0.879221
Epoch 10
Loss = 1.4883e-01, PNorm = 62.6295, GNorm = 0.5228, lr_0 = 4.9708e-04
Loss = 1.4460e-01, PNorm = 62.6805, GNorm = 0.4430, lr_0 = 4.8744e-04
Loss = 1.3059e-01, PNorm = 62.7323, GNorm = 0.3808, lr_0 = 4.7799e-04
Loss = 1.3882e-01, PNorm = 62.7811, GNorm = 0.2668, lr_0 = 4.6873e-04
Validation auc = 0.854545
Epoch 11
Loss = 1.3291e-01, PNorm = 62.8499, GNorm = 0.1874, lr_0 = 4.5874e-04
Loss = 1.2573e-01, PNorm = 62.8950, GNorm = 0.1708, lr_0 = 4.4984e-04
Loss = 1.6034e-01, PNorm = 62.9412, GNorm = 0.6051, lr_0 = 4.4112e-04
Loss = 1.2809e-01, PNorm = 63.0044, GNorm = 0.4025, lr_0 = 4.3257e-04
Validation auc = 0.878247
Epoch 12
Loss = 1.1924e-01, PNorm = 63.0663, GNorm = 0.5286, lr_0 = 4.2335e-04
Loss = 1.2861e-01, PNorm = 63.1125, GNorm = 0.3814, lr_0 = 4.1514e-04
Loss = 1.3600e-01, PNorm = 63.1540, GNorm = 0.5444, lr_0 = 4.0709e-04
Loss = 1.1521e-01, PNorm = 63.2319, GNorm = 0.2759, lr_0 = 3.9920e-04
Validation auc = 0.845779
Epoch 13
Loss = 1.5738e-01, PNorm = 63.2836, GNorm = 0.4010, lr_0 = 3.9069e-04
Loss = 8.5473e-02, PNorm = 63.3235, GNorm = 0.1953, lr_0 = 3.8312e-04
Loss = 1.2868e-01, PNorm = 63.3698, GNorm = 0.5759, lr_0 = 3.7569e-04
Loss = 1.0619e-01, PNorm = 63.4235, GNorm = 0.4313, lr_0 = 3.6841e-04
Validation auc = 0.844481
Epoch 14
Loss = 6.7777e-02, PNorm = 63.4650, GNorm = 0.5182, lr_0 = 3.6056e-04
Loss = 1.3746e-01, PNorm = 63.5171, GNorm = 0.3035, lr_0 = 3.5357e-04
Loss = 1.0087e-01, PNorm = 63.5626, GNorm = 0.4434, lr_0 = 3.4671e-04
Loss = 1.1245e-01, PNorm = 63.6066, GNorm = 0.1883, lr_0 = 3.3999e-04
Loss = 1.0400e-01, PNorm = 63.6484, GNorm = 0.2996, lr_0 = 3.3340e-04
Loss = 2.2651e-02, PNorm = 63.6539, GNorm = 0.3497, lr_0 = 3.3274e-04
Validation auc = 0.851299
Epoch 15
Loss = 7.4222e-02, PNorm = 63.6913, GNorm = 1.0413, lr_0 = 3.2629e-04
Loss = 1.2668e-01, PNorm = 63.7341, GNorm = 0.5609, lr_0 = 3.1996e-04
Loss = 1.2125e-01, PNorm = 63.7769, GNorm = 0.3581, lr_0 = 3.1376e-04
Loss = 8.4767e-02, PNorm = 63.8296, GNorm = 0.2337, lr_0 = 3.0768e-04
Validation auc = 0.804545
Epoch 16
Loss = 1.4519e-01, PNorm = 63.8672, GNorm = 0.5098, lr_0 = 3.0112e-04
Loss = 1.1094e-01, PNorm = 63.9257, GNorm = 1.1193, lr_0 = 2.9528e-04
Loss = 1.0518e-01, PNorm = 63.9471, GNorm = 0.4553, lr_0 = 2.8956e-04
Loss = 9.5134e-02, PNorm = 63.9874, GNorm = 0.2288, lr_0 = 2.8394e-04
Validation auc = 0.847727
Epoch 17
Loss = 8.5806e-02, PNorm = 64.0304, GNorm = 0.4545, lr_0 = 2.7789e-04
Loss = 8.8029e-02, PNorm = 64.0567, GNorm = 0.5707, lr_0 = 2.7250e-04
Loss = 1.0974e-01, PNorm = 64.0918, GNorm = 0.4554, lr_0 = 2.6722e-04
Loss = 8.4582e-02, PNorm = 64.1277, GNorm = 0.3421, lr_0 = 2.6204e-04
Validation auc = 0.841234
Epoch 18
Loss = 5.3633e-02, PNorm = 64.1589, GNorm = 0.2421, lr_0 = 2.5646e-04
Loss = 7.2622e-02, PNorm = 64.1829, GNorm = 0.3753, lr_0 = 2.5148e-04
Loss = 9.1412e-02, PNorm = 64.2093, GNorm = 0.7307, lr_0 = 2.4661e-04
Loss = 1.0722e-01, PNorm = 64.2396, GNorm = 0.6534, lr_0 = 2.4183e-04
Validation auc = 0.832143
Epoch 19
Loss = 7.2974e-02, PNorm = 64.2756, GNorm = 0.3390, lr_0 = 2.3667e-04
Loss = 7.7077e-02, PNorm = 64.3063, GNorm = 0.3939, lr_0 = 2.3208e-04
Loss = 1.0697e-01, PNorm = 64.3362, GNorm = 0.3568, lr_0 = 2.2758e-04
Loss = 6.3568e-02, PNorm = 64.3648, GNorm = 0.3838, lr_0 = 2.2317e-04
Loss = 7.4921e-02, PNorm = 64.3992, GNorm = 0.5293, lr_0 = 2.1884e-04
Loss = 1.0911e-03, PNorm = 64.4029, GNorm = 0.0314, lr_0 = 2.1842e-04
Validation auc = 0.850000
Epoch 20
Loss = 6.8573e-02, PNorm = 64.4299, GNorm = 0.8081, lr_0 = 2.1418e-04
Loss = 3.1942e-02, PNorm = 64.4614, GNorm = 0.2451, lr_0 = 2.1003e-04
Loss = 1.1645e-01, PNorm = 64.4782, GNorm = 0.5263, lr_0 = 2.0596e-04
Loss = 9.4973e-02, PNorm = 64.5066, GNorm = 0.8444, lr_0 = 2.0196e-04
Validation auc = 0.833117
Epoch 21
Loss = 8.3764e-02, PNorm = 64.5435, GNorm = 0.6232, lr_0 = 1.9766e-04
Loss = 7.9198e-02, PNorm = 64.5671, GNorm = 0.7209, lr_0 = 1.9383e-04
Loss = 6.1942e-02, PNorm = 64.5987, GNorm = 0.8391, lr_0 = 1.9007e-04
Loss = 7.5113e-02, PNorm = 64.6135, GNorm = 0.5342, lr_0 = 1.8638e-04
Validation auc = 0.835065
Epoch 22
Loss = 3.6126e-02, PNorm = 64.6436, GNorm = 0.4985, lr_0 = 1.8241e-04
Loss = 4.3757e-02, PNorm = 64.6625, GNorm = 0.2645, lr_0 = 1.7888e-04
Loss = 8.6481e-02, PNorm = 64.6819, GNorm = 0.9108, lr_0 = 1.7541e-04
Loss = 6.4212e-02, PNorm = 64.7063, GNorm = 0.2915, lr_0 = 1.7201e-04
Validation auc = 0.842857
Epoch 23
Loss = 7.4883e-02, PNorm = 64.7305, GNorm = 0.6106, lr_0 = 1.6834e-04
Loss = 6.4714e-02, PNorm = 64.7575, GNorm = 0.6644, lr_0 = 1.6508e-04
Loss = 5.4345e-02, PNorm = 64.7724, GNorm = 0.8870, lr_0 = 1.6188e-04
Loss = 8.5054e-02, PNorm = 64.7974, GNorm = 0.5682, lr_0 = 1.5874e-04
Validation auc = 0.843831
Epoch 24
Loss = 6.9969e-02, PNorm = 64.8182, GNorm = 0.3758, lr_0 = 1.5536e-04
Loss = 5.1129e-02, PNorm = 64.8365, GNorm = 0.3469, lr_0 = 1.5234e-04
Loss = 6.7450e-02, PNorm = 64.8530, GNorm = 0.6000, lr_0 = 1.4939e-04
Loss = 6.4336e-02, PNorm = 64.8685, GNorm = 0.5420, lr_0 = 1.4649e-04
Loss = 7.3051e-02, PNorm = 64.8897, GNorm = 0.5203, lr_0 = 1.4365e-04
Loss = 1.2040e-05, PNorm = 64.8926, GNorm = 0.0007, lr_0 = 1.4337e-04
Validation auc = 0.836039
Epoch 25
Loss = 7.1140e-02, PNorm = 64.9064, GNorm = 0.5198, lr_0 = 1.4059e-04
Loss = 5.3338e-02, PNorm = 64.9221, GNorm = 0.2211, lr_0 = 1.3787e-04
Loss = 6.1130e-02, PNorm = 64.9395, GNorm = 0.7736, lr_0 = 1.3519e-04
Loss = 5.1960e-02, PNorm = 64.9607, GNorm = 0.4289, lr_0 = 1.3257e-04
Validation auc = 0.837338
Epoch 26
Loss = 4.7264e-02, PNorm = 64.9769, GNorm = 1.0750, lr_0 = 1.2975e-04
Loss = 6.7746e-02, PNorm = 64.9858, GNorm = 0.6906, lr_0 = 1.2723e-04
Loss = 7.1032e-02, PNorm = 65.0024, GNorm = 1.0604, lr_0 = 1.2476e-04
Loss = 4.8285e-02, PNorm = 65.0144, GNorm = 0.6217, lr_0 = 1.2234e-04
Validation auc = 0.830195
Epoch 27
Loss = 4.8097e-02, PNorm = 65.0249, GNorm = 0.7869, lr_0 = 1.1974e-04
Loss = 4.9712e-02, PNorm = 65.0369, GNorm = 1.4982, lr_0 = 1.1742e-04
Loss = 5.8359e-02, PNorm = 65.0466, GNorm = 0.7479, lr_0 = 1.1514e-04
Loss = 5.4286e-02, PNorm = 65.0662, GNorm = 0.5617, lr_0 = 1.1291e-04
Validation auc = 0.831494
Epoch 28
Loss = 4.8947e-02, PNorm = 65.0801, GNorm = 0.5965, lr_0 = 1.1050e-04
Loss = 3.5393e-02, PNorm = 65.0914, GNorm = 0.5809, lr_0 = 1.0836e-04
Loss = 4.7698e-02, PNorm = 65.1018, GNorm = 0.4481, lr_0 = 1.0626e-04
Loss = 6.1694e-02, PNorm = 65.1086, GNorm = 0.3016, lr_0 = 1.0420e-04
Validation auc = 0.840260
Epoch 29
Loss = 1.7690e-02, PNorm = 65.1225, GNorm = 0.2608, lr_0 = 1.0198e-04
Loss = 4.0659e-02, PNorm = 65.1363, GNorm = 0.6789, lr_0 = 1.0000e-04
Loss = 4.4722e-02, PNorm = 65.1456, GNorm = 0.6586, lr_0 = 1.0000e-04
Loss = 5.3637e-02, PNorm = 65.1559, GNorm = 0.3944, lr_0 = 1.0000e-04
Loss = 4.1321e-02, PNorm = 65.1654, GNorm = 0.8078, lr_0 = 1.0000e-04
Loss = 5.8412e-06, PNorm = 65.1663, GNorm = 0.0005, lr_0 = 1.0000e-04
Validation auc = 0.841558
Model 0 best validation auc = 0.913636 on epoch 4
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 provided with no test set, no metric evaluation will be performed.
Ensemble test auc = nan
1-fold cross validation
	Seed 0 ==> test auc = nan
Overall test auc = nan +/- nan
Elapsed time = 0:10:42
Command line
python antibiotic.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/shxie/aiddsummary/antibio_reproduction/configew.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'antibiotic_reproduction.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.35,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/shxie/aiddsummary/antibio_reproduction/antibiotic/model_13',
 'save_preds': False,
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Activity'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
Activity 0: 94.86%, 1: 5.14%
Total size = 2,335 | train size = 2,101 | val size = 234 | test size = 0
The test data split is empty. This may be either because splitting with no test set was selected,             such as with `cv-no-test`, or because test data provided with `--separate_test_path` was empty or contained only invalid molecules.             Performance on the test set will not be evaluated and metric scores will return `nan` for each task.
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1600, out_features=1, bias=True)
  )
)
Number of parameters = 5,572,801
Epoch 0
Loss = 2.7557e-01, PNorm = 59.4787, GNorm = 0.5901, lr_0 = 2.1786e-04
Loss = 2.3560e-01, PNorm = 59.5048, GNorm = 0.2575, lr_0 = 3.2500e-04
Loss = 2.4763e-01, PNorm = 59.5346, GNorm = 0.4798, lr_0 = 4.3214e-04
Loss = 1.7671e-01, PNorm = 59.5709, GNorm = 0.2502, lr_0 = 5.3929e-04
Validation auc = 0.850000
Epoch 1
Loss = 2.3511e-01, PNorm = 59.6067, GNorm = 0.3356, lr_0 = 6.5714e-04
Loss = 1.7039e-01, PNorm = 59.6452, GNorm = 0.3605, lr_0 = 7.6429e-04
Loss = 2.4154e-01, PNorm = 59.7019, GNorm = 0.1845, lr_0 = 8.7143e-04
Loss = 1.5121e-01, PNorm = 59.7727, GNorm = 0.3678, lr_0 = 9.7857e-04
Validation auc = 0.912013
Epoch 2
Loss = 2.3143e-01, PNorm = 59.8353, GNorm = 0.2893, lr_0 = 9.8253e-04
Loss = 1.5904e-01, PNorm = 59.8992, GNorm = 0.2107, lr_0 = 9.6348e-04
Loss = 1.9232e-01, PNorm = 59.9566, GNorm = 0.9932, lr_0 = 9.4480e-04
Loss = 2.0593e-01, PNorm = 60.0283, GNorm = 0.1597, lr_0 = 9.2648e-04
Validation auc = 0.892532
Epoch 3
Loss = 2.1419e-01, PNorm = 60.1140, GNorm = 0.4468, lr_0 = 9.0674e-04
Loss = 1.7990e-01, PNorm = 60.1770, GNorm = 0.2916, lr_0 = 8.8916e-04
Loss = 1.9692e-01, PNorm = 60.2408, GNorm = 0.6179, lr_0 = 8.7192e-04
Loss = 2.0982e-01, PNorm = 60.3342, GNorm = 0.2784, lr_0 = 8.5501e-04
Validation auc = 0.875974
Epoch 4
Loss = 1.5711e-01, PNorm = 60.4230, GNorm = 0.1578, lr_0 = 8.3679e-04
Loss = 2.0644e-01, PNorm = 60.4926, GNorm = 0.1821, lr_0 = 8.2057e-04
Loss = 1.7124e-01, PNorm = 60.5714, GNorm = 0.1827, lr_0 = 8.0466e-04
Loss = 1.8072e-01, PNorm = 60.6514, GNorm = 0.3612, lr_0 = 7.8906e-04
Loss = 1.6633e-01, PNorm = 60.7302, GNorm = 0.2096, lr_0 = 7.7376e-04
Loss = 1.8587e-02, PNorm = 60.7384, GNorm = 0.2231, lr_0 = 7.7224e-04
Validation auc = 0.900974
Epoch 5
Loss = 1.4694e-01, PNorm = 60.8023, GNorm = 0.2224, lr_0 = 7.5727e-04
Loss = 1.8218e-01, PNorm = 60.8706, GNorm = 0.2929, lr_0 = 7.4259e-04
Loss = 1.8170e-01, PNorm = 60.9614, GNorm = 0.3217, lr_0 = 7.2819e-04
Loss = 1.7623e-01, PNorm = 61.0313, GNorm = 0.4965, lr_0 = 7.1407e-04
Validation auc = 0.872403
Epoch 6
Loss = 2.3832e-01, PNorm = 61.2249, GNorm = 0.2902, lr_0 = 6.9886e-04
Loss = 1.8521e-01, PNorm = 61.4227, GNorm = 0.3550, lr_0 = 6.8531e-04
Loss = 1.9881e-01, PNorm = 61.5456, GNorm = 0.3373, lr_0 = 6.7202e-04
Loss = 2.0636e-01, PNorm = 61.6124, GNorm = 0.2802, lr_0 = 6.5899e-04
Validation auc = 0.838636
Epoch 7
Loss = 1.6556e-01, PNorm = 61.7011, GNorm = 0.4231, lr_0 = 6.4495e-04
Loss = 2.3357e-01, PNorm = 61.7695, GNorm = 0.2615, lr_0 = 6.3244e-04
Loss = 1.2448e-01, PNorm = 61.8643, GNorm = 0.5885, lr_0 = 6.2018e-04
Loss = 1.6094e-01, PNorm = 61.9234, GNorm = 0.4561, lr_0 = 6.0815e-04
Validation auc = 0.838636
Epoch 8
Loss = 1.7760e-01, PNorm = 62.0115, GNorm = 0.2539, lr_0 = 5.9520e-04
Loss = 1.5876e-01, PNorm = 62.0983, GNorm = 0.4161, lr_0 = 5.8366e-04
Loss = 2.0053e-01, PNorm = 62.1935, GNorm = 0.2484, lr_0 = 5.7234e-04
Loss = 1.3883e-01, PNorm = 62.2689, GNorm = 0.2289, lr_0 = 5.6124e-04
Validation auc = 0.811039
Epoch 9
Loss = 6.4573e-02, PNorm = 62.3613, GNorm = 0.2448, lr_0 = 5.4928e-04
Loss = 1.7078e-01, PNorm = 62.4226, GNorm = 0.3986, lr_0 = 5.3863e-04
Loss = 1.6891e-01, PNorm = 62.5082, GNorm = 0.3581, lr_0 = 5.2819e-04
Loss = 1.0890e-01, PNorm = 62.5940, GNorm = 0.6897, lr_0 = 5.1795e-04
Loss = 1.6301e-01, PNorm = 62.6356, GNorm = 0.2107, lr_0 = 5.0790e-04
Loss = 3.3304e-02, PNorm = 62.6408, GNorm = 0.4076, lr_0 = 5.0691e-04
Validation auc = 0.848377
Epoch 10
Loss = 1.5520e-01, PNorm = 62.6899, GNorm = 0.4135, lr_0 = 4.9708e-04
Loss = 1.3574e-01, PNorm = 62.7499, GNorm = 0.3324, lr_0 = 4.8744e-04
Loss = 1.1908e-01, PNorm = 62.8133, GNorm = 0.4866, lr_0 = 4.7799e-04
Loss = 1.3768e-01, PNorm = 62.8562, GNorm = 0.2824, lr_0 = 4.6873e-04
Validation auc = 0.843506
Epoch 11
Loss = 1.3311e-01, PNorm = 62.9274, GNorm = 0.2923, lr_0 = 4.5874e-04
Loss = 1.1187e-01, PNorm = 62.9694, GNorm = 0.3057, lr_0 = 4.4984e-04
Loss = 1.4895e-01, PNorm = 63.0173, GNorm = 0.4189, lr_0 = 4.4112e-04
Loss = 1.2065e-01, PNorm = 63.0733, GNorm = 0.3427, lr_0 = 4.3257e-04
Validation auc = 0.874675
Epoch 12
Loss = 1.1428e-01, PNorm = 63.1328, GNorm = 0.2953, lr_0 = 4.2335e-04
Loss = 1.2359e-01, PNorm = 63.1762, GNorm = 0.9232, lr_0 = 4.1514e-04
Loss = 1.4133e-01, PNorm = 63.2105, GNorm = 0.4303, lr_0 = 4.0709e-04
Loss = 1.2290e-01, PNorm = 63.2805, GNorm = 0.2267, lr_0 = 3.9920e-04
Validation auc = 0.857143
Epoch 13
Loss = 1.5499e-01, PNorm = 63.3329, GNorm = 0.2654, lr_0 = 3.9069e-04
Loss = 8.2170e-02, PNorm = 63.3698, GNorm = 0.1961, lr_0 = 3.8312e-04
Loss = 1.2035e-01, PNorm = 63.4108, GNorm = 0.6313, lr_0 = 3.7569e-04
Loss = 1.0777e-01, PNorm = 63.4571, GNorm = 0.2978, lr_0 = 3.6841e-04
Validation auc = 0.843506
Epoch 14
Loss = 7.2370e-02, PNorm = 63.4965, GNorm = 0.6116, lr_0 = 3.6056e-04
Loss = 1.3463e-01, PNorm = 63.5467, GNorm = 0.4175, lr_0 = 3.5357e-04
Loss = 9.8806e-02, PNorm = 63.5872, GNorm = 0.4974, lr_0 = 3.4671e-04
Loss = 1.1014e-01, PNorm = 63.6223, GNorm = 0.2341, lr_0 = 3.3999e-04
Loss = 9.9646e-02, PNorm = 63.6627, GNorm = 0.2727, lr_0 = 3.3340e-04
Loss = 2.8806e-02, PNorm = 63.6682, GNorm = 0.4049, lr_0 = 3.3274e-04
Validation auc = 0.842532
Epoch 15
Loss = 7.5222e-02, PNorm = 63.7063, GNorm = 1.1764, lr_0 = 3.2629e-04
Loss = 1.2711e-01, PNorm = 63.7418, GNorm = 0.4762, lr_0 = 3.1996e-04
Loss = 1.1994e-01, PNorm = 63.7866, GNorm = 0.4986, lr_0 = 3.1376e-04
Loss = 8.6364e-02, PNorm = 63.8402, GNorm = 0.2669, lr_0 = 3.0768e-04
Validation auc = 0.807468
Epoch 16
Loss = 1.4690e-01, PNorm = 63.8789, GNorm = 0.5267, lr_0 = 3.0112e-04
Loss = 1.0505e-01, PNorm = 63.9309, GNorm = 0.9978, lr_0 = 2.9528e-04
Loss = 1.0029e-01, PNorm = 63.9576, GNorm = 0.4063, lr_0 = 2.8956e-04
Loss = 9.0109e-02, PNorm = 63.9960, GNorm = 0.2494, lr_0 = 2.8394e-04
Validation auc = 0.846429
Epoch 17
Loss = 8.4734e-02, PNorm = 64.0367, GNorm = 0.5418, lr_0 = 2.7789e-04
Loss = 8.3408e-02, PNorm = 64.0616, GNorm = 0.5518, lr_0 = 2.7250e-04
Loss = 1.0970e-01, PNorm = 64.0970, GNorm = 0.3706, lr_0 = 2.6722e-04
Loss = 8.4162e-02, PNorm = 64.1339, GNorm = 0.4518, lr_0 = 2.6204e-04
Validation auc = 0.836688
Epoch 18
Loss = 7.1075e-02, PNorm = 64.1682, GNorm = 0.4241, lr_0 = 2.5646e-04
Loss = 7.0422e-02, PNorm = 64.1951, GNorm = 0.2302, lr_0 = 2.5148e-04
Loss = 8.5973e-02, PNorm = 64.2192, GNorm = 0.8156, lr_0 = 2.4661e-04
Loss = 1.0122e-01, PNorm = 64.2514, GNorm = 0.6941, lr_0 = 2.4183e-04
Validation auc = 0.828571
Epoch 19
Loss = 7.2781e-02, PNorm = 64.2816, GNorm = 0.3442, lr_0 = 2.3667e-04
Loss = 7.4827e-02, PNorm = 64.3111, GNorm = 0.5389, lr_0 = 2.3208e-04
Loss = 1.1490e-01, PNorm = 64.3373, GNorm = 0.7150, lr_0 = 2.2758e-04
Loss = 6.4692e-02, PNorm = 64.3636, GNorm = 0.3867, lr_0 = 2.2317e-04
Loss = 7.7595e-02, PNorm = 64.3934, GNorm = 0.7019, lr_0 = 2.1884e-04
Loss = 7.0618e-04, PNorm = 64.3967, GNorm = 0.0175, lr_0 = 2.1842e-04
Validation auc = 0.849351
Epoch 20
Loss = 6.8944e-02, PNorm = 64.4223, GNorm = 0.4345, lr_0 = 2.1418e-04
Loss = 2.7866e-02, PNorm = 64.4501, GNorm = 0.2785, lr_0 = 2.1003e-04
Loss = 1.1273e-01, PNorm = 64.4660, GNorm = 0.5920, lr_0 = 2.0596e-04
Loss = 9.4323e-02, PNorm = 64.4918, GNorm = 0.9004, lr_0 = 2.0196e-04
Validation auc = 0.809416
Epoch 21
Loss = 8.4411e-02, PNorm = 64.5249, GNorm = 0.6495, lr_0 = 1.9766e-04
Loss = 7.8511e-02, PNorm = 64.5461, GNorm = 0.7074, lr_0 = 1.9383e-04
Loss = 6.5561e-02, PNorm = 64.5749, GNorm = 0.9148, lr_0 = 1.9007e-04
Loss = 7.2950e-02, PNorm = 64.5897, GNorm = 0.7098, lr_0 = 1.8638e-04
Validation auc = 0.830195
Epoch 22
Loss = 4.1981e-02, PNorm = 64.6196, GNorm = 0.4449, lr_0 = 1.8241e-04
Loss = 4.4629e-02, PNorm = 64.6401, GNorm = 0.2789, lr_0 = 1.7888e-04
Loss = 9.0079e-02, PNorm = 64.6544, GNorm = 0.9030, lr_0 = 1.7541e-04
Loss = 6.2182e-02, PNorm = 64.6789, GNorm = 0.2159, lr_0 = 1.7201e-04
Validation auc = 0.828571
Epoch 23
Loss = 7.2708e-02, PNorm = 64.7013, GNorm = 0.4723, lr_0 = 1.6834e-04
Loss = 6.3450e-02, PNorm = 64.7294, GNorm = 0.7776, lr_0 = 1.6508e-04
Loss = 4.8380e-02, PNorm = 64.7449, GNorm = 0.4932, lr_0 = 1.6188e-04
Loss = 8.7920e-02, PNorm = 64.7665, GNorm = 0.8029, lr_0 = 1.5874e-04
Validation auc = 0.827273
Epoch 24
Loss = 5.3678e-02, PNorm = 64.7874, GNorm = 0.3472, lr_0 = 1.5536e-04
Loss = 4.8108e-02, PNorm = 64.8024, GNorm = 0.3044, lr_0 = 1.5234e-04
Loss = 7.1860e-02, PNorm = 64.8148, GNorm = 0.8293, lr_0 = 1.4939e-04
Loss = 5.7983e-02, PNorm = 64.8306, GNorm = 0.5149, lr_0 = 1.4649e-04
Loss = 6.6308e-02, PNorm = 64.8482, GNorm = 0.6380, lr_0 = 1.4365e-04
Loss = 5.0305e-05, PNorm = 64.8505, GNorm = 0.0023, lr_0 = 1.4337e-04
Validation auc = 0.822403
Epoch 25
Loss = 6.4157e-02, PNorm = 64.8646, GNorm = 0.3990, lr_0 = 1.4059e-04
Loss = 5.7437e-02, PNorm = 64.8770, GNorm = 0.1962, lr_0 = 1.3787e-04
Loss = 4.6572e-02, PNorm = 64.8954, GNorm = 0.5178, lr_0 = 1.3519e-04
Loss = 5.6430e-02, PNorm = 64.9102, GNorm = 0.4144, lr_0 = 1.3257e-04
Validation auc = 0.812338
Epoch 26
Loss = 4.4362e-02, PNorm = 64.9248, GNorm = 0.7375, lr_0 = 1.2975e-04
Loss = 7.6261e-02, PNorm = 64.9349, GNorm = 0.6816, lr_0 = 1.2723e-04
Loss = 6.1109e-02, PNorm = 64.9531, GNorm = 0.9447, lr_0 = 1.2476e-04
Loss = 5.1219e-02, PNorm = 64.9649, GNorm = 0.5512, lr_0 = 1.2234e-04
Validation auc = 0.818831
Epoch 27
Loss = 3.7874e-02, PNorm = 64.9778, GNorm = 0.4407, lr_0 = 1.1974e-04
Loss = 5.0430e-02, PNorm = 64.9872, GNorm = 1.1596, lr_0 = 1.1742e-04
Loss = 6.2321e-02, PNorm = 64.9957, GNorm = 1.2645, lr_0 = 1.1514e-04
Loss = 5.2918e-02, PNorm = 65.0122, GNorm = 0.5399, lr_0 = 1.1291e-04
Validation auc = 0.812013
Epoch 28
Loss = 5.0037e-02, PNorm = 65.0253, GNorm = 0.6018, lr_0 = 1.1050e-04
Loss = 3.4612e-02, PNorm = 65.0386, GNorm = 0.5834, lr_0 = 1.0836e-04
Loss = 4.4164e-02, PNorm = 65.0499, GNorm = 0.4380, lr_0 = 1.0626e-04
Loss = 5.8334e-02, PNorm = 65.0541, GNorm = 0.4559, lr_0 = 1.0420e-04
Validation auc = 0.830844
Epoch 29
Loss = 1.9791e-02, PNorm = 65.0701, GNorm = 0.2342, lr_0 = 1.0198e-04
Loss = 4.6649e-02, PNorm = 65.0786, GNorm = 0.9544, lr_0 = 1.0000e-04
Loss = 4.9113e-02, PNorm = 65.0878, GNorm = 0.8034, lr_0 = 1.0000e-04
Loss = 4.8209e-02, PNorm = 65.0984, GNorm = 0.3137, lr_0 = 1.0000e-04
Loss = 3.7143e-02, PNorm = 65.1062, GNorm = 0.7778, lr_0 = 1.0000e-04
Loss = 3.9339e-06, PNorm = 65.1070, GNorm = 0.0003, lr_0 = 1.0000e-04
Validation auc = 0.822727
Model 0 best validation auc = 0.912013 on epoch 1
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 provided with no test set, no metric evaluation will be performed.
Ensemble test auc = nan
1-fold cross validation
	Seed 0 ==> test auc = nan
Overall test auc = nan +/- nan
Elapsed time = 0:10:33
Command line
python antibiotic.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/shxie/aiddsummary/antibio_reproduction/configew.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'antibiotic_reproduction.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.35,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/shxie/aiddsummary/antibio_reproduction/antibiotic/model_14',
 'save_preds': False,
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Activity'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
Activity 0: 94.86%, 1: 5.14%
Total size = 2,335 | train size = 2,101 | val size = 234 | test size = 0
The test data split is empty. This may be either because splitting with no test set was selected,             such as with `cv-no-test`, or because test data provided with `--separate_test_path` was empty or contained only invalid molecules.             Performance on the test set will not be evaluated and metric scores will return `nan` for each task.
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1600, out_features=1, bias=True)
  )
)
Number of parameters = 5,572,801
Epoch 0
Loss = 2.7557e-01, PNorm = 59.4787, GNorm = 0.5901, lr_0 = 2.1786e-04
Loss = 2.3560e-01, PNorm = 59.5048, GNorm = 0.2575, lr_0 = 3.2500e-04
Loss = 2.4763e-01, PNorm = 59.5346, GNorm = 0.4798, lr_0 = 4.3214e-04
Loss = 1.7671e-01, PNorm = 59.5709, GNorm = 0.2502, lr_0 = 5.3929e-04
Validation auc = 0.850000
Epoch 1
Loss = 2.3511e-01, PNorm = 59.6067, GNorm = 0.3356, lr_0 = 6.5714e-04
Loss = 1.7039e-01, PNorm = 59.6452, GNorm = 0.3607, lr_0 = 7.6429e-04
Loss = 2.4159e-01, PNorm = 59.7020, GNorm = 0.1847, lr_0 = 8.7143e-04
Loss = 1.5132e-01, PNorm = 59.7726, GNorm = 0.3712, lr_0 = 9.7857e-04
Validation auc = 0.912987
Epoch 2
Loss = 2.3147e-01, PNorm = 59.8347, GNorm = 0.2879, lr_0 = 9.8253e-04
Loss = 1.5909e-01, PNorm = 59.8977, GNorm = 0.2101, lr_0 = 9.6348e-04
Loss = 1.9405e-01, PNorm = 59.9528, GNorm = 0.9921, lr_0 = 9.4480e-04
Loss = 2.0737e-01, PNorm = 60.0245, GNorm = 0.1724, lr_0 = 9.2648e-04
Validation auc = 0.891558
Epoch 3
Loss = 2.1435e-01, PNorm = 60.1115, GNorm = 0.4351, lr_0 = 9.0674e-04
Loss = 1.7953e-01, PNorm = 60.1784, GNorm = 0.3141, lr_0 = 8.8916e-04
Loss = 1.9765e-01, PNorm = 60.2451, GNorm = 0.9101, lr_0 = 8.7192e-04
Loss = 2.1071e-01, PNorm = 60.3394, GNorm = 0.2417, lr_0 = 8.5501e-04
Validation auc = 0.885714
Epoch 4
Loss = 1.5811e-01, PNorm = 60.4302, GNorm = 0.1496, lr_0 = 8.3679e-04
Loss = 2.0720e-01, PNorm = 60.4994, GNorm = 0.1734, lr_0 = 8.2057e-04
Loss = 1.7268e-01, PNorm = 60.5764, GNorm = 0.1781, lr_0 = 8.0466e-04
Loss = 1.8142e-01, PNorm = 60.6525, GNorm = 0.3383, lr_0 = 7.8906e-04
Loss = 1.6595e-01, PNorm = 60.7241, GNorm = 0.1859, lr_0 = 7.7376e-04
Loss = 1.5265e-02, PNorm = 60.7323, GNorm = 0.1947, lr_0 = 7.7224e-04
Validation auc = 0.893831
Epoch 5
Loss = 1.4654e-01, PNorm = 60.7966, GNorm = 0.2339, lr_0 = 7.5727e-04
Loss = 1.8553e-01, PNorm = 60.8717, GNorm = 0.2847, lr_0 = 7.4259e-04
Loss = 1.8551e-01, PNorm = 60.9627, GNorm = 0.4432, lr_0 = 7.2819e-04
Loss = 1.7882e-01, PNorm = 61.0318, GNorm = 0.3481, lr_0 = 7.1407e-04
Validation auc = 0.889935
Epoch 6
Loss = 2.7044e-01, PNorm = 61.2212, GNorm = 0.3077, lr_0 = 6.9886e-04
Loss = 1.8680e-01, PNorm = 61.4160, GNorm = 0.3512, lr_0 = 6.8531e-04
Loss = 2.0130e-01, PNorm = 61.5302, GNorm = 0.3243, lr_0 = 6.7202e-04
Loss = 2.0898e-01, PNorm = 61.5926, GNorm = 0.2834, lr_0 = 6.5899e-04
Validation auc = 0.887987
Epoch 7
Loss = 1.6596e-01, PNorm = 61.6738, GNorm = 0.4403, lr_0 = 6.4495e-04
Loss = 2.4134e-01, PNorm = 61.7277, GNorm = 0.2599, lr_0 = 6.3244e-04
Loss = 1.3332e-01, PNorm = 61.8138, GNorm = 0.3817, lr_0 = 6.2018e-04
Loss = 1.6349e-01, PNorm = 61.8540, GNorm = 0.1569, lr_0 = 6.0815e-04
Validation auc = 0.878247
Epoch 8
Loss = 1.8424e-01, PNorm = 61.8921, GNorm = 0.1831, lr_0 = 5.9520e-04
Loss = 1.6584e-01, PNorm = 61.9494, GNorm = 0.2718, lr_0 = 5.8366e-04
Loss = 2.0030e-01, PNorm = 62.0140, GNorm = 0.3131, lr_0 = 5.7234e-04
Loss = 1.4409e-01, PNorm = 62.0935, GNorm = 0.4444, lr_0 = 5.6124e-04
Validation auc = 0.864935
Epoch 9
Loss = 7.6611e-02, PNorm = 62.1814, GNorm = 0.2556, lr_0 = 5.4928e-04
Loss = 1.9599e-01, PNorm = 62.2574, GNorm = 0.4196, lr_0 = 5.3863e-04
Loss = 1.9275e-01, PNorm = 62.3424, GNorm = 0.2310, lr_0 = 5.2819e-04
Loss = 1.2132e-01, PNorm = 62.4157, GNorm = 0.3521, lr_0 = 5.1795e-04
Loss = 1.8226e-01, PNorm = 62.4595, GNorm = 0.2544, lr_0 = 5.0790e-04
Loss = 8.8703e-02, PNorm = 62.4646, GNorm = 0.8521, lr_0 = 5.0691e-04
Validation auc = 0.818506
Epoch 10
Loss = 1.6009e-01, PNorm = 62.5236, GNorm = 0.4221, lr_0 = 4.9708e-04
Loss = 1.4522e-01, PNorm = 62.5799, GNorm = 0.6890, lr_0 = 4.8744e-04
Loss = 1.3539e-01, PNorm = 62.6305, GNorm = 0.3583, lr_0 = 4.7799e-04
Loss = 1.4241e-01, PNorm = 62.6735, GNorm = 0.2297, lr_0 = 4.6873e-04
Validation auc = 0.835390
Epoch 11
Loss = 1.3626e-01, PNorm = 62.7395, GNorm = 0.1944, lr_0 = 4.5874e-04
Loss = 1.2347e-01, PNorm = 62.7887, GNorm = 0.2983, lr_0 = 4.4984e-04
Loss = 1.6059e-01, PNorm = 62.8431, GNorm = 0.4128, lr_0 = 4.4112e-04
Loss = 1.3026e-01, PNorm = 62.9021, GNorm = 0.3942, lr_0 = 4.3257e-04
Validation auc = 0.867857
Epoch 12
Loss = 1.1531e-01, PNorm = 62.9651, GNorm = 0.3159, lr_0 = 4.2335e-04
Loss = 1.3353e-01, PNorm = 63.0081, GNorm = 0.4887, lr_0 = 4.1514e-04
Loss = 1.4223e-01, PNorm = 63.0441, GNorm = 0.4043, lr_0 = 4.0709e-04
Loss = 1.2714e-01, PNorm = 63.1101, GNorm = 0.2891, lr_0 = 3.9920e-04
Validation auc = 0.849026
Epoch 13
Loss = 1.6442e-01, PNorm = 63.1589, GNorm = 0.2891, lr_0 = 3.9069e-04
Loss = 8.5465e-02, PNorm = 63.1942, GNorm = 0.2098, lr_0 = 3.8312e-04
Loss = 1.3192e-01, PNorm = 63.2351, GNorm = 0.6465, lr_0 = 3.7569e-04
Loss = 1.0509e-01, PNorm = 63.2818, GNorm = 0.2644, lr_0 = 3.6841e-04
Validation auc = 0.843182
Epoch 14
Loss = 6.2814e-02, PNorm = 63.3208, GNorm = 0.5830, lr_0 = 3.6056e-04
Loss = 1.4525e-01, PNorm = 63.3666, GNorm = 0.3055, lr_0 = 3.5357e-04
Loss = 1.0282e-01, PNorm = 63.4138, GNorm = 0.3854, lr_0 = 3.4671e-04
Loss = 1.1829e-01, PNorm = 63.4585, GNorm = 0.2527, lr_0 = 3.3999e-04
Loss = 1.0408e-01, PNorm = 63.5068, GNorm = 0.2465, lr_0 = 3.3340e-04
Loss = 1.8536e-02, PNorm = 63.5124, GNorm = 0.3063, lr_0 = 3.3274e-04
Validation auc = 0.849026
Epoch 15
Loss = 7.8123e-02, PNorm = 63.5533, GNorm = 0.9812, lr_0 = 3.2629e-04
Loss = 1.3486e-01, PNorm = 63.5897, GNorm = 0.5138, lr_0 = 3.1996e-04
Loss = 1.2634e-01, PNorm = 63.6364, GNorm = 0.3296, lr_0 = 3.1376e-04
Loss = 9.3862e-02, PNorm = 63.6838, GNorm = 0.3428, lr_0 = 3.0768e-04
Validation auc = 0.837987
Epoch 16
Loss = 1.4591e-01, PNorm = 63.7187, GNorm = 0.4189, lr_0 = 3.0112e-04
Loss = 1.1152e-01, PNorm = 63.7726, GNorm = 1.1977, lr_0 = 2.9528e-04
Loss = 1.0612e-01, PNorm = 63.7893, GNorm = 0.3966, lr_0 = 2.8956e-04
Loss = 9.7260e-02, PNorm = 63.8317, GNorm = 0.2285, lr_0 = 2.8394e-04
Validation auc = 0.861364
Epoch 17
Loss = 9.4319e-02, PNorm = 63.8761, GNorm = 0.4965, lr_0 = 2.7789e-04
Loss = 8.7461e-02, PNorm = 63.9065, GNorm = 0.4918, lr_0 = 2.7250e-04
Loss = 1.1565e-01, PNorm = 63.9419, GNorm = 0.5951, lr_0 = 2.6722e-04
Loss = 8.7634e-02, PNorm = 63.9822, GNorm = 0.3705, lr_0 = 2.6204e-04
Validation auc = 0.845779
Epoch 18
Loss = 6.5877e-02, PNorm = 64.0118, GNorm = 0.2958, lr_0 = 2.5646e-04
Loss = 6.9142e-02, PNorm = 64.0399, GNorm = 0.3355, lr_0 = 2.5148e-04
Loss = 9.6624e-02, PNorm = 64.0695, GNorm = 0.6471, lr_0 = 2.4661e-04
Loss = 1.0670e-01, PNorm = 64.1018, GNorm = 0.6611, lr_0 = 2.4183e-04
Validation auc = 0.838961
Epoch 19
Loss = 6.1670e-02, PNorm = 64.1390, GNorm = 0.3325, lr_0 = 2.3667e-04
Loss = 8.2967e-02, PNorm = 64.1698, GNorm = 0.4626, lr_0 = 2.3208e-04
Loss = 1.1644e-01, PNorm = 64.1990, GNorm = 0.4792, lr_0 = 2.2758e-04
Loss = 7.6210e-02, PNorm = 64.2321, GNorm = 0.4344, lr_0 = 2.2317e-04
Loss = 8.2748e-02, PNorm = 64.2664, GNorm = 0.6132, lr_0 = 2.1884e-04
Loss = 1.2360e-03, PNorm = 64.2701, GNorm = 0.0282, lr_0 = 2.1842e-04
Validation auc = 0.857143
Epoch 20
Loss = 7.4268e-02, PNorm = 64.2981, GNorm = 0.8818, lr_0 = 2.1418e-04
Loss = 3.1687e-02, PNorm = 64.3287, GNorm = 0.2024, lr_0 = 2.1003e-04
Loss = 1.1797e-01, PNorm = 64.3422, GNorm = 0.5725, lr_0 = 2.0596e-04
Loss = 9.8798e-02, PNorm = 64.3720, GNorm = 0.9745, lr_0 = 2.0196e-04
Validation auc = 0.833766
Epoch 21
Loss = 8.7208e-02, PNorm = 64.4074, GNorm = 0.6980, lr_0 = 1.9766e-04
Loss = 8.1880e-02, PNorm = 64.4278, GNorm = 0.6332, lr_0 = 1.9383e-04
Loss = 6.2139e-02, PNorm = 64.4583, GNorm = 0.7937, lr_0 = 1.9007e-04
Loss = 7.7172e-02, PNorm = 64.4749, GNorm = 0.6882, lr_0 = 1.8638e-04
Validation auc = 0.840260
Epoch 22
Loss = 3.7307e-02, PNorm = 64.5048, GNorm = 0.4631, lr_0 = 1.8241e-04
Loss = 4.4060e-02, PNorm = 64.5250, GNorm = 0.2532, lr_0 = 1.7888e-04
Loss = 8.2517e-02, PNorm = 64.5453, GNorm = 0.5753, lr_0 = 1.7541e-04
Loss = 6.3795e-02, PNorm = 64.5645, GNorm = 0.3775, lr_0 = 1.7201e-04
Validation auc = 0.840260
Epoch 23
Loss = 6.0690e-02, PNorm = 64.5883, GNorm = 0.7016, lr_0 = 1.6834e-04
Loss = 6.5861e-02, PNorm = 64.6132, GNorm = 0.9039, lr_0 = 1.6508e-04
Loss = 4.9013e-02, PNorm = 64.6293, GNorm = 0.5667, lr_0 = 1.6188e-04
Loss = 8.3424e-02, PNorm = 64.6562, GNorm = 0.7131, lr_0 = 1.5874e-04
Validation auc = 0.841234
Epoch 24
Loss = 5.9286e-02, PNorm = 64.6762, GNorm = 0.4353, lr_0 = 1.5536e-04
Loss = 4.9799e-02, PNorm = 64.6953, GNorm = 0.3271, lr_0 = 1.5234e-04
Loss = 6.7814e-02, PNorm = 64.7113, GNorm = 0.7146, lr_0 = 1.4939e-04
Loss = 6.7080e-02, PNorm = 64.7289, GNorm = 0.5663, lr_0 = 1.4649e-04
Loss = 6.7028e-02, PNorm = 64.7481, GNorm = 0.4141, lr_0 = 1.4365e-04
Loss = 3.4195e-04, PNorm = 64.7508, GNorm = 0.0116, lr_0 = 1.4337e-04
Validation auc = 0.840584
Epoch 25
Loss = 7.0308e-02, PNorm = 64.7639, GNorm = 0.4533, lr_0 = 1.4059e-04
Loss = 5.9929e-02, PNorm = 64.7810, GNorm = 0.1118, lr_0 = 1.3787e-04
Loss = 6.2811e-02, PNorm = 64.7939, GNorm = 0.5649, lr_0 = 1.3519e-04
Loss = 5.8525e-02, PNorm = 64.8133, GNorm = 0.6554, lr_0 = 1.3257e-04
Validation auc = 0.832468
Epoch 26
Loss = 4.3383e-02, PNorm = 64.8271, GNorm = 0.7719, lr_0 = 1.2975e-04
Loss = 7.1157e-02, PNorm = 64.8359, GNorm = 0.7615, lr_0 = 1.2723e-04
Loss = 7.2500e-02, PNorm = 64.8539, GNorm = 1.2078, lr_0 = 1.2476e-04
Loss = 5.3759e-02, PNorm = 64.8652, GNorm = 0.8734, lr_0 = 1.2234e-04
Validation auc = 0.827922
Epoch 27
Loss = 4.4069e-02, PNorm = 64.8762, GNorm = 0.4275, lr_0 = 1.1974e-04
Loss = 5.4186e-02, PNorm = 64.8870, GNorm = 1.1632, lr_0 = 1.1742e-04
Loss = 6.4573e-02, PNorm = 64.8957, GNorm = 0.8961, lr_0 = 1.1514e-04
Loss = 5.3933e-02, PNorm = 64.9139, GNorm = 0.4849, lr_0 = 1.1291e-04
Validation auc = 0.833442
Epoch 28
Loss = 3.9496e-02, PNorm = 64.9277, GNorm = 0.6284, lr_0 = 1.1050e-04
Loss = 3.3535e-02, PNorm = 64.9429, GNorm = 0.6475, lr_0 = 1.0836e-04
Loss = 4.4204e-02, PNorm = 64.9515, GNorm = 0.4615, lr_0 = 1.0626e-04
Loss = 6.9779e-02, PNorm = 64.9585, GNorm = 0.3979, lr_0 = 1.0420e-04
Validation auc = 0.837987
Epoch 29
Loss = 2.0390e-02, PNorm = 64.9711, GNorm = 0.3228, lr_0 = 1.0198e-04
Loss = 3.3692e-02, PNorm = 64.9803, GNorm = 0.4531, lr_0 = 1.0000e-04
Loss = 4.2971e-02, PNorm = 64.9943, GNorm = 0.7175, lr_0 = 1.0000e-04
Loss = 5.8952e-02, PNorm = 64.9998, GNorm = 0.4595, lr_0 = 1.0000e-04
Loss = 4.4640e-02, PNorm = 65.0097, GNorm = 0.8171, lr_0 = 1.0000e-04
Loss = 1.7643e-05, PNorm = 65.0110, GNorm = 0.0010, lr_0 = 1.0000e-04
Validation auc = 0.849026
Model 0 best validation auc = 0.912987 on epoch 1
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 provided with no test set, no metric evaluation will be performed.
Ensemble test auc = nan
1-fold cross validation
	Seed 0 ==> test auc = nan
Overall test auc = nan +/- nan
Elapsed time = 0:10:34
Command line
python antibiotic.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/shxie/aiddsummary/antibio_reproduction/configew.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'antibiotic_reproduction.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.35,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/shxie/aiddsummary/antibio_reproduction/antibiotic/model_15',
 'save_preds': False,
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Activity'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
Activity 0: 94.86%, 1: 5.14%
Total size = 2,335 | train size = 2,101 | val size = 234 | test size = 0
The test data split is empty. This may be either because splitting with no test set was selected,             such as with `cv-no-test`, or because test data provided with `--separate_test_path` was empty or contained only invalid molecules.             Performance on the test set will not be evaluated and metric scores will return `nan` for each task.
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1600, out_features=1, bias=True)
  )
)
Number of parameters = 5,572,801
Epoch 0
Loss = 2.7557e-01, PNorm = 59.4787, GNorm = 0.5901, lr_0 = 2.1786e-04
Loss = 2.3560e-01, PNorm = 59.5048, GNorm = 0.2575, lr_0 = 3.2500e-04
Loss = 2.4763e-01, PNorm = 59.5346, GNorm = 0.4798, lr_0 = 4.3214e-04
Loss = 1.7671e-01, PNorm = 59.5709, GNorm = 0.2502, lr_0 = 5.3929e-04
Validation auc = 0.850000
Epoch 1
Loss = 2.3511e-01, PNorm = 59.6067, GNorm = 0.3356, lr_0 = 6.5714e-04
Loss = 1.7038e-01, PNorm = 59.6452, GNorm = 0.3605, lr_0 = 7.6429e-04
Loss = 2.4155e-01, PNorm = 59.7020, GNorm = 0.1841, lr_0 = 8.7143e-04
Loss = 1.5123e-01, PNorm = 59.7728, GNorm = 0.3668, lr_0 = 9.7857e-04
Validation auc = 0.912013
Epoch 2
Loss = 2.3135e-01, PNorm = 59.8350, GNorm = 0.2880, lr_0 = 9.8253e-04
Loss = 1.5910e-01, PNorm = 59.8985, GNorm = 0.2133, lr_0 = 9.6348e-04
Loss = 1.9414e-01, PNorm = 59.9548, GNorm = 0.9795, lr_0 = 9.4480e-04
Loss = 2.0751e-01, PNorm = 60.0276, GNorm = 0.1704, lr_0 = 9.2648e-04
Validation auc = 0.893506
Epoch 3
Loss = 2.1406e-01, PNorm = 60.1140, GNorm = 0.4319, lr_0 = 9.0674e-04
Loss = 1.7973e-01, PNorm = 60.1757, GNorm = 0.2956, lr_0 = 8.8916e-04
Loss = 1.9783e-01, PNorm = 60.2324, GNorm = 0.5053, lr_0 = 8.7192e-04
Loss = 2.1235e-01, PNorm = 60.3215, GNorm = 0.2735, lr_0 = 8.5501e-04
Validation auc = 0.878247
Epoch 4
Loss = 1.5896e-01, PNorm = 60.4044, GNorm = 0.1621, lr_0 = 8.3679e-04
Loss = 2.0619e-01, PNorm = 60.4735, GNorm = 0.1937, lr_0 = 8.2057e-04
Loss = 1.6863e-01, PNorm = 60.5487, GNorm = 0.1928, lr_0 = 8.0466e-04
Loss = 1.8258e-01, PNorm = 60.6301, GNorm = 0.3330, lr_0 = 7.8906e-04
Loss = 1.6476e-01, PNorm = 60.7102, GNorm = 0.2186, lr_0 = 7.7376e-04
Loss = 1.8564e-02, PNorm = 60.7186, GNorm = 0.2219, lr_0 = 7.7224e-04
Validation auc = 0.876299
Epoch 5
Loss = 1.4565e-01, PNorm = 60.7885, GNorm = 0.2493, lr_0 = 7.5727e-04
Loss = 1.8657e-01, PNorm = 60.8664, GNorm = 0.3141, lr_0 = 7.4259e-04
Loss = 1.8766e-01, PNorm = 60.9630, GNorm = 0.4634, lr_0 = 7.2819e-04
Loss = 1.7535e-01, PNorm = 61.0436, GNorm = 0.2277, lr_0 = 7.1407e-04
Validation auc = 0.881169
Epoch 6
Loss = 2.6141e-01, PNorm = 61.2587, GNorm = 0.4729, lr_0 = 6.9886e-04
Loss = 1.8736e-01, PNorm = 61.4734, GNorm = 0.3920, lr_0 = 6.8531e-04
Loss = 2.0328e-01, PNorm = 61.6098, GNorm = 0.2738, lr_0 = 6.7202e-04
Loss = 2.1102e-01, PNorm = 61.6903, GNorm = 0.2731, lr_0 = 6.5899e-04
Validation auc = 0.915909
Epoch 7
Loss = 1.6700e-01, PNorm = 61.7793, GNorm = 0.3626, lr_0 = 6.4495e-04
Loss = 2.4162e-01, PNorm = 61.8376, GNorm = 0.3210, lr_0 = 6.3244e-04
Loss = 1.3147e-01, PNorm = 61.9158, GNorm = 0.4620, lr_0 = 6.2018e-04
Loss = 1.6006e-01, PNorm = 61.9595, GNorm = 0.2183, lr_0 = 6.0815e-04
Validation auc = 0.855519
Epoch 8
Loss = 1.8316e-01, PNorm = 62.0179, GNorm = 0.1955, lr_0 = 5.9520e-04
Loss = 1.5785e-01, PNorm = 62.0893, GNorm = 0.3101, lr_0 = 5.8366e-04
Loss = 2.1447e-01, PNorm = 62.1753, GNorm = 0.2697, lr_0 = 5.7234e-04
Loss = 1.4285e-01, PNorm = 62.2458, GNorm = 0.2423, lr_0 = 5.6124e-04
Validation auc = 0.809740
Epoch 9
Loss = 7.1490e-02, PNorm = 62.3384, GNorm = 0.2853, lr_0 = 5.4928e-04
Loss = 1.8106e-01, PNorm = 62.3952, GNorm = 0.2433, lr_0 = 5.3863e-04
Loss = 1.8538e-01, PNorm = 62.4701, GNorm = 0.2193, lr_0 = 5.2819e-04
Loss = 1.2289e-01, PNorm = 62.5559, GNorm = 0.4604, lr_0 = 5.1795e-04
Loss = 1.7490e-01, PNorm = 62.6024, GNorm = 0.2329, lr_0 = 5.0790e-04
Loss = 5.5260e-02, PNorm = 62.6074, GNorm = 0.7285, lr_0 = 5.0691e-04
Validation auc = 0.842532
Epoch 10
Loss = 1.5124e-01, PNorm = 62.6571, GNorm = 0.4742, lr_0 = 4.9708e-04
Loss = 1.4463e-01, PNorm = 62.7082, GNorm = 0.3859, lr_0 = 4.8744e-04
Loss = 1.2653e-01, PNorm = 62.7598, GNorm = 0.4030, lr_0 = 4.7799e-04
Loss = 1.4093e-01, PNorm = 62.8033, GNorm = 0.2475, lr_0 = 4.6873e-04
Validation auc = 0.844805
Epoch 11
Loss = 1.4349e-01, PNorm = 62.8651, GNorm = 0.1855, lr_0 = 4.5874e-04
Loss = 1.3281e-01, PNorm = 62.9028, GNorm = 0.1861, lr_0 = 4.4984e-04
Loss = 1.6773e-01, PNorm = 62.9472, GNorm = 0.4194, lr_0 = 4.4112e-04
Loss = 1.2591e-01, PNorm = 63.0180, GNorm = 0.3359, lr_0 = 4.3257e-04
Validation auc = 0.852922
Epoch 12
Loss = 1.1564e-01, PNorm = 63.0772, GNorm = 0.3059, lr_0 = 4.2335e-04
Loss = 1.3267e-01, PNorm = 63.1145, GNorm = 0.4200, lr_0 = 4.1514e-04
Loss = 1.3972e-01, PNorm = 63.1463, GNorm = 0.4220, lr_0 = 4.0709e-04
Loss = 1.2561e-01, PNorm = 63.2051, GNorm = 0.2492, lr_0 = 3.9920e-04
Validation auc = 0.837662
Epoch 13
Loss = 1.5691e-01, PNorm = 63.2500, GNorm = 0.2735, lr_0 = 3.9069e-04
Loss = 8.4495e-02, PNorm = 63.2856, GNorm = 0.1942, lr_0 = 3.8312e-04
Loss = 1.3081e-01, PNorm = 63.3272, GNorm = 0.7251, lr_0 = 3.7569e-04
Loss = 1.0839e-01, PNorm = 63.3725, GNorm = 0.2822, lr_0 = 3.6841e-04
Validation auc = 0.844156
Epoch 14
Loss = 7.0323e-02, PNorm = 63.4090, GNorm = 0.6202, lr_0 = 3.6056e-04
Loss = 1.4605e-01, PNorm = 63.4533, GNorm = 0.2885, lr_0 = 3.5357e-04
Loss = 1.0192e-01, PNorm = 63.4967, GNorm = 0.3677, lr_0 = 3.4671e-04
Loss = 1.1976e-01, PNorm = 63.5404, GNorm = 0.2302, lr_0 = 3.3999e-04
Loss = 1.0577e-01, PNorm = 63.5849, GNorm = 0.2486, lr_0 = 3.3340e-04
Loss = 2.1871e-02, PNorm = 63.5906, GNorm = 0.3473, lr_0 = 3.3274e-04
Validation auc = 0.843506
Epoch 15
Loss = 7.6049e-02, PNorm = 63.6299, GNorm = 1.1117, lr_0 = 3.2629e-04
Loss = 1.3312e-01, PNorm = 63.6688, GNorm = 0.3538, lr_0 = 3.1996e-04
Loss = 1.2735e-01, PNorm = 63.7155, GNorm = 0.2763, lr_0 = 3.1376e-04
Loss = 9.2946e-02, PNorm = 63.7616, GNorm = 0.2844, lr_0 = 3.0768e-04
Validation auc = 0.817857
Epoch 16
Loss = 1.4884e-01, PNorm = 63.7951, GNorm = 0.4085, lr_0 = 3.0112e-04
Loss = 1.1147e-01, PNorm = 63.8504, GNorm = 1.2739, lr_0 = 2.9528e-04
Loss = 1.1257e-01, PNorm = 63.8715, GNorm = 0.2798, lr_0 = 2.8956e-04
Loss = 1.0186e-01, PNorm = 63.9079, GNorm = 0.2542, lr_0 = 2.8394e-04
Validation auc = 0.855195
Epoch 17
Loss = 9.8006e-02, PNorm = 63.9526, GNorm = 0.3989, lr_0 = 2.7789e-04
Loss = 9.1204e-02, PNorm = 63.9803, GNorm = 0.6672, lr_0 = 2.7250e-04
Loss = 1.1918e-01, PNorm = 64.0148, GNorm = 0.3755, lr_0 = 2.6722e-04
Loss = 9.3096e-02, PNorm = 64.0496, GNorm = 0.3663, lr_0 = 2.6204e-04
Validation auc = 0.836688
Epoch 18
Loss = 6.1115e-02, PNorm = 64.0760, GNorm = 0.2949, lr_0 = 2.5646e-04
Loss = 7.1178e-02, PNorm = 64.1002, GNorm = 0.2342, lr_0 = 2.5148e-04
Loss = 1.0476e-01, PNorm = 64.1227, GNorm = 0.7266, lr_0 = 2.4661e-04
Loss = 1.1020e-01, PNorm = 64.1537, GNorm = 0.6521, lr_0 = 2.4183e-04
Validation auc = 0.835065
Epoch 19
Loss = 7.7898e-02, PNorm = 64.1821, GNorm = 0.3010, lr_0 = 2.3667e-04
Loss = 8.1090e-02, PNorm = 64.2137, GNorm = 0.4322, lr_0 = 2.3208e-04
Loss = 1.1419e-01, PNorm = 64.2395, GNorm = 0.4077, lr_0 = 2.2758e-04
Loss = 7.6762e-02, PNorm = 64.2696, GNorm = 0.3417, lr_0 = 2.2317e-04
Loss = 7.9901e-02, PNorm = 64.2992, GNorm = 0.6766, lr_0 = 2.1884e-04
Loss = 5.6156e-04, PNorm = 64.3032, GNorm = 0.0183, lr_0 = 2.1842e-04
Validation auc = 0.839935
Epoch 20
Loss = 7.8816e-02, PNorm = 64.3309, GNorm = 0.8362, lr_0 = 2.1418e-04
Loss = 3.2166e-02, PNorm = 64.3625, GNorm = 0.2312, lr_0 = 2.1003e-04
Loss = 1.1653e-01, PNorm = 64.3826, GNorm = 0.4597, lr_0 = 2.0596e-04
Loss = 1.0322e-01, PNorm = 64.4076, GNorm = 0.7587, lr_0 = 2.0196e-04
Validation auc = 0.830195
Epoch 21
Loss = 8.3589e-02, PNorm = 64.4426, GNorm = 0.6790, lr_0 = 1.9766e-04
Loss = 8.2451e-02, PNorm = 64.4683, GNorm = 0.5686, lr_0 = 1.9383e-04
Loss = 6.2472e-02, PNorm = 64.4961, GNorm = 0.9076, lr_0 = 1.9007e-04
Loss = 8.7347e-02, PNorm = 64.5154, GNorm = 0.9866, lr_0 = 1.8638e-04
Validation auc = 0.834091
Epoch 22
Loss = 3.6061e-02, PNorm = 64.5448, GNorm = 0.6819, lr_0 = 1.8241e-04
Loss = 5.0010e-02, PNorm = 64.5638, GNorm = 0.2522, lr_0 = 1.7888e-04
Loss = 8.8272e-02, PNorm = 64.5838, GNorm = 0.6689, lr_0 = 1.7541e-04
Loss = 6.9332e-02, PNorm = 64.6064, GNorm = 0.2374, lr_0 = 1.7201e-04
Validation auc = 0.842532
Epoch 23
Loss = 7.7965e-02, PNorm = 64.6287, GNorm = 0.7621, lr_0 = 1.6834e-04
Loss = 6.8657e-02, PNorm = 64.6540, GNorm = 0.8286, lr_0 = 1.6508e-04
Loss = 6.1519e-02, PNorm = 64.6700, GNorm = 0.6591, lr_0 = 1.6188e-04
Loss = 9.7213e-02, PNorm = 64.6938, GNorm = 0.8110, lr_0 = 1.5874e-04
Validation auc = 0.845130
Epoch 24
Loss = 6.7137e-02, PNorm = 64.7165, GNorm = 0.3116, lr_0 = 1.5536e-04
Loss = 5.6234e-02, PNorm = 64.7343, GNorm = 0.4090, lr_0 = 1.5234e-04
Loss = 7.2884e-02, PNorm = 64.7523, GNorm = 0.5249, lr_0 = 1.4939e-04
Loss = 6.4643e-02, PNorm = 64.7672, GNorm = 0.6713, lr_0 = 1.4649e-04
Loss = 7.1500e-02, PNorm = 64.7867, GNorm = 0.5570, lr_0 = 1.4365e-04
Loss = 4.4226e-05, PNorm = 64.7894, GNorm = 0.0026, lr_0 = 1.4337e-04
Validation auc = 0.833117
Epoch 25
Loss = 7.2919e-02, PNorm = 64.8010, GNorm = 0.3802, lr_0 = 1.4059e-04
Loss = 6.6541e-02, PNorm = 64.8178, GNorm = 0.1296, lr_0 = 1.3787e-04
Loss = 6.0203e-02, PNorm = 64.8321, GNorm = 0.5250, lr_0 = 1.3519e-04
Loss = 6.6243e-02, PNorm = 64.8495, GNorm = 0.3863, lr_0 = 1.3257e-04
Validation auc = 0.838636
Epoch 26
Loss = 4.4746e-02, PNorm = 64.8646, GNorm = 0.7094, lr_0 = 1.2975e-04
Loss = 8.0455e-02, PNorm = 64.8755, GNorm = 0.7940, lr_0 = 1.2723e-04
Loss = 7.4783e-02, PNorm = 64.8927, GNorm = 1.1117, lr_0 = 1.2476e-04
Loss = 5.2485e-02, PNorm = 64.9058, GNorm = 0.7776, lr_0 = 1.2234e-04
Validation auc = 0.832143
Epoch 27
Loss = 4.5501e-02, PNorm = 64.9169, GNorm = 0.5789, lr_0 = 1.1974e-04
Loss = 5.5936e-02, PNorm = 64.9291, GNorm = 1.3939, lr_0 = 1.1742e-04
Loss = 6.5538e-02, PNorm = 64.9401, GNorm = 0.9203, lr_0 = 1.1514e-04
Loss = 6.6994e-02, PNorm = 64.9562, GNorm = 0.6885, lr_0 = 1.1291e-04
Validation auc = 0.829870
Epoch 28
Loss = 6.1616e-02, PNorm = 64.9708, GNorm = 0.9838, lr_0 = 1.1050e-04
Loss = 3.7119e-02, PNorm = 64.9830, GNorm = 0.6036, lr_0 = 1.0836e-04
Loss = 5.2426e-02, PNorm = 64.9937, GNorm = 0.4084, lr_0 = 1.0626e-04
Loss = 5.9710e-02, PNorm = 65.0007, GNorm = 0.3844, lr_0 = 1.0420e-04
Validation auc = 0.838961
Epoch 29
Loss = 2.4383e-02, PNorm = 65.0164, GNorm = 0.3348, lr_0 = 1.0198e-04
Loss = 4.2868e-02, PNorm = 65.0273, GNorm = 0.8104, lr_0 = 1.0000e-04
Loss = 5.4090e-02, PNorm = 65.0387, GNorm = 1.0689, lr_0 = 1.0000e-04
Loss = 5.7961e-02, PNorm = 65.0450, GNorm = 0.5670, lr_0 = 1.0000e-04
Loss = 4.0693e-02, PNorm = 65.0563, GNorm = 0.8949, lr_0 = 1.0000e-04
Loss = 2.3842e-06, PNorm = 65.0574, GNorm = 0.0002, lr_0 = 1.0000e-04
Validation auc = 0.840584
Model 0 best validation auc = 0.915909 on epoch 6
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 provided with no test set, no metric evaluation will be performed.
Ensemble test auc = nan
1-fold cross validation
	Seed 0 ==> test auc = nan
Overall test auc = nan +/- nan
Elapsed time = 0:10:48
Command line
python antibiotic.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/shxie/aiddsummary/antibio_reproduction/configew.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'antibiotic_reproduction.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.35,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/shxie/aiddsummary/antibio_reproduction/antibiotic/model_16',
 'save_preds': False,
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Activity'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
Activity 0: 94.86%, 1: 5.14%
Total size = 2,335 | train size = 2,101 | val size = 234 | test size = 0
The test data split is empty. This may be either because splitting with no test set was selected,             such as with `cv-no-test`, or because test data provided with `--separate_test_path` was empty or contained only invalid molecules.             Performance on the test set will not be evaluated and metric scores will return `nan` for each task.
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1600, out_features=1, bias=True)
  )
)
Number of parameters = 5,572,801
Epoch 0
Loss = 2.7557e-01, PNorm = 59.4787, GNorm = 0.5901, lr_0 = 2.1786e-04
Loss = 2.3560e-01, PNorm = 59.5048, GNorm = 0.2575, lr_0 = 3.2500e-04
Loss = 2.4763e-01, PNorm = 59.5346, GNorm = 0.4798, lr_0 = 4.3214e-04
Loss = 1.7671e-01, PNorm = 59.5709, GNorm = 0.2502, lr_0 = 5.3929e-04
Validation auc = 0.850000
Epoch 1
Loss = 2.3511e-01, PNorm = 59.6067, GNorm = 0.3356, lr_0 = 6.5714e-04
Loss = 1.7039e-01, PNorm = 59.6452, GNorm = 0.3607, lr_0 = 7.6429e-04
Loss = 2.4159e-01, PNorm = 59.7020, GNorm = 0.1845, lr_0 = 8.7143e-04
Loss = 1.5124e-01, PNorm = 59.7727, GNorm = 0.3685, lr_0 = 9.7857e-04
Validation auc = 0.912013
Epoch 2
Loss = 2.3139e-01, PNorm = 59.8351, GNorm = 0.2880, lr_0 = 9.8253e-04
Loss = 1.5901e-01, PNorm = 59.8976, GNorm = 0.2127, lr_0 = 9.6348e-04
Loss = 1.9380e-01, PNorm = 59.9530, GNorm = 1.0004, lr_0 = 9.4480e-04
Loss = 2.0607e-01, PNorm = 60.0239, GNorm = 0.1667, lr_0 = 9.2648e-04
Validation auc = 0.892857
Epoch 3
Loss = 2.1435e-01, PNorm = 60.1080, GNorm = 0.4343, lr_0 = 9.0674e-04
Loss = 1.7951e-01, PNorm = 60.1707, GNorm = 0.3153, lr_0 = 8.8916e-04
Loss = 1.9716e-01, PNorm = 60.2310, GNorm = 0.6593, lr_0 = 8.7192e-04
Loss = 2.1061e-01, PNorm = 60.3180, GNorm = 0.2727, lr_0 = 8.5501e-04
Validation auc = 0.877273
Epoch 4
Loss = 1.5731e-01, PNorm = 60.4014, GNorm = 0.1587, lr_0 = 8.3679e-04
Loss = 2.0551e-01, PNorm = 60.4712, GNorm = 0.1758, lr_0 = 8.2057e-04
Loss = 1.7141e-01, PNorm = 60.5483, GNorm = 0.1776, lr_0 = 8.0466e-04
Loss = 1.8089e-01, PNorm = 60.6276, GNorm = 0.3608, lr_0 = 7.8906e-04
Loss = 1.6539e-01, PNorm = 60.7059, GNorm = 0.1979, lr_0 = 7.7376e-04
Loss = 1.7033e-02, PNorm = 60.7147, GNorm = 0.2139, lr_0 = 7.7224e-04
Validation auc = 0.901623
Epoch 5
Loss = 1.4733e-01, PNorm = 60.7754, GNorm = 0.2215, lr_0 = 7.5727e-04
Loss = 1.8091e-01, PNorm = 60.8475, GNorm = 0.2803, lr_0 = 7.4259e-04
Loss = 1.8080e-01, PNorm = 60.9403, GNorm = 0.3201, lr_0 = 7.2819e-04
Loss = 1.8214e-01, PNorm = 61.0013, GNorm = 0.4328, lr_0 = 7.1407e-04
Validation auc = 0.864286
Epoch 6
Loss = 2.6194e-01, PNorm = 61.1915, GNorm = 0.2942, lr_0 = 6.9886e-04
Loss = 1.8543e-01, PNorm = 61.3875, GNorm = 0.3348, lr_0 = 6.8531e-04
Loss = 1.9878e-01, PNorm = 61.5095, GNorm = 0.3316, lr_0 = 6.7202e-04
Loss = 2.0553e-01, PNorm = 61.5769, GNorm = 0.2816, lr_0 = 6.5899e-04
Validation auc = 0.854545
Epoch 7
Loss = 1.6019e-01, PNorm = 61.6672, GNorm = 0.3973, lr_0 = 6.4495e-04
Loss = 2.3210e-01, PNorm = 61.7436, GNorm = 0.5163, lr_0 = 6.3244e-04
Loss = 1.2143e-01, PNorm = 61.8341, GNorm = 0.5538, lr_0 = 6.2018e-04
Loss = 1.5956e-01, PNorm = 61.8887, GNorm = 0.3435, lr_0 = 6.0815e-04
Validation auc = 0.844481
Epoch 8
Loss = 1.6973e-01, PNorm = 61.9679, GNorm = 0.2373, lr_0 = 5.9520e-04
Loss = 1.4795e-01, PNorm = 62.0497, GNorm = 0.5130, lr_0 = 5.8366e-04
Loss = 2.1019e-01, PNorm = 62.1526, GNorm = 0.2621, lr_0 = 5.7234e-04
Loss = 1.4457e-01, PNorm = 62.2263, GNorm = 0.2053, lr_0 = 5.6124e-04
Validation auc = 0.839610
Epoch 9
Loss = 7.2523e-02, PNorm = 62.3192, GNorm = 0.2154, lr_0 = 5.4928e-04
Loss = 1.8844e-01, PNorm = 62.3846, GNorm = 0.4348, lr_0 = 5.3863e-04
Loss = 1.9504e-01, PNorm = 62.4598, GNorm = 0.2092, lr_0 = 5.2819e-04
Loss = 1.2173e-01, PNorm = 62.5475, GNorm = 0.3016, lr_0 = 5.1795e-04
Loss = 1.7430e-01, PNorm = 62.6074, GNorm = 0.2380, lr_0 = 5.0790e-04
Loss = 7.5076e-02, PNorm = 62.6132, GNorm = 1.0478, lr_0 = 5.0691e-04
Validation auc = 0.839935
Epoch 10
Loss = 1.5100e-01, PNorm = 62.6664, GNorm = 0.4706, lr_0 = 4.9708e-04
Loss = 1.4255e-01, PNorm = 62.7193, GNorm = 0.3064, lr_0 = 4.8744e-04
Loss = 1.3100e-01, PNorm = 62.7739, GNorm = 0.6817, lr_0 = 4.7799e-04
Loss = 1.4079e-01, PNorm = 62.8215, GNorm = 0.2145, lr_0 = 4.6873e-04
Validation auc = 0.844156
Epoch 11
Loss = 1.3599e-01, PNorm = 62.8845, GNorm = 0.2788, lr_0 = 4.5874e-04
Loss = 1.1379e-01, PNorm = 62.9329, GNorm = 0.2375, lr_0 = 4.4984e-04
Loss = 1.5085e-01, PNorm = 62.9807, GNorm = 0.4442, lr_0 = 4.4112e-04
Loss = 1.1962e-01, PNorm = 63.0363, GNorm = 0.3703, lr_0 = 4.3257e-04
Validation auc = 0.873052
Epoch 12
Loss = 1.0847e-01, PNorm = 63.0900, GNorm = 0.3013, lr_0 = 4.2335e-04
Loss = 1.1915e-01, PNorm = 63.1354, GNorm = 0.4808, lr_0 = 4.1514e-04
Loss = 1.3743e-01, PNorm = 63.1726, GNorm = 0.5879, lr_0 = 4.0709e-04
Loss = 1.1991e-01, PNorm = 63.2492, GNorm = 0.2068, lr_0 = 3.9920e-04
Validation auc = 0.843182
Epoch 13
Loss = 1.5311e-01, PNorm = 63.2987, GNorm = 0.3127, lr_0 = 3.9069e-04
Loss = 8.4649e-02, PNorm = 63.3372, GNorm = 0.1759, lr_0 = 3.8312e-04
Loss = 1.2749e-01, PNorm = 63.3791, GNorm = 0.6001, lr_0 = 3.7569e-04
Loss = 1.0867e-01, PNorm = 63.4253, GNorm = 0.3854, lr_0 = 3.6841e-04
Validation auc = 0.842208
Epoch 14
Loss = 7.4501e-02, PNorm = 63.4706, GNorm = 0.6458, lr_0 = 3.6056e-04
Loss = 1.4094e-01, PNorm = 63.5232, GNorm = 0.3115, lr_0 = 3.5357e-04
Loss = 1.0213e-01, PNorm = 63.5672, GNorm = 0.3431, lr_0 = 3.4671e-04
Loss = 1.1577e-01, PNorm = 63.6116, GNorm = 0.1742, lr_0 = 3.3999e-04
Loss = 1.0231e-01, PNorm = 63.6525, GNorm = 0.2765, lr_0 = 3.3340e-04
Loss = 1.6738e-02, PNorm = 63.6578, GNorm = 0.2840, lr_0 = 3.3274e-04
Validation auc = 0.850000
Epoch 15
Loss = 7.8149e-02, PNorm = 63.6951, GNorm = 1.3963, lr_0 = 3.2629e-04
Loss = 1.2721e-01, PNorm = 63.7324, GNorm = 0.4876, lr_0 = 3.1996e-04
Loss = 1.2363e-01, PNorm = 63.7786, GNorm = 0.3936, lr_0 = 3.1376e-04
Loss = 8.9189e-02, PNorm = 63.8289, GNorm = 0.2848, lr_0 = 3.0768e-04
Validation auc = 0.827273
Epoch 16
Loss = 1.4956e-01, PNorm = 63.8625, GNorm = 0.4485, lr_0 = 3.0112e-04
Loss = 1.1248e-01, PNorm = 63.9171, GNorm = 0.9828, lr_0 = 2.9528e-04
Loss = 1.0753e-01, PNorm = 63.9400, GNorm = 0.2303, lr_0 = 2.8956e-04
Loss = 9.3226e-02, PNorm = 63.9744, GNorm = 0.2480, lr_0 = 2.8394e-04
Validation auc = 0.848701
Epoch 17
Loss = 8.9856e-02, PNorm = 64.0230, GNorm = 0.5568, lr_0 = 2.7789e-04
Loss = 8.9288e-02, PNorm = 64.0481, GNorm = 0.4812, lr_0 = 2.7250e-04
Loss = 1.1223e-01, PNorm = 64.0822, GNorm = 0.4446, lr_0 = 2.6722e-04
Loss = 8.5169e-02, PNorm = 64.1196, GNorm = 0.4190, lr_0 = 2.6204e-04
Validation auc = 0.838961
Epoch 18
Loss = 5.7949e-02, PNorm = 64.1504, GNorm = 0.3146, lr_0 = 2.5646e-04
Loss = 6.9380e-02, PNorm = 64.1742, GNorm = 0.3040, lr_0 = 2.5148e-04
Loss = 8.7169e-02, PNorm = 64.2005, GNorm = 0.7575, lr_0 = 2.4661e-04
Loss = 1.0303e-01, PNorm = 64.2277, GNorm = 0.6854, lr_0 = 2.4183e-04
Validation auc = 0.835390
Epoch 19
Loss = 6.9776e-02, PNorm = 64.2636, GNorm = 0.3259, lr_0 = 2.3667e-04
Loss = 8.3485e-02, PNorm = 64.2930, GNorm = 0.4706, lr_0 = 2.3208e-04
Loss = 1.1482e-01, PNorm = 64.3248, GNorm = 0.4090, lr_0 = 2.2758e-04
Loss = 6.5458e-02, PNorm = 64.3534, GNorm = 0.4145, lr_0 = 2.2317e-04
Loss = 7.4555e-02, PNorm = 64.3864, GNorm = 0.6299, lr_0 = 2.1884e-04
Loss = 3.4541e-04, PNorm = 64.3904, GNorm = 0.0111, lr_0 = 2.1842e-04
Validation auc = 0.844156
Epoch 20
Loss = 7.1512e-02, PNorm = 64.4161, GNorm = 1.1391, lr_0 = 2.1418e-04
Loss = 2.8707e-02, PNorm = 64.4470, GNorm = 0.2308, lr_0 = 2.1003e-04
Loss = 1.1313e-01, PNorm = 64.4674, GNorm = 0.6264, lr_0 = 2.0596e-04
Loss = 9.5872e-02, PNorm = 64.4940, GNorm = 0.8566, lr_0 = 2.0196e-04
Validation auc = 0.829870
Epoch 21
Loss = 8.5106e-02, PNorm = 64.5334, GNorm = 0.7424, lr_0 = 1.9766e-04
Loss = 7.9327e-02, PNorm = 64.5550, GNorm = 0.6769, lr_0 = 1.9383e-04
Loss = 6.1377e-02, PNorm = 64.5876, GNorm = 0.8715, lr_0 = 1.9007e-04
Loss = 7.4233e-02, PNorm = 64.6021, GNorm = 0.7043, lr_0 = 1.8638e-04
Validation auc = 0.834091
Epoch 22
Loss = 3.7433e-02, PNorm = 64.6290, GNorm = 0.4189, lr_0 = 1.8241e-04
Loss = 4.3901e-02, PNorm = 64.6478, GNorm = 0.2558, lr_0 = 1.7888e-04
Loss = 8.5282e-02, PNorm = 64.6652, GNorm = 0.7000, lr_0 = 1.7541e-04
Loss = 6.4235e-02, PNorm = 64.6869, GNorm = 0.3680, lr_0 = 1.7201e-04
Validation auc = 0.840909
Epoch 23
Loss = 6.7147e-02, PNorm = 64.7089, GNorm = 0.5339, lr_0 = 1.6834e-04
Loss = 6.6814e-02, PNorm = 64.7347, GNorm = 0.8458, lr_0 = 1.6508e-04
Loss = 5.0377e-02, PNorm = 64.7492, GNorm = 0.7210, lr_0 = 1.6188e-04
Loss = 7.8894e-02, PNorm = 64.7745, GNorm = 0.5869, lr_0 = 1.5874e-04
Validation auc = 0.836688
Epoch 24
Loss = 5.3470e-02, PNorm = 64.7924, GNorm = 0.4129, lr_0 = 1.5536e-04
Loss = 4.6285e-02, PNorm = 64.8140, GNorm = 0.2864, lr_0 = 1.5234e-04
Loss = 7.0416e-02, PNorm = 64.8284, GNorm = 0.8078, lr_0 = 1.4939e-04
Loss = 6.6052e-02, PNorm = 64.8439, GNorm = 0.6039, lr_0 = 1.4649e-04
Loss = 6.6871e-02, PNorm = 64.8635, GNorm = 0.4604, lr_0 = 1.4365e-04
Loss = 9.2741e-05, PNorm = 64.8663, GNorm = 0.0041, lr_0 = 1.4337e-04
Validation auc = 0.835390
Epoch 25
Loss = 7.2103e-02, PNorm = 64.8799, GNorm = 0.4569, lr_0 = 1.4059e-04
Loss = 5.2354e-02, PNorm = 64.8943, GNorm = 0.1851, lr_0 = 1.3787e-04
Loss = 6.0289e-02, PNorm = 64.9103, GNorm = 0.5220, lr_0 = 1.3519e-04
Loss = 5.8058e-02, PNorm = 64.9300, GNorm = 0.4969, lr_0 = 1.3257e-04
Validation auc = 0.830195
Epoch 26
Loss = 4.6605e-02, PNorm = 64.9439, GNorm = 0.6918, lr_0 = 1.2975e-04
Loss = 6.9890e-02, PNorm = 64.9525, GNorm = 0.7069, lr_0 = 1.2723e-04
Loss = 7.0473e-02, PNorm = 64.9686, GNorm = 0.9419, lr_0 = 1.2476e-04
Loss = 4.8192e-02, PNorm = 64.9805, GNorm = 0.6101, lr_0 = 1.2234e-04
Validation auc = 0.825974
Epoch 27
Loss = 4.5323e-02, PNorm = 64.9928, GNorm = 0.6762, lr_0 = 1.1974e-04
Loss = 5.4684e-02, PNorm = 65.0029, GNorm = 1.4851, lr_0 = 1.1742e-04
Loss = 6.0971e-02, PNorm = 65.0095, GNorm = 0.7555, lr_0 = 1.1514e-04
Loss = 5.5396e-02, PNorm = 65.0250, GNorm = 0.4668, lr_0 = 1.1291e-04
Validation auc = 0.828571
Epoch 28
Loss = 5.3766e-02, PNorm = 65.0400, GNorm = 0.5639, lr_0 = 1.1050e-04
Loss = 3.3973e-02, PNorm = 65.0522, GNorm = 0.5648, lr_0 = 1.0836e-04
Loss = 5.0507e-02, PNorm = 65.0626, GNorm = 0.4291, lr_0 = 1.0626e-04
Loss = 6.1461e-02, PNorm = 65.0665, GNorm = 0.6687, lr_0 = 1.0420e-04
Validation auc = 0.837662
Epoch 29
Loss = 2.1779e-02, PNorm = 65.0828, GNorm = 0.3216, lr_0 = 1.0198e-04
Loss = 4.4503e-02, PNorm = 65.0922, GNorm = 0.5417, lr_0 = 1.0000e-04
Loss = 4.7791e-02, PNorm = 65.1017, GNorm = 0.7976, lr_0 = 1.0000e-04
Loss = 5.1546e-02, PNorm = 65.1105, GNorm = 0.3353, lr_0 = 1.0000e-04
Loss = 3.3466e-02, PNorm = 65.1184, GNorm = 0.6900, lr_0 = 1.0000e-04
Loss = 2.5153e-05, PNorm = 65.1193, GNorm = 0.0018, lr_0 = 1.0000e-04
Validation auc = 0.833117
Model 0 best validation auc = 0.912013 on epoch 1
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 provided with no test set, no metric evaluation will be performed.
Ensemble test auc = nan
1-fold cross validation
	Seed 0 ==> test auc = nan
Overall test auc = nan +/- nan
Elapsed time = 0:10:30
Command line
python antibiotic.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/shxie/aiddsummary/antibio_reproduction/configew.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'antibiotic_reproduction.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.35,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/shxie/aiddsummary/antibio_reproduction/antibiotic/model_17',
 'save_preds': False,
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Activity'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
Activity 0: 94.86%, 1: 5.14%
Total size = 2,335 | train size = 2,101 | val size = 234 | test size = 0
The test data split is empty. This may be either because splitting with no test set was selected,             such as with `cv-no-test`, or because test data provided with `--separate_test_path` was empty or contained only invalid molecules.             Performance on the test set will not be evaluated and metric scores will return `nan` for each task.
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1600, out_features=1, bias=True)
  )
)
Number of parameters = 5,572,801
Epoch 0
Loss = 2.7557e-01, PNorm = 59.4787, GNorm = 0.5901, lr_0 = 2.1786e-04
Loss = 2.3560e-01, PNorm = 59.5048, GNorm = 0.2575, lr_0 = 3.2500e-04
Loss = 2.4763e-01, PNorm = 59.5346, GNorm = 0.4798, lr_0 = 4.3214e-04
Loss = 1.7671e-01, PNorm = 59.5709, GNorm = 0.2502, lr_0 = 5.3929e-04
Validation auc = 0.850000
Epoch 1
Loss = 2.3511e-01, PNorm = 59.6067, GNorm = 0.3356, lr_0 = 6.5714e-04
Loss = 1.7039e-01, PNorm = 59.6452, GNorm = 0.3607, lr_0 = 7.6429e-04
Loss = 2.4157e-01, PNorm = 59.7020, GNorm = 0.1845, lr_0 = 8.7143e-04
Loss = 1.5126e-01, PNorm = 59.7726, GNorm = 0.3687, lr_0 = 9.7857e-04
Validation auc = 0.912013
Epoch 2
Loss = 2.3128e-01, PNorm = 59.8352, GNorm = 0.2866, lr_0 = 9.8253e-04
Loss = 1.5894e-01, PNorm = 59.8983, GNorm = 0.2107, lr_0 = 9.6348e-04
Loss = 1.9316e-01, PNorm = 59.9554, GNorm = 0.9652, lr_0 = 9.4480e-04
Loss = 2.0674e-01, PNorm = 60.0263, GNorm = 0.1634, lr_0 = 9.2648e-04
Validation auc = 0.884740
Epoch 3
Loss = 2.1495e-01, PNorm = 60.1137, GNorm = 0.4985, lr_0 = 9.0674e-04
Loss = 1.7916e-01, PNorm = 60.1820, GNorm = 0.3225, lr_0 = 8.8916e-04
Loss = 1.9619e-01, PNorm = 60.2477, GNorm = 0.8469, lr_0 = 8.7192e-04
Loss = 2.0928e-01, PNorm = 60.3401, GNorm = 0.2508, lr_0 = 8.5501e-04
Validation auc = 0.884416
Epoch 4
Loss = 1.5671e-01, PNorm = 60.4279, GNorm = 0.1533, lr_0 = 8.3679e-04
Loss = 2.0806e-01, PNorm = 60.5002, GNorm = 0.1788, lr_0 = 8.2057e-04
Loss = 1.7491e-01, PNorm = 60.5829, GNorm = 0.1775, lr_0 = 8.0466e-04
Loss = 1.8364e-01, PNorm = 60.6621, GNorm = 0.3121, lr_0 = 7.8906e-04
Loss = 1.6629e-01, PNorm = 60.7355, GNorm = 0.1937, lr_0 = 7.7376e-04
Loss = 1.9201e-02, PNorm = 60.7429, GNorm = 0.2219, lr_0 = 7.7224e-04
Validation auc = 0.868506
Epoch 5
Loss = 1.4349e-01, PNorm = 60.8139, GNorm = 0.2371, lr_0 = 7.5727e-04
Loss = 1.7645e-01, PNorm = 60.8835, GNorm = 0.3031, lr_0 = 7.4259e-04
Loss = 1.8526e-01, PNorm = 60.9744, GNorm = 0.5277, lr_0 = 7.2819e-04
Loss = 1.8007e-01, PNorm = 61.0501, GNorm = 0.2867, lr_0 = 7.1407e-04
Validation auc = 0.865584
Epoch 6
Loss = 2.8759e-01, PNorm = 61.2712, GNorm = 0.6433, lr_0 = 6.9886e-04
Loss = 1.8912e-01, PNorm = 61.4896, GNorm = 0.3842, lr_0 = 6.8531e-04
Loss = 2.0535e-01, PNorm = 61.6248, GNorm = 0.2733, lr_0 = 6.7202e-04
Loss = 2.1177e-01, PNorm = 61.7107, GNorm = 0.2641, lr_0 = 6.5899e-04
Validation auc = 0.923701
Epoch 7
Loss = 1.6250e-01, PNorm = 61.8015, GNorm = 0.3512, lr_0 = 6.4495e-04
Loss = 2.4053e-01, PNorm = 61.8495, GNorm = 0.2159, lr_0 = 6.3244e-04
Loss = 1.3776e-01, PNorm = 61.9362, GNorm = 0.4192, lr_0 = 6.2018e-04
Loss = 1.6352e-01, PNorm = 61.9827, GNorm = 0.1704, lr_0 = 6.0815e-04
Validation auc = 0.855844
Epoch 8
Loss = 1.8364e-01, PNorm = 62.0289, GNorm = 0.1839, lr_0 = 5.9520e-04
Loss = 1.6471e-01, PNorm = 62.0850, GNorm = 0.2874, lr_0 = 5.8366e-04
Loss = 2.0429e-01, PNorm = 62.1446, GNorm = 0.3193, lr_0 = 5.7234e-04
Loss = 1.3925e-01, PNorm = 62.2269, GNorm = 0.4068, lr_0 = 5.6124e-04
Validation auc = 0.849351
Epoch 9
Loss = 6.8298e-02, PNorm = 62.3240, GNorm = 0.2795, lr_0 = 5.4928e-04
Loss = 1.9409e-01, PNorm = 62.4004, GNorm = 0.2648, lr_0 = 5.3863e-04
Loss = 1.9123e-01, PNorm = 62.5017, GNorm = 0.1745, lr_0 = 5.2819e-04
Loss = 1.2905e-01, PNorm = 62.5882, GNorm = 0.3986, lr_0 = 5.1795e-04
Loss = 1.8470e-01, PNorm = 62.6318, GNorm = 0.2329, lr_0 = 5.0790e-04
Loss = 1.2810e-01, PNorm = 62.6361, GNorm = 1.2033, lr_0 = 5.0691e-04
Validation auc = 0.854870
Epoch 10
Loss = 1.6954e-01, PNorm = 62.6902, GNorm = 0.3204, lr_0 = 4.9708e-04
Loss = 1.4417e-01, PNorm = 62.7430, GNorm = 0.5570, lr_0 = 4.8744e-04
Loss = 1.4239e-01, PNorm = 62.7916, GNorm = 0.2935, lr_0 = 4.7799e-04
Loss = 1.4161e-01, PNorm = 62.8298, GNorm = 0.2561, lr_0 = 4.6873e-04
Validation auc = 0.830195
Epoch 11
Loss = 1.3661e-01, PNorm = 62.8882, GNorm = 0.2243, lr_0 = 4.5874e-04
Loss = 1.2919e-01, PNorm = 62.9229, GNorm = 0.3278, lr_0 = 4.4984e-04
Loss = 1.6394e-01, PNorm = 62.9753, GNorm = 0.3304, lr_0 = 4.4112e-04
Loss = 1.3460e-01, PNorm = 63.0331, GNorm = 0.3596, lr_0 = 4.3257e-04
Validation auc = 0.864286
Epoch 12
Loss = 1.2106e-01, PNorm = 63.0914, GNorm = 0.2887, lr_0 = 4.2335e-04
Loss = 1.3630e-01, PNorm = 63.1341, GNorm = 0.4358, lr_0 = 4.1514e-04
Loss = 1.5310e-01, PNorm = 63.1696, GNorm = 0.3014, lr_0 = 4.0709e-04
Loss = 1.3044e-01, PNorm = 63.2255, GNorm = 0.4222, lr_0 = 3.9920e-04
Validation auc = 0.846104
Epoch 13
Loss = 1.6159e-01, PNorm = 63.2781, GNorm = 0.2437, lr_0 = 3.9069e-04
Loss = 9.0614e-02, PNorm = 63.3076, GNorm = 0.1899, lr_0 = 3.8312e-04
Loss = 1.3302e-01, PNorm = 63.3499, GNorm = 0.5819, lr_0 = 3.7569e-04
Loss = 1.1445e-01, PNorm = 63.3991, GNorm = 0.3038, lr_0 = 3.6841e-04
Validation auc = 0.844805
Epoch 14
Loss = 6.6401e-02, PNorm = 63.4359, GNorm = 0.4714, lr_0 = 3.6056e-04
Loss = 1.4650e-01, PNorm = 63.4794, GNorm = 0.5260, lr_0 = 3.5357e-04
Loss = 1.0941e-01, PNorm = 63.5250, GNorm = 0.4556, lr_0 = 3.4671e-04
Loss = 1.1752e-01, PNorm = 63.5668, GNorm = 0.2570, lr_0 = 3.3999e-04
Loss = 1.0646e-01, PNorm = 63.6134, GNorm = 0.2419, lr_0 = 3.3340e-04
Loss = 6.1766e-03, PNorm = 63.6183, GNorm = 0.1072, lr_0 = 3.3274e-04
Validation auc = 0.846753
Epoch 15
Loss = 7.6666e-02, PNorm = 63.6562, GNorm = 1.1467, lr_0 = 3.2629e-04
Loss = 1.4395e-01, PNorm = 63.6902, GNorm = 0.5257, lr_0 = 3.1996e-04
Loss = 1.3396e-01, PNorm = 63.7369, GNorm = 0.3674, lr_0 = 3.1376e-04
Loss = 9.4796e-02, PNorm = 63.7862, GNorm = 0.2339, lr_0 = 3.0768e-04
Validation auc = 0.847403
Epoch 16
Loss = 1.5783e-01, PNorm = 63.8159, GNorm = 0.4686, lr_0 = 3.0112e-04
Loss = 1.1175e-01, PNorm = 63.8759, GNorm = 0.9925, lr_0 = 2.9528e-04
Loss = 1.1712e-01, PNorm = 63.9000, GNorm = 0.2642, lr_0 = 2.8956e-04
Loss = 9.7866e-02, PNorm = 63.9345, GNorm = 0.2901, lr_0 = 2.8394e-04
Validation auc = 0.857792
Epoch 17
Loss = 1.0247e-01, PNorm = 63.9830, GNorm = 0.4729, lr_0 = 2.7789e-04
Loss = 9.5100e-02, PNorm = 64.0105, GNorm = 0.6081, lr_0 = 2.7250e-04
Loss = 1.2071e-01, PNorm = 64.0454, GNorm = 0.3421, lr_0 = 2.6722e-04
Loss = 9.3215e-02, PNorm = 64.0804, GNorm = 0.4395, lr_0 = 2.6204e-04
Validation auc = 0.844805
Epoch 18
Loss = 6.7389e-02, PNorm = 64.1052, GNorm = 0.3126, lr_0 = 2.5646e-04
Loss = 7.6765e-02, PNorm = 64.1272, GNorm = 0.3384, lr_0 = 2.5148e-04
Loss = 9.9232e-02, PNorm = 64.1523, GNorm = 0.7999, lr_0 = 2.4661e-04
Loss = 1.1022e-01, PNorm = 64.1826, GNorm = 0.5896, lr_0 = 2.4183e-04
Validation auc = 0.833442
Epoch 19
Loss = 7.9463e-02, PNorm = 64.2158, GNorm = 0.3685, lr_0 = 2.3667e-04
Loss = 8.7024e-02, PNorm = 64.2459, GNorm = 0.4935, lr_0 = 2.3208e-04
Loss = 1.1683e-01, PNorm = 64.2720, GNorm = 0.4296, lr_0 = 2.2758e-04
Loss = 7.2626e-02, PNorm = 64.3000, GNorm = 0.3531, lr_0 = 2.2317e-04
Loss = 7.9844e-02, PNorm = 64.3338, GNorm = 0.6082, lr_0 = 2.1884e-04
Loss = 6.1684e-04, PNorm = 64.3378, GNorm = 0.0164, lr_0 = 2.1842e-04
Validation auc = 0.849026
Epoch 20
Loss = 8.0689e-02, PNorm = 64.3660, GNorm = 0.7696, lr_0 = 2.1418e-04
Loss = 3.4351e-02, PNorm = 64.4034, GNorm = 0.1410, lr_0 = 2.1003e-04
Loss = 1.2882e-01, PNorm = 64.4168, GNorm = 0.6844, lr_0 = 2.0596e-04
Loss = 1.0783e-01, PNorm = 64.4434, GNorm = 0.9148, lr_0 = 2.0196e-04
Validation auc = 0.826299
Epoch 21
Loss = 9.1911e-02, PNorm = 64.4757, GNorm = 0.6387, lr_0 = 1.9766e-04
Loss = 8.8199e-02, PNorm = 64.4974, GNorm = 0.5268, lr_0 = 1.9383e-04
Loss = 6.8396e-02, PNorm = 64.5239, GNorm = 0.7189, lr_0 = 1.9007e-04
Loss = 7.8254e-02, PNorm = 64.5436, GNorm = 0.8274, lr_0 = 1.8638e-04
Validation auc = 0.834416
Epoch 22
Loss = 3.3613e-02, PNorm = 64.5722, GNorm = 0.4151, lr_0 = 1.8241e-04
Loss = 5.1616e-02, PNorm = 64.5896, GNorm = 0.3344, lr_0 = 1.7888e-04
Loss = 9.4377e-02, PNorm = 64.6056, GNorm = 0.7580, lr_0 = 1.7541e-04
Loss = 6.5710e-02, PNorm = 64.6299, GNorm = 0.2548, lr_0 = 1.7201e-04
Validation auc = 0.838636
Epoch 23
Loss = 7.4015e-02, PNorm = 64.6511, GNorm = 0.6098, lr_0 = 1.6834e-04
Loss = 7.2731e-02, PNorm = 64.6775, GNorm = 0.8007, lr_0 = 1.6508e-04
Loss = 5.4704e-02, PNorm = 64.6944, GNorm = 0.6986, lr_0 = 1.6188e-04
Loss = 9.2144e-02, PNorm = 64.7183, GNorm = 0.7711, lr_0 = 1.5874e-04
Validation auc = 0.837987
Epoch 24
Loss = 6.1873e-02, PNorm = 64.7384, GNorm = 0.4117, lr_0 = 1.5536e-04
Loss = 6.4872e-02, PNorm = 64.7559, GNorm = 0.4109, lr_0 = 1.5234e-04
Loss = 8.2597e-02, PNorm = 64.7722, GNorm = 0.6715, lr_0 = 1.4939e-04
Loss = 6.8078e-02, PNorm = 64.7880, GNorm = 0.4922, lr_0 = 1.4649e-04
Loss = 6.9211e-02, PNorm = 64.8073, GNorm = 0.5005, lr_0 = 1.4365e-04
Loss = 1.0645e-04, PNorm = 64.8099, GNorm = 0.0042, lr_0 = 1.4337e-04
Validation auc = 0.836039
Epoch 25
Loss = 7.7573e-02, PNorm = 64.8228, GNorm = 0.5454, lr_0 = 1.4059e-04
Loss = 6.2935e-02, PNorm = 64.8374, GNorm = 0.1372, lr_0 = 1.3787e-04
Loss = 6.3511e-02, PNorm = 64.8534, GNorm = 0.4899, lr_0 = 1.3519e-04
Loss = 6.1009e-02, PNorm = 64.8710, GNorm = 0.5530, lr_0 = 1.3257e-04
Validation auc = 0.827597
Epoch 26
Loss = 3.7795e-02, PNorm = 64.8856, GNorm = 0.5790, lr_0 = 1.2975e-04
Loss = 8.1653e-02, PNorm = 64.8956, GNorm = 0.8874, lr_0 = 1.2723e-04
Loss = 6.7757e-02, PNorm = 64.9113, GNorm = 1.0439, lr_0 = 1.2476e-04
Loss = 5.5620e-02, PNorm = 64.9223, GNorm = 0.8219, lr_0 = 1.2234e-04
Validation auc = 0.829545
Epoch 27
Loss = 4.2159e-02, PNorm = 64.9351, GNorm = 0.5304, lr_0 = 1.1974e-04
Loss = 5.3150e-02, PNorm = 64.9451, GNorm = 1.3588, lr_0 = 1.1742e-04
Loss = 6.9292e-02, PNorm = 64.9555, GNorm = 0.8462, lr_0 = 1.1514e-04
Loss = 5.6250e-02, PNorm = 64.9710, GNorm = 0.5618, lr_0 = 1.1291e-04
Validation auc = 0.828247
Epoch 28
Loss = 5.3536e-02, PNorm = 64.9845, GNorm = 0.4093, lr_0 = 1.1050e-04
Loss = 3.7569e-02, PNorm = 65.0009, GNorm = 0.7793, lr_0 = 1.0836e-04
Loss = 5.4024e-02, PNorm = 65.0105, GNorm = 0.4532, lr_0 = 1.0626e-04
Loss = 6.2414e-02, PNorm = 65.0167, GNorm = 0.3034, lr_0 = 1.0420e-04
Validation auc = 0.834091
Epoch 29
Loss = 2.4727e-02, PNorm = 65.0299, GNorm = 0.3611, lr_0 = 1.0198e-04
Loss = 4.2450e-02, PNorm = 65.0417, GNorm = 0.5803, lr_0 = 1.0000e-04
Loss = 5.0871e-02, PNorm = 65.0530, GNorm = 0.8119, lr_0 = 1.0000e-04
Loss = 6.1835e-02, PNorm = 65.0585, GNorm = 0.5603, lr_0 = 1.0000e-04
Loss = 4.5971e-02, PNorm = 65.0671, GNorm = 1.1291, lr_0 = 1.0000e-04
Loss = 3.1232e-05, PNorm = 65.0679, GNorm = 0.0019, lr_0 = 1.0000e-04
Validation auc = 0.839935
Model 0 best validation auc = 0.923701 on epoch 6
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 provided with no test set, no metric evaluation will be performed.
Ensemble test auc = nan
1-fold cross validation
	Seed 0 ==> test auc = nan
Overall test auc = nan +/- nan
Elapsed time = 0:10:32
Command line
python antibiotic.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/shxie/aiddsummary/antibio_reproduction/configew.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'antibiotic_reproduction.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.35,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/shxie/aiddsummary/antibio_reproduction/antibiotic/model_18',
 'save_preds': False,
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Activity'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
Activity 0: 94.86%, 1: 5.14%
Total size = 2,335 | train size = 2,101 | val size = 234 | test size = 0
The test data split is empty. This may be either because splitting with no test set was selected,             such as with `cv-no-test`, or because test data provided with `--separate_test_path` was empty or contained only invalid molecules.             Performance on the test set will not be evaluated and metric scores will return `nan` for each task.
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1600, out_features=1, bias=True)
  )
)
Number of parameters = 5,572,801
Epoch 0
Loss = 2.7557e-01, PNorm = 59.4787, GNorm = 0.5901, lr_0 = 2.1786e-04
Loss = 2.3560e-01, PNorm = 59.5048, GNorm = 0.2575, lr_0 = 3.2500e-04
Loss = 2.4763e-01, PNorm = 59.5346, GNorm = 0.4798, lr_0 = 4.3214e-04
Loss = 1.7671e-01, PNorm = 59.5709, GNorm = 0.2502, lr_0 = 5.3929e-04
Validation auc = 0.850000
Epoch 1
Loss = 2.3511e-01, PNorm = 59.6067, GNorm = 0.3356, lr_0 = 6.5714e-04
Loss = 1.7039e-01, PNorm = 59.6452, GNorm = 0.3607, lr_0 = 7.6429e-04
Loss = 2.4159e-01, PNorm = 59.7020, GNorm = 0.1848, lr_0 = 8.7143e-04
Loss = 1.5132e-01, PNorm = 59.7726, GNorm = 0.3718, lr_0 = 9.7857e-04
Validation auc = 0.912987
Epoch 2
Loss = 2.3144e-01, PNorm = 59.8350, GNorm = 0.2882, lr_0 = 9.8253e-04
Loss = 1.5894e-01, PNorm = 59.8983, GNorm = 0.2100, lr_0 = 9.6348e-04
Loss = 1.9321e-01, PNorm = 59.9558, GNorm = 1.0204, lr_0 = 9.4480e-04
Loss = 2.0526e-01, PNorm = 60.0298, GNorm = 0.1628, lr_0 = 9.2648e-04
Validation auc = 0.897078
Epoch 3
Loss = 2.1421e-01, PNorm = 60.1180, GNorm = 0.4268, lr_0 = 9.0674e-04
Loss = 1.7972e-01, PNorm = 60.1824, GNorm = 0.2878, lr_0 = 8.8916e-04
Loss = 1.9765e-01, PNorm = 60.2460, GNorm = 0.7461, lr_0 = 8.7192e-04
Loss = 2.1013e-01, PNorm = 60.3356, GNorm = 0.2564, lr_0 = 8.5501e-04
Validation auc = 0.873701
Epoch 4
Loss = 1.5809e-01, PNorm = 60.4239, GNorm = 0.1607, lr_0 = 8.3679e-04
Loss = 2.0451e-01, PNorm = 60.4969, GNorm = 0.1774, lr_0 = 8.2057e-04
Loss = 1.7078e-01, PNorm = 60.5779, GNorm = 0.1853, lr_0 = 8.0466e-04
Loss = 1.8164e-01, PNorm = 60.6583, GNorm = 0.3669, lr_0 = 7.8906e-04
Loss = 1.6568e-01, PNorm = 60.7361, GNorm = 0.2124, lr_0 = 7.7376e-04
Loss = 1.7153e-02, PNorm = 60.7445, GNorm = 0.2164, lr_0 = 7.7224e-04
Validation auc = 0.895779
Epoch 5
Loss = 1.4779e-01, PNorm = 60.8074, GNorm = 0.2300, lr_0 = 7.5727e-04
Loss = 1.7757e-01, PNorm = 60.8824, GNorm = 0.3035, lr_0 = 7.4259e-04
Loss = 1.8291e-01, PNorm = 60.9723, GNorm = 0.5102, lr_0 = 7.2819e-04
Loss = 1.7335e-01, PNorm = 61.0468, GNorm = 0.3928, lr_0 = 7.1407e-04
Validation auc = 0.853571
Epoch 6
Loss = 2.4976e-01, PNorm = 61.2688, GNorm = 0.3472, lr_0 = 6.9886e-04
Loss = 1.8527e-01, PNorm = 61.4772, GNorm = 0.3740, lr_0 = 6.8531e-04
Loss = 1.9945e-01, PNorm = 61.6041, GNorm = 0.2173, lr_0 = 6.7202e-04
Loss = 2.1063e-01, PNorm = 61.6852, GNorm = 0.2628, lr_0 = 6.5899e-04
Validation auc = 0.892857
Epoch 7
Loss = 1.6267e-01, PNorm = 61.7713, GNorm = 0.4214, lr_0 = 6.4495e-04
Loss = 2.3978e-01, PNorm = 61.8200, GNorm = 0.2763, lr_0 = 6.3244e-04
Loss = 1.3308e-01, PNorm = 61.9076, GNorm = 0.3846, lr_0 = 6.2018e-04
Loss = 1.6050e-01, PNorm = 61.9475, GNorm = 0.1845, lr_0 = 6.0815e-04
Validation auc = 0.831818
Epoch 8
Loss = 1.8241e-01, PNorm = 61.9939, GNorm = 0.1849, lr_0 = 5.9520e-04
Loss = 1.6265e-01, PNorm = 62.0521, GNorm = 0.2889, lr_0 = 5.8366e-04
Loss = 2.0533e-01, PNorm = 62.1118, GNorm = 0.2638, lr_0 = 5.7234e-04
Loss = 1.3750e-01, PNorm = 62.1956, GNorm = 0.3693, lr_0 = 5.6124e-04
Validation auc = 0.802922
Epoch 9
Loss = 7.2918e-02, PNorm = 62.2988, GNorm = 0.1821, lr_0 = 5.4928e-04
Loss = 2.0148e-01, PNorm = 62.3795, GNorm = 0.2724, lr_0 = 5.3863e-04
Loss = 1.9694e-01, PNorm = 62.4838, GNorm = 0.1776, lr_0 = 5.2819e-04
Loss = 1.3184e-01, PNorm = 62.5746, GNorm = 0.4266, lr_0 = 5.1795e-04
Loss = 1.8248e-01, PNorm = 62.6245, GNorm = 0.2583, lr_0 = 5.0790e-04
Loss = 8.2712e-02, PNorm = 62.6296, GNorm = 1.2861, lr_0 = 5.0691e-04
Validation auc = 0.832143
Epoch 10
Loss = 1.7110e-01, PNorm = 62.6805, GNorm = 0.3908, lr_0 = 4.9708e-04
Loss = 1.4939e-01, PNorm = 62.7364, GNorm = 0.9142, lr_0 = 4.8744e-04
Loss = 1.4076e-01, PNorm = 62.7934, GNorm = 0.2484, lr_0 = 4.7799e-04
Loss = 1.3571e-01, PNorm = 62.8435, GNorm = 0.2552, lr_0 = 4.6873e-04
Validation auc = 0.819156
Epoch 11
Loss = 1.3525e-01, PNorm = 62.9114, GNorm = 0.3397, lr_0 = 4.5874e-04
Loss = 1.1704e-01, PNorm = 62.9539, GNorm = 0.4196, lr_0 = 4.4984e-04
Loss = 1.5522e-01, PNorm = 63.0170, GNorm = 0.4158, lr_0 = 4.4112e-04
Loss = 1.2903e-01, PNorm = 63.0822, GNorm = 0.4321, lr_0 = 4.3257e-04
Validation auc = 0.866883
Epoch 12
Loss = 1.1344e-01, PNorm = 63.1511, GNorm = 0.2489, lr_0 = 4.2335e-04
Loss = 1.3167e-01, PNorm = 63.1968, GNorm = 0.5883, lr_0 = 4.1514e-04
Loss = 1.4354e-01, PNorm = 63.2387, GNorm = 0.4749, lr_0 = 4.0709e-04
Loss = 1.2333e-01, PNorm = 63.3113, GNorm = 0.2438, lr_0 = 3.9920e-04
Validation auc = 0.838312
Epoch 13
Loss = 1.5377e-01, PNorm = 63.3667, GNorm = 0.3427, lr_0 = 3.9069e-04
Loss = 8.5609e-02, PNorm = 63.4107, GNorm = 0.1719, lr_0 = 3.8312e-04
Loss = 1.2882e-01, PNorm = 63.4527, GNorm = 0.6109, lr_0 = 3.7569e-04
Loss = 1.0324e-01, PNorm = 63.5092, GNorm = 0.3466, lr_0 = 3.6841e-04
Validation auc = 0.840584
Epoch 14
Loss = 6.7834e-02, PNorm = 63.5524, GNorm = 0.6711, lr_0 = 3.6056e-04
Loss = 1.3756e-01, PNorm = 63.6067, GNorm = 0.3847, lr_0 = 3.5357e-04
Loss = 1.0828e-01, PNorm = 63.6559, GNorm = 0.4492, lr_0 = 3.4671e-04
Loss = 1.1187e-01, PNorm = 63.7003, GNorm = 0.2653, lr_0 = 3.3999e-04
Loss = 1.0174e-01, PNorm = 63.7488, GNorm = 0.2541, lr_0 = 3.3340e-04
Loss = 2.9628e-02, PNorm = 63.7544, GNorm = 0.4645, lr_0 = 3.3274e-04
Validation auc = 0.849351
Epoch 15
Loss = 7.5911e-02, PNorm = 63.7931, GNorm = 1.0689, lr_0 = 3.2629e-04
Loss = 1.3540e-01, PNorm = 63.8307, GNorm = 0.5689, lr_0 = 3.1996e-04
Loss = 1.2004e-01, PNorm = 63.8761, GNorm = 0.2901, lr_0 = 3.1376e-04
Loss = 8.9905e-02, PNorm = 63.9269, GNorm = 0.2684, lr_0 = 3.0768e-04
Validation auc = 0.843182
Epoch 16
Loss = 1.5247e-01, PNorm = 63.9569, GNorm = 0.4527, lr_0 = 3.0112e-04
Loss = 1.1313e-01, PNorm = 64.0130, GNorm = 1.0314, lr_0 = 2.9528e-04
Loss = 1.1010e-01, PNorm = 64.0294, GNorm = 0.2815, lr_0 = 2.8956e-04
Loss = 9.7051e-02, PNorm = 64.0677, GNorm = 0.2551, lr_0 = 2.8394e-04
Validation auc = 0.858766
Epoch 17
Loss = 9.1225e-02, PNorm = 64.1180, GNorm = 0.4194, lr_0 = 2.7789e-04
Loss = 9.3204e-02, PNorm = 64.1455, GNorm = 0.6553, lr_0 = 2.7250e-04
Loss = 1.1099e-01, PNorm = 64.1809, GNorm = 0.5051, lr_0 = 2.6722e-04
Loss = 8.8839e-02, PNorm = 64.2187, GNorm = 0.4773, lr_0 = 2.6204e-04
Validation auc = 0.838961
Epoch 18
Loss = 6.0731e-02, PNorm = 64.2458, GNorm = 0.3055, lr_0 = 2.5646e-04
Loss = 7.0219e-02, PNorm = 64.2700, GNorm = 0.2836, lr_0 = 2.5148e-04
Loss = 9.1787e-02, PNorm = 64.2931, GNorm = 0.8514, lr_0 = 2.4661e-04
Loss = 1.0317e-01, PNorm = 64.3213, GNorm = 0.7362, lr_0 = 2.4183e-04
Validation auc = 0.834740
Epoch 19
Loss = 6.7810e-02, PNorm = 64.3528, GNorm = 0.3413, lr_0 = 2.3667e-04
Loss = 8.1528e-02, PNorm = 64.3810, GNorm = 0.4457, lr_0 = 2.3208e-04
Loss = 1.0972e-01, PNorm = 64.4090, GNorm = 0.3530, lr_0 = 2.2758e-04
Loss = 6.6550e-02, PNorm = 64.4400, GNorm = 0.3543, lr_0 = 2.2317e-04
Loss = 8.1159e-02, PNorm = 64.4698, GNorm = 0.7018, lr_0 = 2.1884e-04
Loss = 1.0741e-03, PNorm = 64.4736, GNorm = 0.0271, lr_0 = 2.1842e-04
Validation auc = 0.864935
Epoch 20
Loss = 7.1786e-02, PNorm = 64.5013, GNorm = 0.7481, lr_0 = 2.1418e-04
Loss = 3.1712e-02, PNorm = 64.5335, GNorm = 0.1981, lr_0 = 2.1003e-04
Loss = 1.1235e-01, PNorm = 64.5480, GNorm = 0.6157, lr_0 = 2.0596e-04
Loss = 9.6198e-02, PNorm = 64.5789, GNorm = 0.9619, lr_0 = 2.0196e-04
Validation auc = 0.825974
Epoch 21
Loss = 7.7112e-02, PNorm = 64.6112, GNorm = 0.7818, lr_0 = 1.9766e-04
Loss = 8.3204e-02, PNorm = 64.6315, GNorm = 0.6114, lr_0 = 1.9383e-04
Loss = 6.2402e-02, PNorm = 64.6601, GNorm = 0.6802, lr_0 = 1.9007e-04
Loss = 6.9747e-02, PNorm = 64.6772, GNorm = 0.6564, lr_0 = 1.8638e-04
Validation auc = 0.834091
Epoch 22
Loss = 3.7544e-02, PNorm = 64.7080, GNorm = 0.5173, lr_0 = 1.8241e-04
Loss = 4.2410e-02, PNorm = 64.7255, GNorm = 0.3449, lr_0 = 1.7888e-04
Loss = 8.1453e-02, PNorm = 64.7420, GNorm = 1.0218, lr_0 = 1.7541e-04
Loss = 6.5396e-02, PNorm = 64.7636, GNorm = 0.2828, lr_0 = 1.7201e-04
Validation auc = 0.847078
Epoch 23
Loss = 7.2379e-02, PNorm = 64.7831, GNorm = 0.5445, lr_0 = 1.6834e-04
Loss = 7.0025e-02, PNorm = 64.8111, GNorm = 0.7929, lr_0 = 1.6508e-04
Loss = 4.6448e-02, PNorm = 64.8256, GNorm = 0.5064, lr_0 = 1.6188e-04
Loss = 7.8204e-02, PNorm = 64.8535, GNorm = 0.6875, lr_0 = 1.5874e-04
Validation auc = 0.844805
Epoch 24
Loss = 6.7711e-02, PNorm = 64.8746, GNorm = 0.3301, lr_0 = 1.5536e-04
Loss = 5.2644e-02, PNorm = 64.8888, GNorm = 0.3960, lr_0 = 1.5234e-04
Loss = 7.9567e-02, PNorm = 64.9029, GNorm = 0.7905, lr_0 = 1.4939e-04
Loss = 5.9541e-02, PNorm = 64.9185, GNorm = 0.5900, lr_0 = 1.4649e-04
Loss = 6.5678e-02, PNorm = 64.9366, GNorm = 0.4580, lr_0 = 1.4365e-04
Loss = 2.6437e-04, PNorm = 64.9392, GNorm = 0.0096, lr_0 = 1.4337e-04
Validation auc = 0.838961
Epoch 25
Loss = 6.9286e-02, PNorm = 64.9530, GNorm = 0.4284, lr_0 = 1.4059e-04
Loss = 5.7387e-02, PNorm = 64.9694, GNorm = 0.1232, lr_0 = 1.3787e-04
Loss = 6.0020e-02, PNorm = 64.9814, GNorm = 0.4875, lr_0 = 1.3519e-04
Loss = 5.4630e-02, PNorm = 65.0016, GNorm = 0.4060, lr_0 = 1.3257e-04
Validation auc = 0.831169
Epoch 26
Loss = 4.2177e-02, PNorm = 65.0151, GNorm = 0.6539, lr_0 = 1.2975e-04
Loss = 6.9652e-02, PNorm = 65.0242, GNorm = 0.7470, lr_0 = 1.2723e-04
Loss = 7.1762e-02, PNorm = 65.0422, GNorm = 0.9149, lr_0 = 1.2476e-04
Loss = 5.1770e-02, PNorm = 65.0539, GNorm = 0.7637, lr_0 = 1.2234e-04
Validation auc = 0.831494
Epoch 27
Loss = 3.8351e-02, PNorm = 65.0643, GNorm = 0.6590, lr_0 = 1.1974e-04
Loss = 5.3497e-02, PNorm = 65.0762, GNorm = 1.2046, lr_0 = 1.1742e-04
Loss = 5.8318e-02, PNorm = 65.0845, GNorm = 0.6298, lr_0 = 1.1514e-04
Loss = 6.1028e-02, PNorm = 65.1026, GNorm = 0.6529, lr_0 = 1.1291e-04
Validation auc = 0.826299
Epoch 28
Loss = 4.7279e-02, PNorm = 65.1200, GNorm = 0.7002, lr_0 = 1.1050e-04
Loss = 3.7611e-02, PNorm = 65.1331, GNorm = 0.6474, lr_0 = 1.0836e-04
Loss = 4.5699e-02, PNorm = 65.1448, GNorm = 0.4527, lr_0 = 1.0626e-04
Loss = 6.6813e-02, PNorm = 65.1507, GNorm = 0.2901, lr_0 = 1.0420e-04
Validation auc = 0.842857
Epoch 29
Loss = 2.0077e-02, PNorm = 65.1643, GNorm = 0.3156, lr_0 = 1.0198e-04
Loss = 4.0308e-02, PNorm = 65.1739, GNorm = 0.6062, lr_0 = 1.0000e-04
Loss = 4.7308e-02, PNorm = 65.1853, GNorm = 0.7956, lr_0 = 1.0000e-04
Loss = 5.1476e-02, PNorm = 65.1913, GNorm = 0.3613, lr_0 = 1.0000e-04
Loss = 4.3203e-02, PNorm = 65.2006, GNorm = 1.1627, lr_0 = 1.0000e-04
Loss = 1.3279e-04, PNorm = 65.2014, GNorm = 0.0069, lr_0 = 1.0000e-04
Validation auc = 0.854545
Model 0 best validation auc = 0.912987 on epoch 1
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 provided with no test set, no metric evaluation will be performed.
Ensemble test auc = nan
1-fold cross validation
	Seed 0 ==> test auc = nan
Overall test auc = nan +/- nan
Elapsed time = 0:10:40
Command line
python antibiotic.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/shxie/aiddsummary/antibio_reproduction/configew.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'antibiotic_reproduction.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.35,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/shxie/aiddsummary/antibio_reproduction/antibiotic/model_19',
 'save_preds': False,
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Activity'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
Activity 0: 94.86%, 1: 5.14%
Total size = 2,335 | train size = 2,101 | val size = 234 | test size = 0
The test data split is empty. This may be either because splitting with no test set was selected,             such as with `cv-no-test`, or because test data provided with `--separate_test_path` was empty or contained only invalid molecules.             Performance on the test set will not be evaluated and metric scores will return `nan` for each task.
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1600, out_features=1, bias=True)
  )
)
Number of parameters = 5,572,801
Epoch 0
Loss = 2.7557e-01, PNorm = 59.4787, GNorm = 0.5901, lr_0 = 2.1786e-04
Loss = 2.3560e-01, PNorm = 59.5048, GNorm = 0.2575, lr_0 = 3.2500e-04
Loss = 2.4763e-01, PNorm = 59.5346, GNorm = 0.4798, lr_0 = 4.3214e-04
Loss = 1.7671e-01, PNorm = 59.5709, GNorm = 0.2502, lr_0 = 5.3929e-04
Validation auc = 0.850000
Epoch 1
Loss = 2.3511e-01, PNorm = 59.6067, GNorm = 0.3356, lr_0 = 6.5714e-04
Loss = 1.7039e-01, PNorm = 59.6452, GNorm = 0.3605, lr_0 = 7.6429e-04
Loss = 2.4154e-01, PNorm = 59.7019, GNorm = 0.1846, lr_0 = 8.7143e-04
Loss = 1.5119e-01, PNorm = 59.7726, GNorm = 0.3671, lr_0 = 9.7857e-04
Validation auc = 0.911688
Epoch 2
Loss = 2.3153e-01, PNorm = 59.8348, GNorm = 0.2894, lr_0 = 9.8253e-04
Loss = 1.5901e-01, PNorm = 59.8973, GNorm = 0.2086, lr_0 = 9.6348e-04
Loss = 1.9351e-01, PNorm = 59.9541, GNorm = 0.9870, lr_0 = 9.4480e-04
Loss = 2.0731e-01, PNorm = 60.0256, GNorm = 0.1702, lr_0 = 9.2648e-04
Validation auc = 0.889286
Epoch 3
Loss = 2.1448e-01, PNorm = 60.1100, GNorm = 0.4366, lr_0 = 9.0674e-04
Loss = 1.7973e-01, PNorm = 60.1722, GNorm = 0.2986, lr_0 = 8.8916e-04
Loss = 1.9714e-01, PNorm = 60.2325, GNorm = 0.7457, lr_0 = 8.7192e-04
Loss = 2.0810e-01, PNorm = 60.3202, GNorm = 0.2698, lr_0 = 8.5501e-04
Validation auc = 0.878896
Epoch 4
Loss = 1.5591e-01, PNorm = 60.4080, GNorm = 0.1541, lr_0 = 8.3679e-04
Loss = 2.0675e-01, PNorm = 60.4815, GNorm = 0.1815, lr_0 = 8.2057e-04
Loss = 1.7347e-01, PNorm = 60.5663, GNorm = 0.1844, lr_0 = 8.0466e-04
Loss = 1.8301e-01, PNorm = 60.6453, GNorm = 0.3574, lr_0 = 7.8906e-04
Loss = 1.6640e-01, PNorm = 60.7179, GNorm = 0.1903, lr_0 = 7.7376e-04
Loss = 1.6347e-02, PNorm = 60.7261, GNorm = 0.2049, lr_0 = 7.7224e-04
Validation auc = 0.905195
Epoch 5
Loss = 1.4600e-01, PNorm = 60.7883, GNorm = 0.2018, lr_0 = 7.5727e-04
Loss = 1.8131e-01, PNorm = 60.8609, GNorm = 0.2824, lr_0 = 7.4259e-04
Loss = 1.8255e-01, PNorm = 60.9557, GNorm = 0.3915, lr_0 = 7.2819e-04
Loss = 1.7992e-01, PNorm = 61.0232, GNorm = 0.3651, lr_0 = 7.1407e-04
Validation auc = 0.867532
Epoch 6
Loss = 2.6587e-01, PNorm = 61.2274, GNorm = 0.3367, lr_0 = 6.9886e-04
Loss = 1.8773e-01, PNorm = 61.4326, GNorm = 0.3563, lr_0 = 6.8531e-04
Loss = 1.9952e-01, PNorm = 61.5588, GNorm = 0.3445, lr_0 = 6.7202e-04
Loss = 2.0663e-01, PNorm = 61.6229, GNorm = 0.2868, lr_0 = 6.5899e-04
Validation auc = 0.883766
Epoch 7
Loss = 1.6264e-01, PNorm = 61.7083, GNorm = 0.4568, lr_0 = 6.4495e-04
Loss = 2.3610e-01, PNorm = 61.7765, GNorm = 0.3770, lr_0 = 6.3244e-04
Loss = 1.2277e-01, PNorm = 61.8603, GNorm = 0.4314, lr_0 = 6.2018e-04
Loss = 1.5974e-01, PNorm = 61.9072, GNorm = 0.2942, lr_0 = 6.0815e-04
Validation auc = 0.844481
Epoch 8
Loss = 1.7826e-01, PNorm = 61.9772, GNorm = 0.2331, lr_0 = 5.9520e-04
Loss = 1.4679e-01, PNorm = 62.0524, GNorm = 0.5493, lr_0 = 5.8366e-04
Loss = 2.1161e-01, PNorm = 62.1514, GNorm = 0.2830, lr_0 = 5.7234e-04
Loss = 1.4257e-01, PNorm = 62.2272, GNorm = 0.2089, lr_0 = 5.6124e-04
Validation auc = 0.854221
Epoch 9
Loss = 6.4282e-02, PNorm = 62.3219, GNorm = 0.2174, lr_0 = 5.4928e-04
Loss = 1.8293e-01, PNorm = 62.3750, GNorm = 0.3413, lr_0 = 5.3863e-04
Loss = 1.8952e-01, PNorm = 62.4426, GNorm = 0.2208, lr_0 = 5.2819e-04
Loss = 1.2112e-01, PNorm = 62.5202, GNorm = 0.4837, lr_0 = 5.1795e-04
Loss = 1.7075e-01, PNorm = 62.5702, GNorm = 0.2669, lr_0 = 5.0790e-04
Loss = 8.7297e-02, PNorm = 62.5761, GNorm = 1.0849, lr_0 = 5.0691e-04
Validation auc = 0.840584
Epoch 10
Loss = 1.4927e-01, PNorm = 62.6294, GNorm = 0.4817, lr_0 = 4.9708e-04
Loss = 1.4338e-01, PNorm = 62.6791, GNorm = 0.3204, lr_0 = 4.8744e-04
Loss = 1.3034e-01, PNorm = 62.7322, GNorm = 0.6033, lr_0 = 4.7799e-04
Loss = 1.4248e-01, PNorm = 62.7743, GNorm = 0.2175, lr_0 = 4.6873e-04
Validation auc = 0.849351
Epoch 11
Loss = 1.3837e-01, PNorm = 62.8279, GNorm = 0.2995, lr_0 = 4.5874e-04
Loss = 1.1336e-01, PNorm = 62.8759, GNorm = 0.2054, lr_0 = 4.4984e-04
Loss = 1.5702e-01, PNorm = 62.9222, GNorm = 0.5609, lr_0 = 4.4112e-04
Loss = 1.3009e-01, PNorm = 62.9762, GNorm = 0.3751, lr_0 = 4.3257e-04
Validation auc = 0.862662
Epoch 12
Loss = 1.1435e-01, PNorm = 63.0336, GNorm = 0.3200, lr_0 = 4.2335e-04
Loss = 1.2382e-01, PNorm = 63.0778, GNorm = 0.5079, lr_0 = 4.1514e-04
Loss = 1.3715e-01, PNorm = 63.1170, GNorm = 0.4549, lr_0 = 4.0709e-04
Loss = 1.2013e-01, PNorm = 63.1912, GNorm = 0.3022, lr_0 = 3.9920e-04
Validation auc = 0.846104
Epoch 13
Loss = 1.5541e-01, PNorm = 63.2441, GNorm = 0.2532, lr_0 = 3.9069e-04
Loss = 8.6446e-02, PNorm = 63.2808, GNorm = 0.1926, lr_0 = 3.8312e-04
Loss = 1.2604e-01, PNorm = 63.3261, GNorm = 0.6196, lr_0 = 3.7569e-04
Loss = 1.0402e-01, PNorm = 63.3762, GNorm = 0.4440, lr_0 = 3.6841e-04
Validation auc = 0.842857
Epoch 14
Loss = 6.7019e-02, PNorm = 63.4198, GNorm = 0.5157, lr_0 = 3.6056e-04
Loss = 1.4054e-01, PNorm = 63.4731, GNorm = 0.3644, lr_0 = 3.5357e-04
Loss = 9.9496e-02, PNorm = 63.5206, GNorm = 0.4204, lr_0 = 3.4671e-04
Loss = 1.1432e-01, PNorm = 63.5641, GNorm = 0.1719, lr_0 = 3.3999e-04
Loss = 1.0062e-01, PNorm = 63.6103, GNorm = 0.2585, lr_0 = 3.3340e-04
Loss = 1.4778e-02, PNorm = 63.6159, GNorm = 0.2357, lr_0 = 3.3274e-04
Validation auc = 0.838636
Epoch 15
Loss = 8.0873e-02, PNorm = 63.6536, GNorm = 1.0592, lr_0 = 3.2629e-04
Loss = 1.3043e-01, PNorm = 63.6936, GNorm = 0.4919, lr_0 = 3.1996e-04
Loss = 1.2277e-01, PNorm = 63.7431, GNorm = 0.2787, lr_0 = 3.1376e-04
Loss = 8.7943e-02, PNorm = 63.7976, GNorm = 0.2162, lr_0 = 3.0768e-04
Validation auc = 0.819481
Epoch 16
Loss = 1.5363e-01, PNorm = 63.8241, GNorm = 0.5251, lr_0 = 3.0112e-04
Loss = 1.0901e-01, PNorm = 63.8852, GNorm = 1.0041, lr_0 = 2.9528e-04
Loss = 1.1126e-01, PNorm = 63.9095, GNorm = 0.2265, lr_0 = 2.8956e-04
Loss = 9.6177e-02, PNorm = 63.9463, GNorm = 0.2573, lr_0 = 2.8394e-04
Validation auc = 0.852597
Epoch 17
Loss = 8.7664e-02, PNorm = 63.9977, GNorm = 0.4547, lr_0 = 2.7789e-04
Loss = 9.2207e-02, PNorm = 64.0211, GNorm = 0.6444, lr_0 = 2.7250e-04
Loss = 1.1042e-01, PNorm = 64.0598, GNorm = 0.5046, lr_0 = 2.6722e-04
Loss = 8.9351e-02, PNorm = 64.0966, GNorm = 0.4413, lr_0 = 2.6204e-04
Validation auc = 0.837338
Epoch 18
Loss = 5.9423e-02, PNorm = 64.1259, GNorm = 0.4075, lr_0 = 2.5646e-04
Loss = 7.1453e-02, PNorm = 64.1493, GNorm = 0.2561, lr_0 = 2.5148e-04
Loss = 9.5874e-02, PNorm = 64.1733, GNorm = 0.6011, lr_0 = 2.4661e-04
Loss = 1.0676e-01, PNorm = 64.2046, GNorm = 0.6534, lr_0 = 2.4183e-04
Validation auc = 0.832468
Epoch 19
Loss = 7.4068e-02, PNorm = 64.2413, GNorm = 0.3275, lr_0 = 2.3667e-04
Loss = 7.7755e-02, PNorm = 64.2716, GNorm = 0.5381, lr_0 = 2.3208e-04
Loss = 1.1567e-01, PNorm = 64.3028, GNorm = 0.3958, lr_0 = 2.2758e-04
Loss = 7.0927e-02, PNorm = 64.3330, GNorm = 0.4860, lr_0 = 2.2317e-04
Loss = 8.0857e-02, PNorm = 64.3687, GNorm = 0.4912, lr_0 = 2.1884e-04
Loss = 8.6997e-04, PNorm = 64.3727, GNorm = 0.0218, lr_0 = 2.1842e-04
Validation auc = 0.845779
Epoch 20
Loss = 7.5902e-02, PNorm = 64.3989, GNorm = 0.7985, lr_0 = 2.1418e-04
Loss = 3.2525e-02, PNorm = 64.4316, GNorm = 0.2722, lr_0 = 2.1003e-04
Loss = 1.0686e-01, PNorm = 64.4497, GNorm = 0.5761, lr_0 = 2.0596e-04
Loss = 9.9515e-02, PNorm = 64.4785, GNorm = 1.1603, lr_0 = 2.0196e-04
Validation auc = 0.825649
Epoch 21
Loss = 9.0812e-02, PNorm = 64.5134, GNorm = 0.7984, lr_0 = 1.9766e-04
Loss = 8.3539e-02, PNorm = 64.5331, GNorm = 0.7161, lr_0 = 1.9383e-04
Loss = 6.7999e-02, PNorm = 64.5650, GNorm = 0.8778, lr_0 = 1.9007e-04
Loss = 7.7335e-02, PNorm = 64.5783, GNorm = 0.6048, lr_0 = 1.8638e-04
Validation auc = 0.835714
Epoch 22
Loss = 4.0402e-02, PNorm = 64.6100, GNorm = 0.3290, lr_0 = 1.8241e-04
Loss = 4.8426e-02, PNorm = 64.6315, GNorm = 0.3187, lr_0 = 1.7888e-04
Loss = 8.9659e-02, PNorm = 64.6481, GNorm = 0.9425, lr_0 = 1.7541e-04
Loss = 6.3390e-02, PNorm = 64.6741, GNorm = 0.3853, lr_0 = 1.7201e-04
Validation auc = 0.842857
Epoch 23
Loss = 8.0156e-02, PNorm = 64.6930, GNorm = 0.4449, lr_0 = 1.6834e-04
Loss = 7.1915e-02, PNorm = 64.7227, GNorm = 0.8993, lr_0 = 1.6508e-04
Loss = 6.2703e-02, PNorm = 64.7340, GNorm = 0.8747, lr_0 = 1.6188e-04
Loss = 8.0012e-02, PNorm = 64.7631, GNorm = 0.6615, lr_0 = 1.5874e-04
Validation auc = 0.839286
Epoch 24
Loss = 7.2117e-02, PNorm = 64.7862, GNorm = 0.3422, lr_0 = 1.5536e-04
Loss = 4.9914e-02, PNorm = 64.8025, GNorm = 0.2986, lr_0 = 1.5234e-04
Loss = 7.2752e-02, PNorm = 64.8192, GNorm = 0.8539, lr_0 = 1.4939e-04
Loss = 6.3009e-02, PNorm = 64.8324, GNorm = 0.4900, lr_0 = 1.4649e-04
Loss = 6.5785e-02, PNorm = 64.8540, GNorm = 0.5458, lr_0 = 1.4365e-04
Loss = 7.4980e-05, PNorm = 64.8570, GNorm = 0.0036, lr_0 = 1.4337e-04
Validation auc = 0.838312
Epoch 25
Loss = 7.2119e-02, PNorm = 64.8706, GNorm = 0.3977, lr_0 = 1.4059e-04
Loss = 5.4936e-02, PNorm = 64.8870, GNorm = 0.1584, lr_0 = 1.3787e-04
Loss = 6.3122e-02, PNorm = 64.9037, GNorm = 0.8179, lr_0 = 1.3519e-04
Loss = 5.6021e-02, PNorm = 64.9233, GNorm = 0.6306, lr_0 = 1.3257e-04
Validation auc = 0.835065
Epoch 26
Loss = 4.6610e-02, PNorm = 64.9392, GNorm = 0.7736, lr_0 = 1.2975e-04
Loss = 7.4127e-02, PNorm = 64.9503, GNorm = 0.6524, lr_0 = 1.2723e-04
Loss = 7.1072e-02, PNorm = 64.9703, GNorm = 0.9087, lr_0 = 1.2476e-04
Loss = 5.2458e-02, PNorm = 64.9819, GNorm = 0.6662, lr_0 = 1.2234e-04
Validation auc = 0.833766
Epoch 27
Loss = 4.2521e-02, PNorm = 64.9923, GNorm = 0.5261, lr_0 = 1.1974e-04
Loss = 5.1055e-02, PNorm = 65.0022, GNorm = 1.2951, lr_0 = 1.1742e-04
Loss = 6.6313e-02, PNorm = 65.0100, GNorm = 0.6511, lr_0 = 1.1514e-04
Loss = 6.0365e-02, PNorm = 65.0264, GNorm = 0.6211, lr_0 = 1.1291e-04
Validation auc = 0.833117
Epoch 28
Loss = 5.3153e-02, PNorm = 65.0410, GNorm = 0.5688, lr_0 = 1.1050e-04
Loss = 3.3533e-02, PNorm = 65.0543, GNorm = 0.4916, lr_0 = 1.0836e-04
Loss = 5.0776e-02, PNorm = 65.0649, GNorm = 0.3903, lr_0 = 1.0626e-04
Loss = 6.0358e-02, PNorm = 65.0712, GNorm = 0.3577, lr_0 = 1.0420e-04
Validation auc = 0.841883
Epoch 29
Loss = 1.9901e-02, PNorm = 65.0871, GNorm = 0.2383, lr_0 = 1.0198e-04
Loss = 4.1970e-02, PNorm = 65.0962, GNorm = 0.4931, lr_0 = 1.0000e-04
Loss = 5.3085e-02, PNorm = 65.1082, GNorm = 0.7457, lr_0 = 1.0000e-04
Loss = 5.2075e-02, PNorm = 65.1154, GNorm = 0.4307, lr_0 = 1.0000e-04
Loss = 3.7708e-02, PNorm = 65.1249, GNorm = 0.8953, lr_0 = 1.0000e-04
Loss = 2.3961e-05, PNorm = 65.1259, GNorm = 0.0017, lr_0 = 1.0000e-04
Validation auc = 0.840584
Model 0 best validation auc = 0.911688 on epoch 1
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Model 0 provided with no test set, no metric evaluation will be performed.
Ensemble test auc = nan
1-fold cross validation
	Seed 0 ==> test auc = nan
Overall test auc = nan +/- nan
Elapsed time = 0:10:40
